var JSON;JSON||(JSON={}),function(){function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i&&typeof i=="object"&&typeof i.toJSON=="function"&&(i=i.toJSON(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g;return e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1)typeof rep[c]=="string"&&(d=rep[c],e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g;return e}}function quote(a){escapable.lastIndex=0;return escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function f(a){return a<10?"0"+a:a}"use strict",typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c=="number")for(d=0;d<c;d+=1)indent+=" ";else typeof c=="string"&&(indent=c);rep=b;if(!b||typeof b=="function"||typeof b=="object"&&typeof b.length=="number")return str("",{"":a});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object")for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver=="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")})}()
SockJS=(function(){var _document=document;var _window=window;var utils={};var REventTarget=function(){};REventTarget.prototype.addEventListener=function(eventType,listener){if(!this._listeners){this._listeners={};}
if(!(eventType in this._listeners)){this._listeners[eventType]=[];}
var arr=this._listeners[eventType];if(utils.arrIndexOf(arr,listener)===-1){arr.push(listener);}
return;};REventTarget.prototype.removeEventListener=function(eventType,listener){if(!(this._listeners&&(eventType in this._listeners))){return;}
var arr=this._listeners[eventType];var idx=utils.arrIndexOf(arr,listener);if(idx!==-1){if(arr.length>1){this._listeners[eventType]=arr.slice(0,idx).concat(arr.slice(idx+1));}else{delete this._listeners[eventType];}
return;}
return;};REventTarget.prototype.dispatchEvent=function(event){var t=event.type;var args=Array.prototype.slice.call(arguments,0);if(this['on'+t]){this['on'+t].apply(this,args);}
if(this._listeners&&t in this._listeners){for(var i=0;i<this._listeners[t].length;i++){this._listeners[t][i].apply(this,args);}}};var SimpleEvent=function(type,obj){this.type=type;if(typeof obj!=='undefined'){for(var k in obj){if(!obj.hasOwnProperty(k))continue;this[k]=obj[k];}}};SimpleEvent.prototype.toString=function(){var r=[];for(var k in this){if(!this.hasOwnProperty(k))continue;var v=this[k];if(typeof v==='function')v='[function]';r.push(k+'='+v);}
return'SimpleEvent('+r.join(', ')+')';};var EventEmitter=function(events){var that=this;that._events=events||[];that._listeners={};};EventEmitter.prototype.emit=function(type){var that=this;that._verifyType(type);if(that._nuked)return;var args=Array.prototype.slice.call(arguments,1);if(that['on'+type]){that['on'+type].apply(that,args);}
if(type in that._listeners){for(var i=0;i<that._listeners[type].length;i++){that._listeners[type][i].apply(that,args);}}};EventEmitter.prototype.on=function(type,callback){var that=this;that._verifyType(type);if(that._nuked)return;if(!(type in that._listeners)){that._listeners[type]=[];}
that._listeners[type].push(callback);};EventEmitter.prototype._verifyType=function(type){var that=this;if(utils.arrIndexOf(that._events,type)===-1){utils.log('Event '+JSON.stringify(type)+' not listed '+JSON.stringify(that._events)+' in '+that);}};EventEmitter.prototype.nuke=function(){var that=this;that._nuked=true;for(var i=0;i<that._events.length;i++){delete that[that._events[i]];}
that._listeners={};};var random_string_chars='abcdefghijklmnopqrstuvwxyz0123456789_';utils.random_string=function(length,max){max=max||random_string_chars.length;var i,ret=[];for(i=0;i<length;i++){ret.push(random_string_chars.substr(Math.floor(Math.random()*max),1));}
return ret.join('');};utils.random_number=function(max){return Math.floor(Math.random()*max);};utils.random_number_string=function(max){var t=(''+(max-1)).length;var p=Array(t+1).join('0');return(p+utils.random_number(max)).slice(-t);};utils.getOrigin=function(url){url+='/';var parts=url.split('/').slice(0,3);return parts.join('/');};utils.isSameOriginUrl=function(url_a,url_b){if(!url_b)url_b=_window.location.href;return(url_a.split('/').slice(0,3).join('/')===url_b.split('/').slice(0,3).join('/'));};utils.getParentDomain=function(url){if(/^[0-9.]*$/.test(url))return url;if(/^\[/.test(url))return url;if(!(/[.]/.test(url)))return url;var parts=url.split('.').slice(1);return parts.join('.');};utils.objectExtend=function(dst,src){for(var k in src){if(src.hasOwnProperty(k)){dst[k]=src[k];}}
return dst;};var WPrefix='_jp';utils.polluteGlobalNamespace=function(){if(!(WPrefix in _window)){_window[WPrefix]={};}};utils.closeFrame=function(code,reason){return'c'+JSON.stringify([code,reason]);};utils.userSetCode=function(code){return code===1000||(code>=3000&&code<=4999);};utils.countRTO=function(rtt){var rto;if(rtt>100){rto=3*rtt;}else{rto=rtt+200;}
return rto;}
utils.log=function(){if(_window.console&&console.log&&console.log.apply){console.log.apply(console,arguments);}};utils.bind=function(fun,that){if(fun.bind){return fun.bind(that);}else{return function(){return fun.apply(that,arguments);};}};utils.flatUrl=function(url){return url.indexOf('?')===-1&&url.indexOf('#')===-1;};utils.amendUrl=function(url){var dl=_document.location;if(!url){throw new Error('Wrong url for SockJS');}
if(!utils.flatUrl(url)){throw new Error('Only basic urls are supported in SockJS');}
if(url.indexOf('//')===0){url=dl.protocol+url;}
if(url.indexOf('/')===0){url=dl.protocol+'//'+dl.host+url;}
url=url.replace(/[/]+$/,'');return url;};utils.arrIndexOf=function(arr,obj){for(var i=0;i<arr.length;i++){if(arr[i]===obj){return i;}}
return-1;};utils.arrSkip=function(arr,obj){var idx=utils.arrIndexOf(arr,obj);if(idx===-1){return arr.slice();}else{var dst=arr.slice(0,idx);return dst.concat(arr.slice(idx+1));}};utils.isArray=Array.isArray||function(value){return{}.toString.call(value).indexOf('Array')>=0};utils.delay=function(t,fun){if(typeof t==='function'){fun=t;t=0;}
return setTimeout(fun,t);};var json_escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,json_lookup={"\u0000":"\\u0000","\u0001":"\\u0001","\u0002":"\\u0002","\u0003":"\\u0003","\u0004":"\\u0004","\u0005":"\\u0005","\u0006":"\\u0006","\u0007":"\\u0007","\b":"\\b","\t":"\\t","\n":"\\n","\u000b":"\\u000b","\f":"\\f","\r":"\\r","\u000e":"\\u000e","\u000f":"\\u000f","\u0010":"\\u0010","\u0011":"\\u0011","\u0012":"\\u0012","\u0013":"\\u0013","\u0014":"\\u0014","\u0015":"\\u0015","\u0016":"\\u0016","\u0017":"\\u0017","\u0018":"\\u0018","\u0019":"\\u0019","\u001a":"\\u001a","\u001b":"\\u001b","\u001c":"\\u001c","\u001d":"\\u001d","\u001e":"\\u001e","\u001f":"\\u001f","\"":"\\\"","\\":"\\\\","\u007f":"\\u007f","\u0080":"\\u0080","\u0081":"\\u0081","\u0082":"\\u0082","\u0083":"\\u0083","\u0084":"\\u0084","\u0085":"\\u0085","\u0086":"\\u0086","\u0087":"\\u0087","\u0088":"\\u0088","\u0089":"\\u0089","\u008a":"\\u008a","\u008b":"\\u008b","\u008c":"\\u008c","\u008d":"\\u008d","\u008e":"\\u008e","\u008f":"\\u008f","\u0090":"\\u0090","\u0091":"\\u0091","\u0092":"\\u0092","\u0093":"\\u0093","\u0094":"\\u0094","\u0095":"\\u0095","\u0096":"\\u0096","\u0097":"\\u0097","\u0098":"\\u0098","\u0099":"\\u0099","\u009a":"\\u009a","\u009b":"\\u009b","\u009c":"\\u009c","\u009d":"\\u009d","\u009e":"\\u009e","\u009f":"\\u009f","\u00ad":"\\u00ad","\u0600":"\\u0600","\u0601":"\\u0601","\u0602":"\\u0602","\u0603":"\\u0603","\u0604":"\\u0604","\u070f":"\\u070f","\u17b4":"\\u17b4","\u17b5":"\\u17b5","\u200c":"\\u200c","\u200d":"\\u200d","\u200e":"\\u200e","\u200f":"\\u200f","\u2028":"\\u2028","\u2029":"\\u2029","\u202a":"\\u202a","\u202b":"\\u202b","\u202c":"\\u202c","\u202d":"\\u202d","\u202e":"\\u202e","\u202f":"\\u202f","\u2060":"\\u2060","\u2061":"\\u2061","\u2062":"\\u2062","\u2063":"\\u2063","\u2064":"\\u2064","\u2065":"\\u2065","\u2066":"\\u2066","\u2067":"\\u2067","\u2068":"\\u2068","\u2069":"\\u2069","\u206a":"\\u206a","\u206b":"\\u206b","\u206c":"\\u206c","\u206d":"\\u206d","\u206e":"\\u206e","\u206f":"\\u206f","\ufeff":"\\ufeff","\ufff0":"\\ufff0","\ufff1":"\\ufff1","\ufff2":"\\ufff2","\ufff3":"\\ufff3","\ufff4":"\\ufff4","\ufff5":"\\ufff5","\ufff6":"\\ufff6","\ufff7":"\\ufff7","\ufff8":"\\ufff8","\ufff9":"\\ufff9","\ufffa":"\\ufffa","\ufffb":"\\ufffb","\ufffc":"\\ufffc","\ufffd":"\\ufffd","\ufffe":"\\ufffe","\uffff":"\\uffff"};var extra_escapable=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,extra_lookup;var JSONQuote=(JSON&&JSON.stringify)||function(string){json_escapable.lastIndex=0;if(json_escapable.test(string)){string=string.replace(json_escapable,function(a){return json_lookup[a];});}
return'"'+string+'"';};var unroll_lookup=function(escapable){var i;var unrolled={}
var c=[]
for(i=0;i<65536;i++){c.push(String.fromCharCode(i));}
escapable.lastIndex=0;c.join('').replace(escapable,function(a){unrolled[a]='\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4);return'';});escapable.lastIndex=0;return unrolled;};utils.quote=function(string){var quoted=JSONQuote(string);extra_escapable.lastIndex=0;if(!extra_escapable.test(quoted)){return quoted;}
if(!extra_lookup)extra_lookup=unroll_lookup(extra_escapable);return quoted.replace(extra_escapable,function(a){return extra_lookup[a];});}
var _all_protocols=['websocket','xdr-streaming','xhr-streaming','iframe-eventsource','iframe-htmlfile','xdr-polling','xhr-polling','iframe-xhr-polling','jsonp-polling'];utils.probeProtocols=function(){var probed={};for(var i=0;i<_all_protocols.length;i++){var protocol=_all_protocols[i];probed[protocol]=SockJS[protocol]&&SockJS[protocol].enabled();}
return probed;};utils.detectProtocols=function(probed,protocols_whitelist,info){var pe={},protocols=[];if(!protocols_whitelist)protocols_whitelist=_all_protocols;for(var i=0;i<protocols_whitelist.length;i++){var protocol=protocols_whitelist[i];pe[protocol]=probed[protocol];}
var maybe_push=function(protos){var proto=protos.shift();if(pe[proto]){protocols.push(proto);}else{if(protos.length>0){maybe_push(protos);}}}
if(info.websocket!==false){maybe_push(['websocket']);}
if(pe['xhr-streaming']&&!info.null_origin){protocols.push('xhr-streaming');}else{if(pe['xdr-streaming']&&!info.cookie_needed&&!info.null_origin){protocols.push('xdr-streaming');}else{maybe_push(['iframe-eventsource','iframe-htmlfile']);}}
if(pe['xhr-polling']&&!info.null_origin){protocols.push('xhr-polling');}else{if(pe['xdr-polling']&&!info.cookie_needed&&!info.null_origin){protocols.push('xdr-polling');}else{maybe_push(['iframe-xhr-polling','jsonp-polling']);}}
return protocols;}
var MPrefix='_sockjs_global';utils.createHook=function(){var window_id='a'+utils.random_string(8);if(!(MPrefix in _window)){var map={};_window[MPrefix]=function(window_id){if(!(window_id in map)){map[window_id]={id:window_id,del:function(){delete map[window_id];}};}
return map[window_id];}}
return _window[MPrefix](window_id);};utils.attachMessage=function(listener){utils.attachEvent('message',listener);};utils.attachEvent=function(event,listener){if(typeof _window.addEventListener!=='undefined'){_window.addEventListener(event,listener,false);}else{_document.attachEvent("on"+event,listener);_window.attachEvent("on"+event,listener);}};utils.detachMessage=function(listener){utils.detachEvent('message',listener);};utils.detachEvent=function(event,listener){if(typeof _window.addEventListener!=='undefined'){_window.removeEventListener(event,listener,false);}else{_document.detachEvent("on"+event,listener);_window.detachEvent("on"+event,listener);}};var on_unload={};var after_unload=false;var trigger_unload_callbacks=function(){for(var ref in on_unload){on_unload[ref]();delete on_unload[ref];};};var unload_triggered=function(){if(after_unload)return;after_unload=true;trigger_unload_callbacks();};utils.attachEvent('unload',unload_triggered);utils.unload_add=function(listener){var ref=utils.random_string(8);on_unload[ref]=listener;if(after_unload){utils.delay(trigger_unload_callbacks);}
return ref;};utils.unload_del=function(ref){if(ref in on_unload)
delete on_unload[ref];};utils.createIframe=function(iframe_url,error_callback){var iframe=_document.createElement('iframe');var tref,unload_ref;var unattach=function(){clearTimeout(tref);try{iframe.onload=null;}catch(x){}
iframe.onerror=null;};var cleanup=function(){if(iframe){unattach();setTimeout(function(){if(iframe){iframe.parentNode.removeChild(iframe);}
iframe=null;},0);utils.unload_del(unload_ref);}};var onerror=function(r){if(iframe){cleanup();error_callback(r);}};var post=function(msg,origin){try{if(iframe&&iframe.contentWindow){iframe.contentWindow.postMessage(msg,origin);}}catch(x){};};iframe.src=iframe_url;iframe.style.display='none';iframe.style.position='absolute';iframe.onerror=function(){onerror('onerror');};iframe.onload=function(){clearTimeout(tref);tref=setTimeout(function(){onerror('onload timeout');},2000);};_document.body.appendChild(iframe);tref=setTimeout(function(){onerror('timeout');},15000);unload_ref=utils.unload_add(cleanup);return{post:post,cleanup:cleanup,loaded:unattach};};utils.createHtmlfile=function(iframe_url,error_callback){var doc=new ActiveXObject('htmlfile');var tref,unload_ref;var iframe;var unattach=function(){clearTimeout(tref);};var cleanup=function(){if(doc){unattach();utils.unload_del(unload_ref);iframe.parentNode.removeChild(iframe);iframe=doc=null;CollectGarbage();}};var onerror=function(r){if(doc){cleanup();error_callback(r);}};var post=function(msg,origin){try{if(iframe&&iframe.contentWindow){iframe.contentWindow.postMessage(msg,origin);}}catch(x){};};doc.open();doc.write('<html><s'+'cript>'+'document.domain="'+document.domain+'";'+'</s'+'cript></html>');doc.close();doc.parentWindow[WPrefix]=_window[WPrefix];var c=doc.createElement('div');doc.body.appendChild(c);iframe=doc.createElement('iframe');iframe.src=iframe_url;c.appendChild(iframe);tref=setTimeout(function(){onerror('timeout');},15000);unload_ref=utils.unload_add(cleanup);return{post:post,cleanup:cleanup,loaded:unattach};};var AbstractXHRObject=function(){};AbstractXHRObject.prototype=new EventEmitter(['chunk','finish']);AbstractXHRObject.prototype._start=function(method,url,payload,opts){var that=this;try{that.xhr=new XMLHttpRequest();}catch(x){};if(!that.xhr){try{that.xhr=new _window.ActiveXObject('Microsoft.XMLHTTP');}catch(x){};}
if(_window.ActiveXObject||_window.XDomainRequest){url+=((url.indexOf('?')===-1)?'?':'&')+'t='+(+new Date);}
that.unload_ref=utils.unload_add(function(){that._cleanup(true);});try{that.xhr.open(method,url,true);}catch(e){that.emit('finish',0,'');that._cleanup();return;};if(!opts||!opts.no_credentials){that.xhr.withCredentials='true';}
if(opts&&opts.headers){for(var key in opts.headers){that.xhr.setRequestHeader(key,opts.headers[key]);}}
that.xhr.onreadystatechange=function(){if(that.xhr){var x=that.xhr;switch(x.readyState){case 3:try{var status=x.status;var text=x.responseText;}catch(x){};if(status===1223)status=204;if(text&&text.length>0){that.emit('chunk',status,text);}
break;case 4:var status=x.status;if(status===1223)status=204;that.emit('finish',status,x.responseText);that._cleanup(false);break;}}};that.xhr.send(payload);};AbstractXHRObject.prototype._cleanup=function(abort){var that=this;if(!that.xhr)return;utils.unload_del(that.unload_ref);that.xhr.onreadystatechange=function(){};if(abort){try{that.xhr.abort();}catch(x){};}
that.unload_ref=that.xhr=null;};AbstractXHRObject.prototype.close=function(){var that=this;that.nuke();that._cleanup(true);};var XHRCorsObject=utils.XHRCorsObject=function(){var that=this,args=arguments;utils.delay(function(){that._start.apply(that,args);});};XHRCorsObject.prototype=new AbstractXHRObject();var XHRLocalObject=utils.XHRLocalObject=function(method,url,payload){var that=this;utils.delay(function(){that._start(method,url,payload,{no_credentials:true});});};XHRLocalObject.prototype=new AbstractXHRObject();var XDRObject=utils.XDRObject=function(method,url,payload){var that=this;utils.delay(function(){that._start(method,url,payload);});};XDRObject.prototype=new EventEmitter(['chunk','finish']);XDRObject.prototype._start=function(method,url,payload){var that=this;var xdr=new XDomainRequest();url+=((url.indexOf('?')===-1)?'?':'&')+'t='+(+new Date);var onerror=xdr.ontimeout=xdr.onerror=function(){that.emit('finish',0,'');that._cleanup(false);};xdr.onprogress=function(){that.emit('chunk',200,xdr.responseText);};xdr.onload=function(){that.emit('finish',200,xdr.responseText);that._cleanup(false);};that.xdr=xdr;that.unload_ref=utils.unload_add(function(){that._cleanup(true);});try{that.xdr.open(method,url);that.xdr.send(payload);}catch(x){onerror();}};XDRObject.prototype._cleanup=function(abort){var that=this;if(!that.xdr)return;utils.unload_del(that.unload_ref);that.xdr.ontimeout=that.xdr.onerror=that.xdr.onprogress=that.xdr.onload=null;if(abort){try{that.xdr.abort();}catch(x){};}
that.unload_ref=that.xdr=null;};XDRObject.prototype.close=function(){var that=this;that.nuke();that._cleanup(true);};utils.isXHRCorsCapable=function(){try{if(_window.XMLHttpRequest&&'withCredentials'in new XMLHttpRequest()){return 1;}}catch(e){}
if(_window.XDomainRequest&&_document.domain){return 2;}
if(IframeTransport.enabled()){return 3;}
return 4;};var SockJS=function(url,dep_protocols_whitelist,options){if(this===_window){return new SockJS(url,dep_protocols_whitelist,options);}
var that=this,protocols_whitelist;that._options={devel:false,debug:false,protocols_whitelist:[],info:undefined,rtt:undefined};if(options){utils.objectExtend(that._options,options);}
that._base_url=utils.amendUrl(url);that._server=that._options.server||utils.random_number_string(1000);if(that._options.protocols_whitelist&&that._options.protocols_whitelist.length){protocols_whitelist=that._options.protocols_whitelist;}else{if(typeof dep_protocols_whitelist==='string'&&dep_protocols_whitelist.length>0){protocols_whitelist=[dep_protocols_whitelist];}else if(utils.isArray(dep_protocols_whitelist)){protocols_whitelist=dep_protocols_whitelist}else{protocols_whitelist=null;}
if(protocols_whitelist){that._debug('Deprecated API: Use "protocols_whitelist" option '+'instead of supplying protocol list as a second '+'parameter to SockJS constructor.');}}
that._protocols=[];that.protocol=null;that.readyState=SockJS.CONNECTING;that._ir=createInfoReceiver(that._base_url);that._ir.onfinish=function(info,rtt){that._ir=null;if(info){if(that._options.info){info=utils.objectExtend(info,that._options.info);}
if(that._options.rtt){rtt=that._options.rtt;}
that._applyInfo(info,rtt,protocols_whitelist);that._didClose();}else{that._didClose(1002,'Can\'t connect to server',true);}};};SockJS.prototype=new REventTarget();SockJS.version="0.3.4";SockJS.CONNECTING=0;SockJS.OPEN=1;SockJS.CLOSING=2;SockJS.CLOSED=3;SockJS.prototype._debug=function(){if(this._options.debug)
utils.log.apply(utils,arguments);};SockJS.prototype._dispatchOpen=function(){var that=this;if(that.readyState===SockJS.CONNECTING){if(that._transport_tref){clearTimeout(that._transport_tref);that._transport_tref=null;}
that.readyState=SockJS.OPEN;that.dispatchEvent(new SimpleEvent("open"));}else{that._didClose(1006,"Server lost session");}};SockJS.prototype._dispatchMessage=function(data){var that=this;if(that.readyState!==SockJS.OPEN)
return;that.dispatchEvent(new SimpleEvent("message",{data:data}));};SockJS.prototype._dispatchHeartbeat=function(data){var that=this;if(that.readyState!==SockJS.OPEN)
return;that.dispatchEvent(new SimpleEvent('heartbeat',{}));};SockJS.prototype._didClose=function(code,reason,force){var that=this;if(that.readyState!==SockJS.CONNECTING&&that.readyState!==SockJS.OPEN&&that.readyState!==SockJS.CLOSING)
throw new Error('INVALID_STATE_ERR');if(that._ir){that._ir.nuke();that._ir=null;}
if(that._transport){that._transport.doCleanup();that._transport=null;}
var close_event=new SimpleEvent("close",{code:code,reason:reason,wasClean:utils.userSetCode(code)});if(!utils.userSetCode(code)&&that.readyState===SockJS.CONNECTING&&!force){if(that._try_next_protocol(close_event)){return;}
close_event=new SimpleEvent("close",{code:2000,reason:"All transports failed",wasClean:false,last_event:close_event});}
that.readyState=SockJS.CLOSED;utils.delay(function(){that.dispatchEvent(close_event);});};SockJS.prototype._didMessage=function(data){var that=this;var type=data.slice(0,1);switch(type){case'o':that._dispatchOpen();break;case'a':var payload=JSON.parse(data.slice(1)||'[]');for(var i=0;i<payload.length;i++){that._dispatchMessage(payload[i]);}
break;case'm':var payload=JSON.parse(data.slice(1)||'null');that._dispatchMessage(payload);break;case'c':var payload=JSON.parse(data.slice(1)||'[]');that._didClose(payload[0],payload[1]);break;case'h':that._dispatchHeartbeat();break;}};SockJS.prototype._try_next_protocol=function(close_event){var that=this;if(that.protocol){that._debug('Closed transport:',that.protocol,''+close_event);that.protocol=null;}
if(that._transport_tref){clearTimeout(that._transport_tref);that._transport_tref=null;}
while(1){var protocol=that.protocol=that._protocols.shift();if(!protocol){return false;}
if(SockJS[protocol]&&SockJS[protocol].need_body===true&&(!_document.body||(typeof _document.readyState!=='undefined'&&_document.readyState!=='complete'))){that._protocols.unshift(protocol);that.protocol='waiting-for-load';utils.attachEvent('load',function(){that._try_next_protocol();});return true;}
if(!SockJS[protocol]||!SockJS[protocol].enabled(that._options)){that._debug('Skipping transport:',protocol);}else{var roundTrips=SockJS[protocol].roundTrips||1;var to=((that._options.rto||0)*roundTrips)||5000;that._transport_tref=utils.delay(to,function(){if(that.readyState===SockJS.CONNECTING){that._didClose(2007,"Transport timeouted");}});var connid=utils.random_string(8);var trans_url=that._base_url+'/'+that._server+'/'+connid;that._debug('Opening transport:',protocol,' url:'+trans_url,' RTO:'+that._options.rto);that._transport=new SockJS[protocol](that,trans_url,that._base_url);return true;}}};SockJS.prototype.close=function(code,reason){var that=this;if(code&&!utils.userSetCode(code))
throw new Error("INVALID_ACCESS_ERR");if(that.readyState!==SockJS.CONNECTING&&that.readyState!==SockJS.OPEN){return false;}
that.readyState=SockJS.CLOSING;that._didClose(code||1000,reason||"Normal closure");return true;};SockJS.prototype.send=function(data){var that=this;if(that.readyState===SockJS.CONNECTING)
throw new Error('INVALID_STATE_ERR');if(that.readyState===SockJS.OPEN){that._transport.doSend(utils.quote(''+data));}
return true;};SockJS.prototype._applyInfo=function(info,rtt,protocols_whitelist){var that=this;that._options.info=info;that._options.rtt=rtt;that._options.rto=utils.countRTO(rtt);that._options.info.null_origin=!_document.domain;var probed=utils.probeProtocols();that._protocols=utils.detectProtocols(probed,protocols_whitelist,info);};var WebSocketTransport=SockJS.websocket=function(ri,trans_url){var that=this;var url=trans_url+'/websocket';if(url.slice(0,5)==='https'){url='wss'+url.slice(5);}else{url='ws'+url.slice(4);}
that.ri=ri;that.url=url;var Constructor=_window.WebSocket||_window.MozWebSocket;that.ws=new Constructor(that.url);that.ws.onmessage=function(e){that.ri._didMessage(e.data);};that.unload_ref=utils.unload_add(function(){that.ws.close()});that.ws.onclose=function(){that.ri._didMessage(utils.closeFrame(1006,"WebSocket connection broken"));};};WebSocketTransport.prototype.doSend=function(data){this.ws.send('['+data+']');};WebSocketTransport.prototype.doCleanup=function(){var that=this;var ws=that.ws;if(ws){ws.onmessage=ws.onclose=null;ws.close();utils.unload_del(that.unload_ref);that.unload_ref=that.ri=that.ws=null;}};WebSocketTransport.enabled=function(){return!!(_window.WebSocket||_window.MozWebSocket);};WebSocketTransport.roundTrips=2;var BufferedSender=function(){};BufferedSender.prototype.send_constructor=function(sender){var that=this;that.send_buffer=[];that.sender=sender;};BufferedSender.prototype.doSend=function(message){var that=this;that.send_buffer.push(message);if(!that.send_stop){that.send_schedule();}};BufferedSender.prototype.send_schedule_wait=function(){var that=this;var tref;that.send_stop=function(){that.send_stop=null;clearTimeout(tref);};tref=utils.delay(25,function(){that.send_stop=null;that.send_schedule();});};BufferedSender.prototype.send_schedule=function(){var that=this;if(that.send_buffer.length>0){var payload='['+that.send_buffer.join(',')+']';that.send_stop=that.sender(that.trans_url,payload,function(success,abort_reason){that.send_stop=null;if(success===false){that.ri._didClose(1006,'Sending error '+abort_reason);}else{that.send_schedule_wait();}});that.send_buffer=[];}};BufferedSender.prototype.send_destructor=function(){var that=this;if(that._send_stop){that._send_stop();}
that._send_stop=null;};var jsonPGenericSender=function(url,payload,callback){var that=this;if(!('_send_form'in that)){var form=that._send_form=_document.createElement('form');var area=that._send_area=_document.createElement('textarea');area.name='d';form.style.display='none';form.style.position='absolute';form.method='POST';form.enctype='application/x-www-form-urlencoded';form.acceptCharset="UTF-8";form.appendChild(area);_document.body.appendChild(form);}
var form=that._send_form;var area=that._send_area;var id='a'+utils.random_string(8);form.target=id;form.action=url+'/jsonp_send?i='+id;var iframe;try{iframe=_document.createElement('<iframe name="'+id+'">');}catch(x){iframe=_document.createElement('iframe');iframe.name=id;}
iframe.id=id;form.appendChild(iframe);iframe.style.display='none';try{area.value=payload;}catch(e){utils.log('Your browser is seriously broken. Go home! '+e.message);}
form.submit();var completed=function(e){if(!iframe.onerror)return;iframe.onreadystatechange=iframe.onerror=iframe.onload=null;utils.delay(500,function(){iframe.parentNode.removeChild(iframe);iframe=null;});area.value='';callback(true);};iframe.onerror=iframe.onload=completed;iframe.onreadystatechange=function(e){if(iframe.readyState=='complete')completed();};return completed;};var createAjaxSender=function(AjaxObject){return function(url,payload,callback){var xo=new AjaxObject('POST',url+'/xhr_send',payload);xo.onfinish=function(status,text){callback(status===200||status===204,'http status '+status);};return function(abort_reason){callback(false,abort_reason);};};};var jsonPGenericReceiver=function(url,callback){var tref;var script=_document.createElement('script');var script2;var close_script=function(frame){if(script2){script2.parentNode.removeChild(script2);script2=null;}
if(script){clearTimeout(tref);script.parentNode.removeChild(script);script.onreadystatechange=script.onerror=script.onload=script.onclick=null;script=null;callback(frame);callback=null;}};var loaded_okay=false;var error_timer=null;script.id='a'+utils.random_string(8);script.src=url;script.type='text/javascript';script.charset='UTF-8';script.onerror=function(e){if(!error_timer){error_timer=setTimeout(function(){if(!loaded_okay){close_script(utils.closeFrame(1006,"JSONP script loaded abnormally (onerror)"));}},1000);}};script.onload=function(e){close_script(utils.closeFrame(1006,"JSONP script loaded abnormally (onload)"));};script.onreadystatechange=function(e){if(/loaded|closed/.test(script.readyState)){if(script&&script.htmlFor&&script.onclick){loaded_okay=true;try{script.onclick();}catch(x){}}
if(script){close_script(utils.closeFrame(1006,"JSONP script loaded abnormally (onreadystatechange)"));}}};if(typeof script.async==='undefined'&&_document.attachEvent){if(!/opera/i.test(navigator.userAgent)){try{script.htmlFor=script.id;script.event="onclick";}catch(x){}
script.async=true;}else{script2=_document.createElement('script');script2.text="try{var a = document.getElementById('"+script.id+"'); if(a)a.onerror();}catch(x){};";script.async=script2.async=false;}}
if(typeof script.async!=='undefined'){script.async=true;}
tref=setTimeout(function(){close_script(utils.closeFrame(1006,"JSONP script loaded abnormally (timeout)"));},35000);var head=_document.getElementsByTagName('head')[0];head.insertBefore(script,head.firstChild);if(script2){head.insertBefore(script2,head.firstChild);}
return close_script;};var JsonPTransport=SockJS['jsonp-polling']=function(ri,trans_url){utils.polluteGlobalNamespace();var that=this;that.ri=ri;that.trans_url=trans_url;that.send_constructor(jsonPGenericSender);that._schedule_recv();};JsonPTransport.prototype=new BufferedSender();JsonPTransport.prototype._schedule_recv=function(){var that=this;var callback=function(data){that._recv_stop=null;if(data){if(!that._is_closing){that.ri._didMessage(data);}}
if(!that._is_closing){that._schedule_recv();}};that._recv_stop=jsonPReceiverWrapper(that.trans_url+'/jsonp',jsonPGenericReceiver,callback);};JsonPTransport.enabled=function(){return true;};JsonPTransport.need_body=true;JsonPTransport.prototype.doCleanup=function(){var that=this;that._is_closing=true;if(that._recv_stop){that._recv_stop();}
that.ri=that._recv_stop=null;that.send_destructor();};var jsonPReceiverWrapper=function(url,constructReceiver,user_callback){var id='a'+utils.random_string(6);var url_id=url+'?c='+escape(WPrefix+'.'+id);var aborting=0;var callback=function(frame){switch(aborting){case 0:delete _window[WPrefix][id];user_callback(frame);break;case 1:user_callback(frame);aborting=2;break;case 2:delete _window[WPrefix][id];break;}};var close_script=constructReceiver(url_id,callback);_window[WPrefix][id]=close_script;var stop=function(){if(_window[WPrefix][id]){aborting=1;_window[WPrefix][id](utils.closeFrame(1000,"JSONP user aborted read"));}};return stop;};var AjaxBasedTransport=function(){};AjaxBasedTransport.prototype=new BufferedSender();AjaxBasedTransport.prototype.run=function(ri,trans_url,url_suffix,Receiver,AjaxObject){var that=this;that.ri=ri;that.trans_url=trans_url;that.send_constructor(createAjaxSender(AjaxObject));that.poll=new Polling(ri,Receiver,trans_url+url_suffix,AjaxObject);};AjaxBasedTransport.prototype.doCleanup=function(){var that=this;if(that.poll){that.poll.abort();that.poll=null;}};var XhrStreamingTransport=SockJS['xhr-streaming']=function(ri,trans_url){this.run(ri,trans_url,'/xhr_streaming',XhrReceiver,utils.XHRCorsObject);};XhrStreamingTransport.prototype=new AjaxBasedTransport();XhrStreamingTransport.enabled=function(){try{return(_window.XMLHttpRequest&&'withCredentials'in new XMLHttpRequest()&&(!/opera/i.test(navigator.userAgent)));}catch(e){return false;}};XhrStreamingTransport.roundTrips=2;XhrStreamingTransport.need_body=true;var XdrStreamingTransport=SockJS['xdr-streaming']=function(ri,trans_url){this.run(ri,trans_url,'/xhr_streaming',XhrReceiver,utils.XDRObject);};XdrStreamingTransport.prototype=new AjaxBasedTransport();XdrStreamingTransport.enabled=function(){return!!_window.XDomainRequest;};XdrStreamingTransport.roundTrips=2;var XhrPollingTransport=SockJS['xhr-polling']=function(ri,trans_url){this.run(ri,trans_url,'/xhr',XhrReceiver,utils.XHRCorsObject);};XhrPollingTransport.prototype=new AjaxBasedTransport();XhrPollingTransport.enabled=XhrStreamingTransport.enabled;XhrPollingTransport.roundTrips=2;var XdrPollingTransport=SockJS['xdr-polling']=function(ri,trans_url){this.run(ri,trans_url,'/xhr',XhrReceiver,utils.XDRObject);};XdrPollingTransport.prototype=new AjaxBasedTransport();XdrPollingTransport.enabled=XdrStreamingTransport.enabled;XdrPollingTransport.roundTrips=2;var IframeTransport=function(){};IframeTransport.prototype.i_constructor=function(ri,trans_url,base_url){var that=this;that.ri=ri;that.origin=utils.getOrigin(base_url);that.base_url=base_url;that.trans_url=trans_url;var iframe_url=base_url+'/iframe.html';if(that.ri._options.devel){iframe_url+='?t='+(+new Date);}
that.window_id=utils.random_string(8);iframe_url+='#'+that.window_id;that.iframeObj=utils.createIframe(iframe_url,function(r){that.ri._didClose(1006,"Unable to load an iframe ("+r+")");});that.onmessage_cb=utils.bind(that.onmessage,that);utils.attachMessage(that.onmessage_cb);};IframeTransport.prototype.doCleanup=function(){var that=this;if(that.iframeObj){utils.detachMessage(that.onmessage_cb);try{if(that.iframeObj.iframe.contentWindow){that.postMessage('c');}}catch(x){}
that.iframeObj.cleanup();that.iframeObj=null;that.onmessage_cb=that.iframeObj=null;}};IframeTransport.prototype.onmessage=function(e){var that=this;if(e.origin!==that.origin)return;var window_id=e.data.slice(0,8);var type=e.data.slice(8,9);var data=e.data.slice(9);if(window_id!==that.window_id)return;switch(type){case's':that.iframeObj.loaded();that.postMessage('s',JSON.stringify([SockJS.version,that.protocol,that.trans_url,that.base_url]));break;case't':that.ri._didMessage(data);break;}};IframeTransport.prototype.postMessage=function(type,data){var that=this;that.iframeObj.post(that.window_id+type+(data||''),that.origin);};IframeTransport.prototype.doSend=function(message){this.postMessage('m',message);};IframeTransport.enabled=function(){var konqueror=navigator&&navigator.userAgent&&navigator.userAgent.indexOf('Konqueror')!==-1;return((typeof _window.postMessage==='function'||typeof _window.postMessage==='object')&&(!konqueror));};var curr_window_id;var postMessage=function(type,data){if(parent!==_window){parent.postMessage(curr_window_id+type+(data||''),'*');}else{utils.log("Can't postMessage, no parent window.",type,data);}};var FacadeJS=function(){};FacadeJS.prototype._didClose=function(code,reason){postMessage('t',utils.closeFrame(code,reason));};FacadeJS.prototype._didMessage=function(frame){postMessage('t',frame);};FacadeJS.prototype._doSend=function(data){this._transport.doSend(data);};FacadeJS.prototype._doCleanup=function(){this._transport.doCleanup();};utils.parent_origin=undefined;SockJS.bootstrap_iframe=function(){var facade;curr_window_id=_document.location.hash.slice(1);var onMessage=function(e){if(e.source!==parent)return;if(typeof utils.parent_origin==='undefined')
utils.parent_origin=e.origin;if(e.origin!==utils.parent_origin)return;var window_id=e.data.slice(0,8);var type=e.data.slice(8,9);var data=e.data.slice(9);if(window_id!==curr_window_id)return;switch(type){case's':var p=JSON.parse(data);var version=p[0];var protocol=p[1];var trans_url=p[2];var base_url=p[3];if(version!==SockJS.version){utils.log("Incompatibile SockJS! Main site uses:"+" \""+version+"\", the iframe:"+" \""+SockJS.version+"\".");}
if(!utils.flatUrl(trans_url)||!utils.flatUrl(base_url)){utils.log("Only basic urls are supported in SockJS");return;}
if(!utils.isSameOriginUrl(trans_url)||!utils.isSameOriginUrl(base_url)){utils.log("Can't connect to different domain from within an "+"iframe. ("+JSON.stringify([_window.location.href,trans_url,base_url])+")");return;}
facade=new FacadeJS();facade._transport=new FacadeJS[protocol](facade,trans_url,base_url);break;case'm':facade._doSend(data);break;case'c':if(facade)
facade._doCleanup();facade=null;break;}};utils.attachMessage(onMessage);postMessage('s');};var InfoReceiver=function(base_url,AjaxObject){var that=this;utils.delay(function(){that.doXhr(base_url,AjaxObject);});};InfoReceiver.prototype=new EventEmitter(['finish']);InfoReceiver.prototype.doXhr=function(base_url,AjaxObject){var that=this;var t0=(new Date()).getTime();var xo=new AjaxObject('GET',base_url+'/info');var tref=utils.delay(8000,function(){xo.ontimeout();});xo.onfinish=function(status,text){clearTimeout(tref);tref=null;if(status===200){var rtt=(new Date()).getTime()-t0;var info=JSON.parse(text);if(typeof info!=='object')info={};that.emit('finish',info,rtt);}else{that.emit('finish');}};xo.ontimeout=function(){xo.close();that.emit('finish');};};var InfoReceiverIframe=function(base_url){var that=this;var go=function(){var ifr=new IframeTransport();ifr.protocol='w-iframe-info-receiver';var fun=function(r){if(typeof r==='string'&&r.substr(0,1)==='m'){var d=JSON.parse(r.substr(1));var info=d[0],rtt=d[1];that.emit('finish',info,rtt);}else{that.emit('finish');}
ifr.doCleanup();ifr=null;};var mock_ri={_options:{},_didClose:fun,_didMessage:fun};ifr.i_constructor(mock_ri,base_url,base_url);}
if(!_document.body){utils.attachEvent('load',go);}else{go();}};InfoReceiverIframe.prototype=new EventEmitter(['finish']);var InfoReceiverFake=function(){var that=this;utils.delay(function(){that.emit('finish',{},2000);});};InfoReceiverFake.prototype=new EventEmitter(['finish']);var createInfoReceiver=function(base_url){if(utils.isSameOriginUrl(base_url)){return new InfoReceiver(base_url,utils.XHRLocalObject);}
switch(utils.isXHRCorsCapable()){case 1:return new InfoReceiver(base_url,utils.XHRLocalObject);case 2:return new InfoReceiver(base_url,utils.XDRObject);case 3:return new InfoReceiverIframe(base_url);default:return new InfoReceiverFake();};};var WInfoReceiverIframe=FacadeJS['w-iframe-info-receiver']=function(ri,_trans_url,base_url){var ir=new InfoReceiver(base_url,utils.XHRLocalObject);ir.onfinish=function(info,rtt){ri._didMessage('m'+JSON.stringify([info,rtt]));ri._didClose();}};WInfoReceiverIframe.prototype.doCleanup=function(){};var EventSourceIframeTransport=SockJS['iframe-eventsource']=function(){var that=this;that.protocol='w-iframe-eventsource';that.i_constructor.apply(that,arguments);};EventSourceIframeTransport.prototype=new IframeTransport();EventSourceIframeTransport.enabled=function(){return('EventSource'in _window)&&IframeTransport.enabled();};EventSourceIframeTransport.need_body=true;EventSourceIframeTransport.roundTrips=3;var EventSourceTransport=FacadeJS['w-iframe-eventsource']=function(ri,trans_url){this.run(ri,trans_url,'/eventsource',EventSourceReceiver,utils.XHRLocalObject);}
EventSourceTransport.prototype=new AjaxBasedTransport();var XhrPollingIframeTransport=SockJS['iframe-xhr-polling']=function(){var that=this;that.protocol='w-iframe-xhr-polling';that.i_constructor.apply(that,arguments);};XhrPollingIframeTransport.prototype=new IframeTransport();XhrPollingIframeTransport.enabled=function(){return _window.XMLHttpRequest&&IframeTransport.enabled();};XhrPollingIframeTransport.need_body=true;XhrPollingIframeTransport.roundTrips=3;var XhrPollingITransport=FacadeJS['w-iframe-xhr-polling']=function(ri,trans_url){this.run(ri,trans_url,'/xhr',XhrReceiver,utils.XHRLocalObject);};XhrPollingITransport.prototype=new AjaxBasedTransport();var HtmlFileIframeTransport=SockJS['iframe-htmlfile']=function(){var that=this;that.protocol='w-iframe-htmlfile';that.i_constructor.apply(that,arguments);};HtmlFileIframeTransport.prototype=new IframeTransport();HtmlFileIframeTransport.enabled=function(){return IframeTransport.enabled();};HtmlFileIframeTransport.need_body=true;HtmlFileIframeTransport.roundTrips=3;var HtmlFileTransport=FacadeJS['w-iframe-htmlfile']=function(ri,trans_url){this.run(ri,trans_url,'/htmlfile',HtmlfileReceiver,utils.XHRLocalObject);};HtmlFileTransport.prototype=new AjaxBasedTransport();var Polling=function(ri,Receiver,recv_url,AjaxObject){var that=this;that.ri=ri;that.Receiver=Receiver;that.recv_url=recv_url;that.AjaxObject=AjaxObject;that._scheduleRecv();};Polling.prototype._scheduleRecv=function(){var that=this;var poll=that.poll=new that.Receiver(that.recv_url,that.AjaxObject);var msg_counter=0;poll.onmessage=function(e){msg_counter+=1;that.ri._didMessage(e.data);};poll.onclose=function(e){that.poll=poll=poll.onmessage=poll.onclose=null;if(!that.poll_is_closing){if(e.reason==='permanent'){that.ri._didClose(1006,'Polling error ('+e.reason+')');}else{that._scheduleRecv();}}};};Polling.prototype.abort=function(){var that=this;that.poll_is_closing=true;if(that.poll){that.poll.abort();}};var EventSourceReceiver=function(url){var that=this;var es=new EventSource(url);es.onmessage=function(e){that.dispatchEvent(new SimpleEvent('message',{'data':unescape(e.data)}));};that.es_close=es.onerror=function(e,abort_reason){var reason=abort_reason?'user':(es.readyState!==2?'network':'permanent');that.es_close=es.onmessage=es.onerror=null;es.close();es=null;utils.delay(200,function(){that.dispatchEvent(new SimpleEvent('close',{reason:reason}));});};};EventSourceReceiver.prototype=new REventTarget();EventSourceReceiver.prototype.abort=function(){var that=this;if(that.es_close){that.es_close({},true);}};var _is_ie_htmlfile_capable;var isIeHtmlfileCapable=function(){if(_is_ie_htmlfile_capable===undefined){if('ActiveXObject'in _window){try{_is_ie_htmlfile_capable=!!new ActiveXObject('htmlfile');}catch(x){}}else{_is_ie_htmlfile_capable=false;}}
return _is_ie_htmlfile_capable;};var HtmlfileReceiver=function(url){var that=this;utils.polluteGlobalNamespace();that.id='a'+utils.random_string(6,26);url+=((url.indexOf('?')===-1)?'?':'&')+'c='+escape(WPrefix+'.'+that.id);var constructor=isIeHtmlfileCapable()?utils.createHtmlfile:utils.createIframe;var iframeObj;_window[WPrefix][that.id]={start:function(){iframeObj.loaded();},message:function(data){that.dispatchEvent(new SimpleEvent('message',{'data':data}));},stop:function(){that.iframe_close({},'network');}};that.iframe_close=function(e,abort_reason){iframeObj.cleanup();that.iframe_close=iframeObj=null;delete _window[WPrefix][that.id];that.dispatchEvent(new SimpleEvent('close',{reason:abort_reason}));};iframeObj=constructor(url,function(e){that.iframe_close({},'permanent');});};HtmlfileReceiver.prototype=new REventTarget();HtmlfileReceiver.prototype.abort=function(){var that=this;if(that.iframe_close){that.iframe_close({},'user');}};var XhrReceiver=function(url,AjaxObject){var that=this;var buf_pos=0;that.xo=new AjaxObject('POST',url,null);that.xo.onchunk=function(status,text){if(status!==200)return;while(1){var buf=text.slice(buf_pos);var p=buf.indexOf('\n');if(p===-1)break;buf_pos+=p+1;var msg=buf.slice(0,p);that.dispatchEvent(new SimpleEvent('message',{data:msg}));}};that.xo.onfinish=function(status,text){that.xo.onchunk(status,text);that.xo=null;var reason=status===200?'network':'permanent';that.dispatchEvent(new SimpleEvent('close',{reason:reason}));}};XhrReceiver.prototype=new REventTarget();XhrReceiver.prototype.abort=function(){var that=this;if(that.xo){that.xo.close();that.dispatchEvent(new SimpleEvent('close',{reason:'user'}));that.xo=null;}};SockJS.getUtils=function(){return utils;};SockJS.getIframeTransport=function(){return IframeTransport;};return SockJS;})();if('_sockjs_onload'in window)setTimeout(_sockjs_onload,1);if(typeof define==='function'&&define.amd){define('sockjs',[],function(){return SockJS;});}
(function(global,factory){if(typeof module==="object"&&typeof module.exports==="object"){module.exports=global.document?factory(global,true):function(w){if(!w.document){throw new Error("jQuery requires a window with a document");}
return factory(w);};}else{factory(global);}}(typeof window!=="undefined"?window:this,function(window,noGlobal){var deletedIds=[];var slice=deletedIds.slice;var concat=deletedIds.concat;var push=deletedIds.push;var indexOf=deletedIds.indexOf;var class2type={};var toString=class2type.toString;var hasOwn=class2type.hasOwnProperty;var support={};var
version="1.11.1",jQuery=function(selector,context){return new jQuery.fn.init(selector,context);},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase();};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this);},get:function(num){return num!=null?(num<0?this[num+this.length]:this[num]):slice.call(this);},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);ret.prevObject=this;ret.context=this.context;return ret;},each:function(callback,args){return jQuery.each(this,callback,args);},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem);}));},slice:function(){return this.pushStack(slice.apply(this,arguments));},first:function(){return this.eq(0);},last:function(){return this.eq(-1);},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[]);},end:function(){return this.prevObject||this.constructor(null);},push:push,sort:deletedIds.sort,splice:deletedIds.splice};jQuery.extend=jQuery.fn.extend=function(){var src,copyIsArray,copy,name,options,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[i]||{};i++;}
if(typeof target!=="object"&&!jQuery.isFunction(target)){target={};}
if(i===length){target=this;i--;}
for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue;}
if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&jQuery.isArray(src)?src:[];}else{clone=src&&jQuery.isPlainObject(src)?src:{};}
target[name]=jQuery.extend(deep,clone,copy);}else if(copy!==undefined){target[name]=copy;}}}}
return target;};jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:true,error:function(msg){throw new Error(msg);},noop:function(){},isFunction:function(obj){return jQuery.type(obj)==="function";},isArray:Array.isArray||function(obj){return jQuery.type(obj)==="array";},isWindow:function(obj){return obj!=null&&obj==obj.window;},isNumeric:function(obj){return!jQuery.isArray(obj)&&obj-parseFloat(obj)>=0;},isEmptyObject:function(obj){var name;for(name in obj){return false;}
return true;},isPlainObject:function(obj){var key;if(!obj||jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj)){return false;}
try{if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){return false;}}catch(e){return false;}
if(support.ownLast){for(key in obj){return hasOwn.call(obj,key);}}
for(key in obj){}
return key===undefined||hasOwn.call(obj,key);},type:function(obj){if(obj==null){return obj+"";}
return typeof obj==="object"||typeof obj==="function"?class2type[toString.call(obj)]||"object":typeof obj;},globalEval:function(data){if(data&&jQuery.trim(data)){(window.execScript||function(data){window["eval"].call(window,data);})(data);}},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase);},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase();},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray){for(;i<length;i++){value=callback.apply(obj[i],args);if(value===false){break;}}}else{for(i in obj){value=callback.apply(obj[i],args);if(value===false){break;}}}}else{if(isArray){for(;i<length;i++){value=callback.call(obj[i],i,obj[i]);if(value===false){break;}}}else{for(i in obj){value=callback.call(obj[i],i,obj[i]);if(value===false){break;}}}}
return obj;},trim:function(text){return text==null?"":(text+"").replace(rtrim,"");},makeArray:function(arr,results){var ret=results||[];if(arr!=null){if(isArraylike(Object(arr))){jQuery.merge(ret,typeof arr==="string"?[arr]:arr);}else{push.call(ret,arr);}}
return ret;},inArray:function(elem,arr,i){var len;if(arr){if(indexOf){return indexOf.call(arr,elem,i);}
len=arr.length;i=i?i<0?Math.max(0,len+i):i:0;for(;i<len;i++){if(i in arr&&arr[i]===elem){return i;}}}
return-1;},merge:function(first,second){var len=+second.length,j=0,i=first.length;while(j<len){first[i++]=second[j++];}
if(len!==len){while(second[j]!==undefined){first[i++]=second[j++];}}
first.length=i;return first;},grep:function(elems,callback,invert){var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;for(;i<length;i++){callbackInverse=!callback(elems[i],i);if(callbackInverse!==callbackExpect){matches.push(elems[i]);}}
return matches;},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray){for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null){ret.push(value);}}}else{for(i in elems){value=callback(elems[i],i,arg);if(value!=null){ret.push(value);}}}
return concat.apply([],ret);},guid:1,proxy:function(fn,context){var args,proxy,tmp;if(typeof context==="string"){tmp=fn[context];context=fn;fn=tmp;}
if(!jQuery.isFunction(fn)){return undefined;}
args=slice.call(arguments,2);proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)));};proxy.guid=fn.guid=fn.guid||jQuery.guid++;return proxy;},now:function(){return+(new Date());},support:support});jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase();});function isArraylike(obj){var length=obj.length,type=jQuery.type(obj);if(type==="function"||jQuery.isWindow(obj)){return false;}
if(obj.nodeType===1&&length){return true;}
return type==="array"||length===0||typeof length==="number"&&length>0&&(length-1)in obj;}
var Sizzle=(function(window){var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+-(new Date()),preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){if(a===b){hasDuplicate=true;}
return 0;},strundefined=typeof undefined,MAX_NEGATIVE=1<<31,hasOwn=({}).hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){var i=0,len=this.length;for(;i<len;i++){if(this[i]===elem){return i;}}
return-1;},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|"+".*"+")\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={"ID":new RegExp("^#("+characterEncoding+")"),"CLASS":new RegExp("^\\.("+characterEncoding+")"),"TAG":new RegExp("^("+characterEncoding.replace("w","w*")+")"),"ATTR":new RegExp("^"+attributes),"PSEUDO":new RegExp("^"+pseudos),"CHILD":new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),"bool":new RegExp("^(?:"+booleans+")$","i"),"needsContext":new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+
whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-0x10000;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+0x10000):String.fromCharCode(high>>10|0xD800,high&0x3FF|0xDC00);};try{push.apply((arr=slice.call(preferredDoc.childNodes)),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType;}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els));}:function(target,els){var j=target.length,i=0;while((target[j++]=els[i++])){}
target.length=j-1;}};}
function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document){setDocument(context);}
context=context||document;results=results||[];if(!selector||typeof selector!=="string"){return results;}
if((nodeType=context.nodeType)!==1&&nodeType!==9){return[];}
if(documentIsHTML&&!seed){if((match=rquickExpr.exec(selector))){if((m=match[1])){if(nodeType===9){elem=context.getElementById(m);if(elem&&elem.parentNode){if(elem.id===m){results.push(elem);return results;}}else{return results;}}else{if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results;}}}else if(match[2]){push.apply(results,context.getElementsByTagName(selector));return results;}else if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));return results;}}
if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){nid=old=expando;newContext=context;newSelector=nodeType===9&&selector;if(nodeType===1&&context.nodeName.toLowerCase()!=="object"){groups=tokenize(selector);if((old=context.getAttribute("id"))){nid=old.replace(rescape,"\\$&");}else{context.setAttribute("id",nid);}
nid="[id='"+nid+"'] ";i=groups.length;while(i--){groups[i]=nid+toSelector(groups[i]);}
newContext=rsibling.test(selector)&&testContext(context.parentNode)||context;newSelector=groups.join(",");}
if(newSelector){try{push.apply(results,newContext.querySelectorAll(newSelector));return results;}catch(qsaError){}finally{if(!old){context.removeAttribute("id");}}}}}
return select(selector.replace(rtrim,"$1"),context,results,seed);}
function createCache(){var keys=[];function cache(key,value){if(keys.push(key+" ")>Expr.cacheLength){delete cache[keys.shift()];}
return(cache[key+" "]=value);}
return cache;}
function markFunction(fn){fn[expando]=true;return fn;}
function assert(fn){var div=document.createElement("div");try{return!!fn(div);}catch(e){return false;}finally{if(div.parentNode){div.parentNode.removeChild(div);}
div=null;}}
function addHandle(attrs,handler){var arr=attrs.split("|"),i=attrs.length;while(i--){Expr.attrHandle[arr[i]]=handler;}}
function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&(~b.sourceIndex||MAX_NEGATIVE)-
(~a.sourceIndex||MAX_NEGATIVE);if(diff){return diff;}
if(cur){while((cur=cur.nextSibling)){if(cur===b){return-1;}}}
return a?1:-1;}
function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type===type;};}
function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&elem.type===type;};}
function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;return markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;while(i--){if(seed[(j=matchIndexes[i])]){seed[j]=!(matches[j]=seed[j]);}}});});}
function testContext(context){return context&&typeof context.getElementsByTagName!==strundefined&&context;}
support=Sizzle.support={};isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?documentElement.nodeName!=="HTML":false;};setDocument=Sizzle.setDocument=function(node){var hasCompare,doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;if(doc===document||doc.nodeType!==9||!doc.documentElement){return document;}
document=doc;docElem=doc.documentElement;documentIsHTML=!isXML(doc);if(parent&&parent!==parent.top){if(parent.addEventListener){parent.addEventListener("unload",function(){setDocument();},false);}else if(parent.attachEvent){parent.attachEvent("onunload",function(){setDocument();});}}
support.attributes=assert(function(div){div.className="i";return!div.getAttribute("className");});support.getElementsByTagName=assert(function(div){div.appendChild(doc.createComment(""));return!div.getElementsByTagName("*").length;});support.getElementsByClassName=rnative.test(doc.getElementsByClassName)&&assert(function(div){div.innerHTML="<div class='a'></div><div class='a i'></div>";div.firstChild.className="i";return div.getElementsByClassName("i").length===2;});support.getById=assert(function(div){docElem.appendChild(div).id=expando;return!doc.getElementsByName||!doc.getElementsByName(expando).length;});if(support.getById){Expr.find["ID"]=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[];}};Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId;};};}else{delete Expr.find["ID"];Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===attrId;};};}
Expr.find["TAG"]=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!==strundefined){return context.getElementsByTagName(tag);}}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if(tag==="*"){while((elem=results[i++])){if(elem.nodeType===1){tmp.push(elem);}}
return tmp;}
return results;};Expr.find["CLASS"]=support.getElementsByClassName&&function(className,context){if(typeof context.getElementsByClassName!==strundefined&&documentIsHTML){return context.getElementsByClassName(className);}};rbuggyMatches=[];rbuggyQSA=[];if((support.qsa=rnative.test(doc.querySelectorAll))){assert(function(div){div.innerHTML="<select msallowclip=''><option selected=''></option></select>";if(div.querySelectorAll("[msallowclip^='']").length){rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")");}
if(!div.querySelectorAll("[selected]").length){rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")");}
if(!div.querySelectorAll(":checked").length){rbuggyQSA.push(":checked");}});assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden");div.appendChild(input).setAttribute("name","D");if(div.querySelectorAll("[name=d]").length){rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?=");}
if(!div.querySelectorAll(":enabled").length){rbuggyQSA.push(":enabled",":disabled");}
div.querySelectorAll("*,:x");rbuggyQSA.push(",.*:");});}
if((support.matchesSelector=rnative.test((matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector)))){assert(function(div){support.disconnectedMatch=matches.call(div,"div");matches.call(div,"[s!='']:x");rbuggyMatches.push("!=",pseudos);});}
rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));hasCompare=rnative.test(docElem.compareDocumentPosition);contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16));}:function(a,b){if(b){while((b=b.parentNode)){if(b===a){return true;}}}
return false;};sortOrder=hasCompare?function(a,b){if(a===b){hasDuplicate=true;return 0;}
var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;if(compare){return compare;}
compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1;if(compare&1||(!support.sortDetached&&b.compareDocumentPosition(a)===compare)){if(a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)){return-1;}
if(b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)){return 1;}
return sortInput?(indexOf.call(sortInput,a)-indexOf.call(sortInput,b)):0;}
return compare&4?-1:1;}:function(a,b){if(a===b){hasDuplicate=true;return 0;}
var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup){return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?(indexOf.call(sortInput,a)-indexOf.call(sortInput,b)):0;}else if(aup===bup){return siblingCheck(a,b);}
cur=a;while((cur=cur.parentNode)){ap.unshift(cur);}
cur=b;while((cur=cur.parentNode)){bp.unshift(cur);}
while(ap[i]===bp[i]){i++;}
return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0;};return doc;};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements);};Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document){setDocument(elem);}
expr=expr.replace(rattributeQuotes,"='$1']");if(support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret;}}catch(e){}}
return Sizzle(expr,document,null,[elem]).length>0;};Sizzle.contains=function(context,elem){if((context.ownerDocument||context)!==document){setDocument(context);}
return contains(context,elem);};Sizzle.attr=function(elem,name){if((elem.ownerDocument||elem)!==document){setDocument(elem);}
var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val!==undefined?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null;};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg);};Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;sortInput=!support.sortStable&&results.slice(0);results.sort(sortOrder);if(hasDuplicate){while((elem=results[i++])){if(elem===results[i]){j=duplicates.push(i);}}
while(j--){results.splice(duplicates[j],1);}}
sortInput=null;return results;};getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(!nodeType){while((node=elem[i++])){ret+=getText(node);}}else if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent;}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem);}}}else if(nodeType===3||nodeType===4){return elem.nodeValue;}
return ret;};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{"ATTR":function(match){match[1]=match[1].replace(runescape,funescape);match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape);if(match[2]==="~="){match[3]=" "+match[3]+" ";}
return match.slice(0,4);},"CHILD":function(match){match[1]=match[1].toLowerCase();if(match[1].slice(0,3)==="nth"){if(!match[3]){Sizzle.error(match[0]);}
match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));match[5]=+((match[7]+match[8])||match[3]==="odd");}else if(match[3]){Sizzle.error(match[0]);}
return match;},"PSEUDO":function(match){var excess,unquoted=!match[6]&&match[2];if(matchExpr["CHILD"].test(match[0])){return null;}
if(match[3]){match[2]=match[4]||match[5]||"";}else if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,true))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);match[2]=unquoted.slice(0,excess);}
return match.slice(0,3);}},filter:{"TAG":function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return nodeNameSelector==="*"?function(){return true;}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName;};},"CLASS":function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(typeof elem.className==="string"&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"");});},"ATTR":function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);if(result==null){return operator==="!=";}
if(!operator){return true;}
result+="";return operator==="="?result===check:operator==="!="?result!==check:operator==="^="?check&&result.indexOf(check)===0:operator==="*="?check&&result.indexOf(check)>-1:operator==="$="?check&&result.slice(-check.length)===check:operator==="~="?(" "+result+" ").indexOf(check)>-1:operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":false;};},"CHILD":function(type,what,argument,first,last){var simple=type.slice(0,3)!=="nth",forward=type.slice(-4)!=="last",ofType=what==="of-type";return first===1&&last===0?function(elem){return!!elem.parentNode;}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){while(dir){node=elem;while((node=node[dir])){if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){return false;}}
start=dir=type==="only"&&!start&&"nextSibling";}
return true;}
start=[forward?parent.firstChild:parent.lastChild];if(forward&&useCache){outerCache=parent[expando]||(parent[expando]={});cache=outerCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=cache[0]===dirruns&&cache[2];node=nodeIndex&&parent.childNodes[nodeIndex];while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if(node.nodeType===1&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break;}}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns){diff=cache[1];}else{while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){if(useCache){(node[expando]||(node[expando]={}))[type]=[dirruns,diff];}
if(node===elem){break;}}}}
diff-=last;return diff===first||(diff%first===0&&diff/first>=0);}};},"PSEUDO":function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);if(fn[expando]){return fn(argument);}
if(fn.length>1){args=[pseudo,pseudo,"",argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;while(i--){idx=indexOf.call(seed,matched[i]);seed[idx]=!(matches[idx]=matched[i]);}}):function(elem){return fn(elem,0,args);};}
return fn;}},pseudos:{"not":markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;while(i--){if((elem=unmatched[i])){seed[i]=!(matches[i]=elem);}}}):function(elem,context,xml){input[0]=elem;matcher(input,null,xml,results);return!results.pop();};}),"has":markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0;};}),"contains":markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1;};}),"lang":markFunction(function(lang){if(!ridentifier.test(lang||"")){Sizzle.error("unsupported lang: "+lang);}
lang=lang.replace(runescape,funescape).toLowerCase();return function(elem){var elemLang;do{if((elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))){elemLang=elemLang.toLowerCase();return elemLang===lang||elemLang.indexOf(lang+"-")===0;}}while((elem=elem.parentNode)&&elem.nodeType===1);return false;};}),"target":function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id;},"root":function(elem){return elem===docElem;},"focus":function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex);},"enabled":function(elem){return elem.disabled===false;},"disabled":function(elem){return elem.disabled===true;},"checked":function(elem){var nodeName=elem.nodeName.toLowerCase();return(nodeName==="input"&&!!elem.checked)||(nodeName==="option"&&!!elem.selected);},"selected":function(elem){if(elem.parentNode){elem.parentNode.selectedIndex;}
return elem.selected===true;},"empty":function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling){if(elem.nodeType<6){return false;}}
return true;},"parent":function(elem){return!Expr.pseudos["empty"](elem);},"header":function(elem){return rheader.test(elem.nodeName);},"input":function(elem){return rinputs.test(elem.nodeName);},"button":function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type==="button"||name==="button";},"text":function(elem){var attr;return elem.nodeName.toLowerCase()==="input"&&elem.type==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()==="text");},"first":createPositionalPseudo(function(){return[0];}),"last":createPositionalPseudo(function(matchIndexes,length){return[length-1];}),"eq":createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument];}),"even":createPositionalPseudo(function(matchIndexes,length){var i=0;for(;i<length;i+=2){matchIndexes.push(i);}
return matchIndexes;}),"odd":createPositionalPseudo(function(matchIndexes,length){var i=1;for(;i<length;i+=2){matchIndexes.push(i);}
return matchIndexes;}),"lt":createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;--i>=0;){matchIndexes.push(i);}
return matchIndexes;}),"gt":createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;++i<length;){matchIndexes.push(i);}
return matchIndexes;})}};Expr.pseudos["nth"]=Expr.pseudos["eq"];for(i in{radio:true,checkbox:true,file:true,password:true,image:true}){Expr.pseudos[i]=createInputPseudo(i);}
for(i in{submit:true,reset:true}){Expr.pseudos[i]=createButtonPseudo(i);}
function setFilters(){}
setFilters.prototype=Expr.filters=Expr.pseudos;Expr.setFilters=new setFilters();tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached){return parseOnly?0:cached.slice(0);}
soFar=selector;groups=[];preFilters=Expr.preFilter;while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match){soFar=soFar.slice(match[0].length)||soFar;}
groups.push((tokens=[]));}
matched=false;if((match=rcombinators.exec(soFar))){matched=match.shift();tokens.push({value:matched,type:match[0].replace(rtrim," ")});soFar=soFar.slice(matched.length);}
for(type in Expr.filter){if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();tokens.push({value:matched,type:type,matches:match});soFar=soFar.slice(matched.length);}}
if(!matched){break;}}
return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0);};function toSelector(tokens){var i=0,len=tokens.length,selector="";for(;i<len;i++){selector+=tokens[i].value;}
return selector;}
function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&dir==="parentNode",doneName=done++;return combinator.first?function(elem,context,xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){return matcher(elem,context,xml);}}}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){if(matcher(elem,context,xml)){return true;}}}}else{while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){outerCache=elem[expando]||(elem[expando]={});if((oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName){return(newCache[2]=oldCache[2]);}else{outerCache[dir]=newCache;if((newCache[2]=matcher(elem,context,xml))){return true;}}}}}};}
function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;while(i--){if(!matchers[i](elem,context,xml)){return false;}}
return true;}:matchers[0];}
function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;for(;i<len;i++){Sizzle(selector,contexts[i],results);}
return results;}
function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;for(;i<len;i++){if((elem=unmatched[i])){if(!filter||filter(elem,context,xml)){newUnmatched.push(elem);if(mapped){map.push(i);}}}}
return newUnmatched;}
function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){if(postFilter&&!postFilter[expando]){postFilter=setMatcher(postFilter);}
if(postFinder&&!postFinder[expando]){postFinder=setMatcher(postFinder,postSelector);}
return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher){matcher(matcherIn,matcherOut,context,xml);}
if(postFilter){temp=condense(matcherOut,postMap);postFilter(temp,[],context,xml);i=temp.length;while(i--){if((elem=temp[i])){matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem);}}}
if(seed){if(postFinder||preFilter){if(postFinder){temp=[];i=matcherOut.length;while(i--){if((elem=matcherOut[i])){temp.push((matcherIn[i]=elem));}}
postFinder(null,(matcherOut=[]),temp,xml);}
i=matcherOut.length;while(i--){if((elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1){seed[temp]=!(results[temp]=elem);}}}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);if(postFinder){postFinder(null,results,matcherOut,xml);}else{push.apply(results,matcherOut);}}});}
function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext;},implicitRelative,true),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1;},implicitRelative,true),matchers=[function(elem,context,xml){return(!leadingRelative&&(xml||context!==outermostContext))||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));}];for(;i<len;i++){if((matcher=Expr.relative[tokens[i].type])){matchers=[addCombinator(elementMatcher(matchers),matcher)];}else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);if(matcher[expando]){j=++i;for(;j<len;j++){if(Expr.relative[tokens[j].type]){break;}}
return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===" "?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens((tokens=tokens.slice(j))),j<len&&toSelector(tokens));}
matchers.push(matcher);}}
return elementMatcher(matchers);}
function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find["TAG"]("*",outermost),dirrunsUnique=(dirruns+=contextBackup==null?1:Math.random()||0.1),len=elems.length;if(outermost){outermostContext=context!==document&&context;}
for(;i!==len&&(elem=elems[i])!=null;i++){if(byElement&&elem){j=0;while((matcher=elementMatchers[j++])){if(matcher(elem,context,xml)){results.push(elem);break;}}
if(outermost){dirruns=dirrunsUnique;}}
if(bySet){if((elem=!matcher&&elem)){matchedCount--;}
if(seed){unmatched.push(elem);}}}
matchedCount+=i;if(bySet&&i!==matchedCount){j=0;while((matcher=setMatchers[j++])){matcher(unmatched,setMatched,context,xml);}
if(seed){if(matchedCount>0){while(i--){if(!(unmatched[i]||setMatched[i])){setMatched[i]=pop.call(results);}}}
setMatched=condense(setMatched);}
push.apply(results,setMatched);if(outermost&&!seed&&setMatched.length>0&&(matchedCount+setMatchers.length)>1){Sizzle.uniqueSort(results);}}
if(outermost){dirruns=dirrunsUnique;outermostContext=contextBackup;}
return unmatched;};return bySet?markFunction(superMatcher):superMatcher;}
compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){if(!match){match=tokenize(selector);}
i=match.length;while(i--){cached=matcherFromTokens(match[i]);if(cached[expando]){setMatchers.push(cached);}else{elementMatchers.push(cached);}}
cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers));cached.selector=selector;}
return cached;};select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled=typeof selector==="function"&&selector,match=!seed&&tokenize((selector=compiled.selector||selector));results=results||[];if(match.length===1){tokens=match[0]=match[0].slice(0);if(tokens.length>2&&(token=tokens[0]).type==="ID"&&support.getById&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find["ID"](token.matches[0].replace(runescape,funescape),context)||[])[0];if(!context){return results;}else if(compiled){context=context.parentNode;}
selector=selector.slice(tokens.shift().value.length);}
i=matchExpr["needsContext"].test(selector)?0:tokens.length;while(i--){token=tokens[i];if(Expr.relative[(type=token.type)]){break;}
if((find=Expr.find[type])){if((seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){tokens.splice(i,1);selector=seed.length&&toSelector(tokens);if(!selector){push.apply(results,seed);return results;}
break;}}}}
(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context);return results;};support.sortStable=expando.split("").sort(sortOrder).join("")===expando;support.detectDuplicates=!!hasDuplicate;setDocument();support.sortDetached=assert(function(div1){return div1.compareDocumentPosition(document.createElement("div"))&1;});if(!assert(function(div){div.innerHTML="<a href='#'></a>";return div.firstChild.getAttribute("href")==="#";})){addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML){return elem.getAttribute(name,name.toLowerCase()==="type"?1:2);}});}
if(!support.attributes||!assert(function(div){div.innerHTML="<input/>";div.firstChild.setAttribute("value","");return div.firstChild.getAttribute("value")==="";})){addHandle("value",function(elem,name,isXML){if(!isXML&&elem.nodeName.toLowerCase()==="input"){return elem.defaultValue;}});}
if(!assert(function(div){return div.getAttribute("disabled")==null;})){addHandle(booleans,function(elem,name,isXML){var val;if(!isXML){return elem[name]===true?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null;}});}
return Sizzle;})(window);jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.pseudos;jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext;var rsingleTag=(/^<(\w+)\s*\/?>(?:<\/\1>|)$/);var risSimple=/^.[^:#\[\.,]*$/;function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier)){return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not;});}
if(qualifier.nodeType){return jQuery.grep(elements,function(elem){return(elem===qualifier)!==not;});}
if(typeof qualifier==="string"){if(risSimple.test(qualifier)){return jQuery.filter(qualifier,elements,not);}
qualifier=jQuery.filter(qualifier,elements);}
return jQuery.grep(elements,function(elem){return(jQuery.inArray(elem,qualifier)>=0)!==not;});}
jQuery.filter=function(expr,elems,not){var elem=elems[0];if(not){expr=":not("+expr+")";}
return elems.length===1&&elem.nodeType===1?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return elem.nodeType===1;}));};jQuery.fn.extend({find:function(selector){var i,ret=[],self=this,len=self.length;if(typeof selector!=="string"){return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++){if(jQuery.contains(self[i],this)){return true;}}}));}
for(i=0;i<len;i++){jQuery.find(selector,self[i],ret);}
ret=this.pushStack(len>1?jQuery.unique(ret):ret);ret.selector=this.selector?this.selector+" "+selector:selector;return ret;},filter:function(selector){return this.pushStack(winnow(this,selector||[],false));},not:function(selector){return this.pushStack(winnow(this,selector||[],true));},is:function(selector){return!!winnow(this,typeof selector==="string"&&rneedsContext.test(selector)?jQuery(selector):selector||[],false).length;}});var rootjQuery,document=window.document,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context){var match,elem;if(!selector){return this;}
if(typeof selector==="string"){if(selector.charAt(0)==="<"&&selector.charAt(selector.length-1)===">"&&selector.length>=3){match=[null,selector,null];}else{match=rquickExpr.exec(selector);}
if(match&&(match[1]||!context)){if(match[1]){context=context instanceof jQuery?context[0]:context;jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,true));if(rsingleTag.test(match[1])&&jQuery.isPlainObject(context)){for(match in context){if(jQuery.isFunction(this[match])){this[match](context[match]);}else{this.attr(match,context[match]);}}}
return this;}else{elem=document.getElementById(match[2]);if(elem&&elem.parentNode){if(elem.id!==match[2]){return rootjQuery.find(selector);}
this.length=1;this[0]=elem;}
this.context=document;this.selector=selector;return this;}}else if(!context||context.jquery){return(context||rootjQuery).find(selector);}else{return this.constructor(context).find(selector);}}else if(selector.nodeType){this.context=this[0]=selector;this.length=1;return this;}else if(jQuery.isFunction(selector)){return typeof rootjQuery.ready!=="undefined"?rootjQuery.ready(selector):selector(jQuery);}
if(selector.selector!==undefined){this.selector=selector.selector;this.context=selector.context;}
return jQuery.makeArray(selector,this);};init.prototype=jQuery.fn;rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.extend({dir:function(elem,dir,until){var matched=[],cur=elem[dir];while(cur&&cur.nodeType!==9&&(until===undefined||cur.nodeType!==1||!jQuery(cur).is(until))){if(cur.nodeType===1){matched.push(cur);}
cur=cur[dir];}
return matched;},sibling:function(n,elem){var r=[];for(;n;n=n.nextSibling){if(n.nodeType===1&&n!==elem){r.push(n);}}
return r;}});jQuery.fn.extend({has:function(target){var i,targets=jQuery(target,this),len=targets.length;return this.filter(function(){for(i=0;i<len;i++){if(jQuery.contains(this,targets[i])){return true;}}});},closest:function(selectors,context){var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||typeof selectors!=="string"?jQuery(selectors,context||this.context):0;for(;i<l;i++){for(cur=this[i];cur&&cur!==context;cur=cur.parentNode){if(cur.nodeType<11&&(pos?pos.index(cur)>-1:cur.nodeType===1&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break;}}}
return this.pushStack(matched.length>1?jQuery.unique(matched):matched);},index:function(elem){if(!elem){return(this[0]&&this[0].parentNode)?this.first().prevAll().length:-1;}
if(typeof elem==="string"){return jQuery.inArray(this[0],jQuery(elem));}
return jQuery.inArray(elem.jquery?elem[0]:elem,this);},add:function(selector,context){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(selector,context))));},addBack:function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector));}});function sibling(cur,dir){do{cur=cur[dir];}while(cur&&cur.nodeType!==1);return cur;}
jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null;},parents:function(elem){return jQuery.dir(elem,"parentNode");},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until);},next:function(elem){return sibling(elem,"nextSibling");},prev:function(elem){return sibling(elem,"previousSibling");},nextAll:function(elem){return jQuery.dir(elem,"nextSibling");},prevAll:function(elem){return jQuery.dir(elem,"previousSibling");},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until);},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until);},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem);},children:function(elem){return jQuery.sibling(elem.firstChild);},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.merge([],elem.childNodes);}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until);if(name.slice(-5)!=="Until"){selector=until;}
if(selector&&typeof selector==="string"){ret=jQuery.filter(selector,ret);}
if(this.length>1){if(!guaranteedUnique[name]){ret=jQuery.unique(ret);}
if(rparentsprev.test(name)){ret=ret.reverse();}}
return this.pushStack(ret);};});var rnotwhite=(/\S+/g);var optionsCache={};function createOptions(options){var object=optionsCache[options]={};jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=true;});return object;}
jQuery.Callbacks=function(options){options=typeof options==="string"?(optionsCache[options]||createOptions(options)):jQuery.extend({},options);var
firing,memory,fired,firingLength,firingIndex,firingStart,list=[],stack=!options.once&&[],fire=function(data){memory=options.memory&&data;fired=true;firingIndex=firingStart||0;firingStart=0;firingLength=list.length;firing=true;for(;list&&firingIndex<firingLength;firingIndex++){if(list[firingIndex].apply(data[0],data[1])===false&&options.stopOnFalse){memory=false;break;}}
firing=false;if(list){if(stack){if(stack.length){fire(stack.shift());}}else if(memory){list=[];}else{self.disable();}}},self={add:function(){if(list){var start=list.length;(function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);if(type==="function"){if(!options.unique||!self.has(arg)){list.push(arg);}}else if(arg&&arg.length&&type!=="string"){add(arg);}});})(arguments);if(firing){firingLength=list.length;}else if(memory){firingStart=start;fire(memory);}}
return this;},remove:function(){if(list){jQuery.each(arguments,function(_,arg){var index;while((index=jQuery.inArray(arg,list,index))>-1){list.splice(index,1);if(firing){if(index<=firingLength){firingLength--;}
if(index<=firingIndex){firingIndex--;}}}});}
return this;},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!!(list&&list.length);},empty:function(){list=[];firingLength=0;return this;},disable:function(){list=stack=memory=undefined;return this;},disabled:function(){return!list;},lock:function(){stack=undefined;if(!memory){self.disable();}
return this;},locked:function(){return!stack;},fireWith:function(context,args){if(list&&(!fired||stack)){args=args||[];args=[context,args.slice?args.slice():args];if(firing){stack.push(args);}else{fire(args);}}
return this;},fire:function(){self.fireWith(this,arguments);return this;},fired:function(){return!!fired;}};return self;};jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state;},always:function(){deferred.done(arguments).fail(arguments);return this;},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);if(returned&&jQuery.isFunction(returned.promise)){returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify);}else{newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments);}});});fns=null;}).promise();},promise:function(obj){return obj!=null?jQuery.extend(obj,promise):promise;}},deferred={};promise.pipe=promise.then;jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add;if(stateString){list.add(function(){state=stateString;},tuples[i^1][2].disable,tuples[2][2].lock);}
deferred[tuple[0]]=function(){deferred[tuple[0]+"With"](this===deferred?promise:this,arguments);return this;};deferred[tuple[0]+"With"]=list.fireWith;});promise.promise(deferred);if(func){func.call(deferred,deferred);}
return deferred;},when:function(subordinate){var i=0,resolveValues=slice.call(arguments),length=resolveValues.length,remaining=length!==1||(subordinate&&jQuery.isFunction(subordinate.promise))?length:0,deferred=remaining===1?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this;values[i]=arguments.length>1?slice.call(arguments):value;if(values===progressValues){deferred.notifyWith(contexts,values);}else if(!(--remaining)){deferred.resolveWith(contexts,values);}};},progressValues,progressContexts,resolveContexts;if(length>1){progressValues=new Array(length);progressContexts=new Array(length);resolveContexts=new Array(length);for(;i<length;i++){if(resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)){resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues));}else{--remaining;}}}
if(!remaining){deferred.resolveWith(resolveContexts,resolveValues);}
return deferred.promise();}});var readyList;jQuery.fn.ready=function(fn){jQuery.ready.promise().done(fn);return this;};jQuery.extend({isReady:false,readyWait:1,holdReady:function(hold){if(hold){jQuery.readyWait++;}else{jQuery.ready(true);}},ready:function(wait){if(wait===true?--jQuery.readyWait:jQuery.isReady){return;}
if(!document.body){return setTimeout(jQuery.ready);}
jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0){return;}
readyList.resolveWith(document,[jQuery]);if(jQuery.fn.triggerHandler){jQuery(document).triggerHandler("ready");jQuery(document).off("ready");}}});function detach(){if(document.addEventListener){document.removeEventListener("DOMContentLoaded",completed,false);window.removeEventListener("load",completed,false);}else{document.detachEvent("onreadystatechange",completed);window.detachEvent("onload",completed);}}
function completed(){if(document.addEventListener||event.type==="load"||document.readyState==="complete"){detach();jQuery.ready();}}
jQuery.ready.promise=function(obj){if(!readyList){readyList=jQuery.Deferred();if(document.readyState==="complete"){setTimeout(jQuery.ready);}else if(document.addEventListener){document.addEventListener("DOMContentLoaded",completed,false);window.addEventListener("load",completed,false);}else{document.attachEvent("onreadystatechange",completed);window.attachEvent("onload",completed);var top=false;try{top=window.frameElement==null&&document.documentElement;}catch(e){}
if(top&&top.doScroll){(function doScrollCheck(){if(!jQuery.isReady){try{top.doScroll("left");}catch(e){return setTimeout(doScrollCheck,50);}
detach();jQuery.ready();}})();}}}
return readyList.promise(obj);};var strundefined=typeof undefined;var i;for(i in jQuery(support)){break;}
support.ownLast=i!=="0";support.inlineBlockNeedsLayout=false;jQuery(function(){var val,div,body,container;body=document.getElementsByTagName("body")[0];if(!body||!body.style){return;}
div=document.createElement("div");container=document.createElement("div");container.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px";body.appendChild(container).appendChild(div);if(typeof div.style.zoom!==strundefined){div.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1";support.inlineBlockNeedsLayout=val=div.offsetWidth===3;if(val){body.style.zoom=1;}}
body.removeChild(container);});(function(){var div=document.createElement("div");if(support.deleteExpando==null){support.deleteExpando=true;try{delete div.test;}catch(e){support.deleteExpando=false;}}
div=null;})();jQuery.acceptData=function(elem){var noData=jQuery.noData[(elem.nodeName+" ").toLowerCase()],nodeType=+elem.nodeType||1;return nodeType!==1&&nodeType!==9?false:!noData||noData!==true&&elem.getAttribute("classid")===noData;};var rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;function dataAttr(elem,key,data){if(data===undefined&&elem.nodeType===1){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=data==="true"?true:data==="false"?false:data==="null"?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data;}catch(e){}
jQuery.data(elem,key,data);}else{data=undefined;}}
return data;}
function isEmptyDataObject(obj){var name;for(name in obj){if(name==="data"&&jQuery.isEmptyObject(obj[name])){continue;}
if(name!=="toJSON"){return false;}}
return true;}
function internalData(elem,name,data,pvt){if(!jQuery.acceptData(elem)){return;}
var ret,thisCache,internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:elem[internalKey]&&internalKey;if((!id||!cache[id]||(!pvt&&!cache[id].data))&&data===undefined&&typeof name==="string"){return;}
if(!id){if(isNode){id=elem[internalKey]=deletedIds.pop()||jQuery.guid++;}else{id=internalKey;}}
if(!cache[id]){cache[id]=isNode?{}:{toJSON:jQuery.noop};}
if(typeof name==="object"||typeof name==="function"){if(pvt){cache[id]=jQuery.extend(cache[id],name);}else{cache[id].data=jQuery.extend(cache[id].data,name);}}
thisCache=cache[id];if(!pvt){if(!thisCache.data){thisCache.data={};}
thisCache=thisCache.data;}
if(data!==undefined){thisCache[jQuery.camelCase(name)]=data;}
if(typeof name==="string"){ret=thisCache[name];if(ret==null){ret=thisCache[jQuery.camelCase(name)];}}else{ret=thisCache;}
return ret;}
function internalRemoveData(elem,name,pvt){if(!jQuery.acceptData(elem)){return;}
var thisCache,i,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:jQuery.expando;if(!cache[id]){return;}
if(name){thisCache=pvt?cache[id]:cache[id].data;if(thisCache){if(!jQuery.isArray(name)){if(name in thisCache){name=[name];}else{name=jQuery.camelCase(name);if(name in thisCache){name=[name];}else{name=name.split(" ");}}}else{name=name.concat(jQuery.map(name,jQuery.camelCase));}
i=name.length;while(i--){delete thisCache[name[i]];}
if(pvt?!isEmptyDataObject(thisCache):!jQuery.isEmptyObject(thisCache)){return;}}}
if(!pvt){delete cache[id].data;if(!isEmptyDataObject(cache[id])){return;}}
if(isNode){jQuery.cleanData([elem],true);}else if(support.deleteExpando||cache!=cache.window){delete cache[id];}else{cache[id]=null;}}
jQuery.extend({cache:{},noData:{"applet ":true,"embed ":true,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(elem){elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando];return!!elem&&!isEmptyDataObject(elem);},data:function(elem,name,data){return internalData(elem,name,data);},removeData:function(elem,name){return internalRemoveData(elem,name);},_data:function(elem,name,data){return internalData(elem,name,data,true);},_removeData:function(elem,name){return internalRemoveData(elem,name,true);}});jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(key===undefined){if(this.length){data=jQuery.data(elem);if(elem.nodeType===1&&!jQuery._data(elem,"parsedAttrs")){i=attrs.length;while(i--){if(attrs[i]){name=attrs[i].name;if(name.indexOf("data-")===0){name=jQuery.camelCase(name.slice(5));dataAttr(elem,name,data[name]);}}}
jQuery._data(elem,"parsedAttrs",true);}}
return data;}
if(typeof key==="object"){return this.each(function(){jQuery.data(this,key);});}
return arguments.length>1?this.each(function(){jQuery.data(this,key,value);}):elem?dataAttr(elem,key,jQuery.data(elem,key)):undefined;},removeData:function(key){return this.each(function(){jQuery.removeData(this,key);});}});jQuery.extend({queue:function(elem,type,data){var queue;if(elem){type=(type||"fx")+"queue";queue=jQuery._data(elem,type);if(data){if(!queue||jQuery.isArray(data)){queue=jQuery._data(elem,type,jQuery.makeArray(data));}else{queue.push(data);}}
return queue||[];}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type);};if(fn==="inprogress"){fn=queue.shift();startLength--;}
if(fn){if(type==="fx"){queue.unshift("inprogress");}
delete hooks.stop;fn.call(elem,next,hooks);}
if(!startLength&&hooks){hooks.empty.fire();}},_queueHooks:function(elem,type){var key=type+"queueHooks";return jQuery._data(elem,key)||jQuery._data(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){jQuery._removeData(elem,type+"queue");jQuery._removeData(elem,key);})});}});jQuery.fn.extend({queue:function(type,data){var setter=2;if(typeof type!=="string"){data=type;type="fx";setter--;}
if(arguments.length<setter){return jQuery.queue(this[0],type);}
return data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type);if(type==="fx"&&queue[0]!=="inprogress"){jQuery.dequeue(this,type);}});},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type);});},clearQueue:function(type){return this.queue(type||"fx",[]);},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){if(!(--count)){defer.resolveWith(elements,[elements]);}};if(typeof type!=="string"){obj=type;type=undefined;}
type=type||"fx";while(i--){tmp=jQuery._data(elements[i],type+"queueHooks");if(tmp&&tmp.empty){count++;tmp.empty.add(resolve);}}
resolve();return defer.promise(obj);}});var pnum=(/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/).source;var cssExpand=["Top","Right","Bottom","Left"];var isHidden=function(elem,el){elem=el||elem;return jQuery.css(elem,"display")==="none"||!jQuery.contains(elem.ownerDocument,elem);};var access=jQuery.access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,length=elems.length,bulk=key==null;if(jQuery.type(key)==="object"){chainable=true;for(i in key){jQuery.access(elems,fn,i,key[i],true,emptyGet,raw);}}else if(value!==undefined){chainable=true;if(!jQuery.isFunction(value)){raw=true;}
if(bulk){if(raw){fn.call(elems,value);fn=null;}else{bulk=fn;fn=function(elem,key,value){return bulk.call(jQuery(elem),value);};}}
if(fn){for(;i<length;i++){fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));}}}
return chainable?elems:bulk?fn.call(elems):length?fn(elems[0],key):emptyGet;};var rcheckableType=(/^(?:checkbox|radio)$/i);(function(){var input=document.createElement("input"),div=document.createElement("div"),fragment=document.createDocumentFragment();div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";support.leadingWhitespace=div.firstChild.nodeType===3;support.tbody=!div.getElementsByTagName("tbody").length;support.htmlSerialize=!!div.getElementsByTagName("link").length;support.html5Clone=document.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>";input.type="checkbox";input.checked=true;fragment.appendChild(input);support.appendChecked=input.checked;div.innerHTML="<textarea>x</textarea>";support.noCloneChecked=!!div.cloneNode(true).lastChild.defaultValue;fragment.appendChild(div);div.innerHTML="<input type='radio' checked='checked' name='t'/>";support.checkClone=div.cloneNode(true).cloneNode(true).lastChild.checked;support.noCloneEvent=true;if(div.attachEvent){div.attachEvent("onclick",function(){support.noCloneEvent=false;});div.cloneNode(true).click();}
if(support.deleteExpando==null){support.deleteExpando=true;try{delete div.test;}catch(e){support.deleteExpando=false;}}})();(function(){var i,eventName,div=document.createElement("div");for(i in{submit:true,change:true,focusin:true}){eventName="on"+i;if(!(support[i+"Bubbles"]=eventName in window)){div.setAttribute(eventName,"t");support[i+"Bubbles"]=div.attributes[eventName].expando===false;}}
div=null;})();var rformElems=/^(?:input|select|textarea)$/i,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;function returnTrue(){return true;}
function returnFalse(){return false;}
function safeActiveElement(){try{return document.activeElement;}catch(err){}}
jQuery.event={global:{},add:function(elem,types,handler,data,selector){var tmp,events,t,handleObjIn,special,eventHandle,handleObj,handlers,type,namespaces,origType,elemData=jQuery._data(elem);if(!elemData){return;}
if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler;selector=handleObjIn.selector;}
if(!handler.guid){handler.guid=jQuery.guid++;}
if(!(events=elemData.events)){events=elemData.events={};}
if(!(eventHandle=elemData.handle)){eventHandle=elemData.handle=function(e){return typeof jQuery!==strundefined&&(!e||jQuery.event.triggered!==e.type)?jQuery.event.dispatch.apply(eventHandle.elem,arguments):undefined;};eventHandle.elem=elem;}
types=(types||"").match(rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){continue;}
special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;special=jQuery.event.special[type]||{};handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn);if(!(handlers=events[type])){handlers=events[type]=[];handlers.delegateCount=0;if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){if(elem.addEventListener){elem.addEventListener(type,eventHandle,false);}else if(elem.attachEvent){elem.attachEvent("on"+type,eventHandle);}}}
if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid){handleObj.handler.guid=handler.guid;}}
if(selector){handlers.splice(handlers.delegateCount++,0,handleObj);}else{handlers.push(handleObj);}
jQuery.event.global[type]=true;}
elem=null;},remove:function(elem,types,handler,selector,mappedTypes){var j,handleObj,tmp,origCount,t,events,special,handlers,type,namespaces,origType,elemData=jQuery.hasData(elem)&&jQuery._data(elem);if(!elemData||!(events=elemData.events)){return;}
types=(types||"").match(rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){for(type in events){jQuery.event.remove(elem,type+types[t],handler,selector,true);}
continue;}
special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;handlers=events[type]||[];tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)");origCount=j=handlers.length;while(j--){handleObj=handlers[j];if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!tmp||tmp.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){handlers.splice(j,1);if(handleObj.selector){handlers.delegateCount--;}
if(special.remove){special.remove.call(elem,handleObj);}}}
if(origCount&&!handlers.length){if(!special.teardown||special.teardown.call(elem,namespaces,elemData.handle)===false){jQuery.removeEvent(elem,type,elemData.handle);}
delete events[type];}}
if(jQuery.isEmptyObject(events)){delete elemData.handle;jQuery._removeData(elem,"events");}},trigger:function(event,data,elem,onlyHandlers){var handle,ontype,cur,bubbleType,special,tmp,i,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];cur=tmp=elem=elem||document;if(elem.nodeType===3||elem.nodeType===8){return;}
if(rfocusMorph.test(type+jQuery.event.triggered)){return;}
if(type.indexOf(".")>=0){namespaces=type.split(".");type=namespaces.shift();namespaces.sort();}
ontype=type.indexOf(":")<0&&"on"+type;event=event[jQuery.expando]?event:new jQuery.Event(type,typeof event==="object"&&event);event.isTrigger=onlyHandlers?2:3;event.namespace=namespaces.join(".");event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;event.result=undefined;if(!event.target){event.target=elem;}
data=data==null?[event]:jQuery.makeArray(data,[event]);special=jQuery.event.special[type]||{};if(!onlyHandlers&&special.trigger&&special.trigger.apply(elem,data)===false){return;}
if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){bubbleType=special.delegateType||type;if(!rfocusMorph.test(bubbleType+type)){cur=cur.parentNode;}
for(;cur;cur=cur.parentNode){eventPath.push(cur);tmp=cur;}
if(tmp===(elem.ownerDocument||document)){eventPath.push(tmp.defaultView||tmp.parentWindow||window);}}
i=0;while((cur=eventPath[i++])&&!event.isPropagationStopped()){event.type=i>1?bubbleType:special.bindType||type;handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle");if(handle){handle.apply(cur,data);}
handle=ontype&&cur[ontype];if(handle&&handle.apply&&jQuery.acceptData(cur)){event.result=handle.apply(cur,data);if(event.result===false){event.preventDefault();}}}
event.type=type;if(!onlyHandlers&&!event.isDefaultPrevented()){if((!special._default||special._default.apply(eventPath.pop(),data)===false)&&jQuery.acceptData(elem)){if(ontype&&elem[type]&&!jQuery.isWindow(elem)){tmp=elem[ontype];if(tmp){elem[ontype]=null;}
jQuery.event.triggered=type;try{elem[type]();}catch(e){}
jQuery.event.triggered=undefined;if(tmp){elem[ontype]=tmp;}}}}
return event.result;},dispatch:function(event){event=jQuery.event.fix(event);var i,ret,handleObj,matched,j,handlerQueue=[],args=slice.call(arguments),handlers=(jQuery._data(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};args[0]=event;event.delegateTarget=this;if(special.preDispatch&&special.preDispatch.call(this,event)===false){return;}
handlerQueue=jQuery.event.handlers.call(this,event,handlers);i=0;while((matched=handlerQueue[i++])&&!event.isPropagationStopped()){event.currentTarget=matched.elem;j=0;while((handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped()){if(!event.namespace_re||event.namespace_re.test(handleObj.namespace)){event.handleObj=handleObj;event.data=handleObj.data;ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args);if(ret!==undefined){if((event.result=ret)===false){event.preventDefault();event.stopPropagation();}}}}}
if(special.postDispatch){special.postDispatch.call(this,event);}
return event.result;},handlers:function(event,handlers){var sel,handleObj,matches,i,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||event.type!=="click")){for(;cur!=this;cur=cur.parentNode||this){if(cur.nodeType===1&&(cur.disabled!==true||event.type!=="click")){matches=[];for(i=0;i<delegateCount;i++){handleObj=handlers[i];sel=handleObj.selector+" ";if(matches[sel]===undefined){matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length;}
if(matches[sel]){matches.push(handleObj);}}
if(matches.length){handlerQueue.push({elem:cur,handlers:matches});}}}}
if(delegateCount<handlers.length){handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)});}
return handlerQueue;},fix:function(event){if(event[jQuery.expando]){return event;}
var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];if(!fixHook){this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{};}
copy=fixHook.props?this.props.concat(fixHook.props):this.props;event=new jQuery.Event(originalEvent);i=copy.length;while(i--){prop=copy[i];event[prop]=originalEvent[prop];}
if(!event.target){event.target=originalEvent.srcElement||document;}
if(event.target.nodeType===3){event.target=event.target.parentNode;}
event.metaKey=!!event.metaKey;return fixHook.filter?fixHook.filter(event,originalEvent):event;},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){if(event.which==null){event.which=original.charCode!=null?original.charCode:original.keyCode;}
return event;}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var body,eventDoc,doc,button=original.button,fromElement=original.fromElement;if(event.pageX==null&&original.clientX!=null){eventDoc=event.target.ownerDocument||document;doc=eventDoc.documentElement;body=eventDoc.body;event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0);}
if(!event.relatedTarget&&fromElement){event.relatedTarget=fromElement===event.target?original.toElement:fromElement;}
if(!event.which&&button!==undefined){event.which=(button&1?1:(button&2?3:(button&4?2:0)));}
return event;}},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus){try{this.focus();return false;}catch(e){}}},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur){this.blur();return false;}},delegateType:"focusout"},click:{trigger:function(){if(jQuery.nodeName(this,"input")&&this.type==="checkbox"&&this.click){this.click();return false;}},_default:function(event){return jQuery.nodeName(event.target,"a");}},beforeunload:{postDispatch:function(event){if(event.result!==undefined&&event.originalEvent){event.originalEvent.returnValue=event.result;}}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event(),event,{type:type,isSimulated:true,originalEvent:{}});if(bubble){jQuery.event.trigger(e,null,elem);}else{jQuery.event.dispatch.call(elem,e);}
if(e.isDefaultPrevented()){event.preventDefault();}}};jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){if(elem.removeEventListener){elem.removeEventListener(type,handle,false);}}:function(elem,type,handle){var name="on"+type;if(elem.detachEvent){if(typeof elem[name]===strundefined){elem[name]=null;}
elem.detachEvent(name,handle);}};jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event)){return new jQuery.Event(src,props);}
if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=src.defaultPrevented||src.defaultPrevented===undefined&&src.returnValue===false?returnTrue:returnFalse;}else{this.type=src;}
if(props){jQuery.extend(this,props);}
this.timeStamp=src&&src.timeStamp||jQuery.now();this[jQuery.expando]=true;};jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue;if(!e){return;}
if(e.preventDefault){e.preventDefault();}else{e.returnValue=false;}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue;if(!e){return;}
if(e.stopPropagation){e.stopPropagation();}
e.cancelBubble=true;},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue;if(e&&e.stopImmediatePropagation){e.stopImmediatePropagation();}
this.stopPropagation();}};jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;if(!related||(related!==target&&!jQuery.contains(target,related))){event.type=handleObj.origType;ret=handleObj.handler.apply(this,arguments);event.type=fix;}
return ret;}};});if(!support.submitBubbles){jQuery.event.special.submit={setup:function(){if(jQuery.nodeName(this,"form")){return false;}
jQuery.event.add(this,"click._submit keypress._submit",function(e){var elem=e.target,form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:undefined;if(form&&!jQuery._data(form,"submitBubbles")){jQuery.event.add(form,"submit._submit",function(event){event._submit_bubble=true;});jQuery._data(form,"submitBubbles",true);}});},postDispatch:function(event){if(event._submit_bubble){delete event._submit_bubble;if(this.parentNode&&!event.isTrigger){jQuery.event.simulate("submit",this.parentNode,event,true);}}},teardown:function(){if(jQuery.nodeName(this,"form")){return false;}
jQuery.event.remove(this,"._submit");}};}
if(!support.changeBubbles){jQuery.event.special.change={setup:function(){if(rformElems.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){jQuery.event.add(this,"propertychange._change",function(event){if(event.originalEvent.propertyName==="checked"){this._just_changed=true;}});jQuery.event.add(this,"click._change",function(event){if(this._just_changed&&!event.isTrigger){this._just_changed=false;}
jQuery.event.simulate("change",this,event,true);});}
return false;}
jQuery.event.add(this,"beforeactivate._change",function(e){var elem=e.target;if(rformElems.test(elem.nodeName)&&!jQuery._data(elem,"changeBubbles")){jQuery.event.add(elem,"change._change",function(event){if(this.parentNode&&!event.isSimulated&&!event.isTrigger){jQuery.event.simulate("change",this.parentNode,event,true);}});jQuery._data(elem,"changeBubbles",true);}});},handle:function(event){var elem=event.target;if(this!==elem||event.isSimulated||event.isTrigger||(elem.type!=="radio"&&elem.type!=="checkbox")){return event.handleObj.handler.apply(this,arguments);}},teardown:function(){jQuery.event.remove(this,"._change");return!rformElems.test(this.nodeName);}};}
if(!support.focusinBubbles){jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),true);};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=jQuery._data(doc,fix);if(!attaches){doc.addEventListener(orig,handler,true);}
jQuery._data(doc,fix,(attaches||0)+1);},teardown:function(){var doc=this.ownerDocument||this,attaches=jQuery._data(doc,fix)-1;if(!attaches){doc.removeEventListener(orig,handler,true);jQuery._removeData(doc,fix);}else{jQuery._data(doc,fix,attaches);}}};});}
jQuery.fn.extend({on:function(types,selector,data,fn,one){var type,origFn;if(typeof types==="object"){if(typeof selector!=="string"){data=data||selector;selector=undefined;}
for(type in types){this.on(type,selector,data,types[type],one);}
return this;}
if(data==null&&fn==null){fn=selector;data=selector=undefined;}else if(fn==null){if(typeof selector==="string"){fn=data;data=undefined;}else{fn=data;data=selector;selector=undefined;}}
if(fn===false){fn=returnFalse;}else if(!fn){return this;}
if(one===1){origFn=fn;fn=function(event){jQuery().off(event);return origFn.apply(this,arguments);};fn.guid=origFn.guid||(origFn.guid=jQuery.guid++);}
return this.each(function(){jQuery.event.add(this,types,fn,data,selector);});},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1);},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj){handleObj=types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler);return this;}
if(typeof types==="object"){for(type in types){this.off(type,selector,types[type]);}
return this;}
if(selector===false||typeof selector==="function"){fn=selector;selector=undefined;}
if(fn===false){fn=returnFalse;}
return this.each(function(){jQuery.event.remove(this,types,fn,selector);});},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this);});},triggerHandler:function(type,data){var elem=this[0];if(elem){return jQuery.event.trigger(type,data,elem,true);}}});function createSafeFragment(document){var list=nodeNames.split("|"),safeFrag=document.createDocumentFragment();if(safeFrag.createElement){while(list.length){safeFrag.createElement(list.pop());}}
return safeFrag;}
var nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|"+"header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},safeFragment=createSafeFragment(document),fragmentDiv=safeFragment.appendChild(document.createElement("div"));wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;function getAll(context,tag){var elems,elem,i=0,found=typeof context.getElementsByTagName!==strundefined?context.getElementsByTagName(tag||"*"):typeof context.querySelectorAll!==strundefined?context.querySelectorAll(tag||"*"):undefined;if(!found){for(found=[],elems=context.childNodes||context;(elem=elems[i])!=null;i++){if(!tag||jQuery.nodeName(elem,tag)){found.push(elem);}else{jQuery.merge(found,getAll(elem,tag));}}}
return tag===undefined||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],found):found;}
function fixDefaultChecked(elem){if(rcheckableType.test(elem.type)){elem.defaultChecked=elem.checked;}}
function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(content.nodeType!==11?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem;}
function disableScript(elem){elem.type=(jQuery.find.attr(elem,"type")!==null)+"/"+elem.type;return elem;}
function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);if(match){elem.type=match[1];}else{elem.removeAttribute("type");}
return elem;}
function setGlobalEval(elems,refElements){var elem,i=0;for(;(elem=elems[i])!=null;i++){jQuery._data(elem,"globalEval",!refElements||jQuery._data(refElements[i],"globalEval"));}}
function cloneCopyEvent(src,dest){if(dest.nodeType!==1||!jQuery.hasData(src)){return;}
var type,i,l,oldData=jQuery._data(src),curData=jQuery._data(dest,oldData),events=oldData.events;if(events){delete curData.handle;curData.events={};for(type in events){for(i=0,l=events[type].length;i<l;i++){jQuery.event.add(dest,type,events[type][i]);}}}
if(curData.data){curData.data=jQuery.extend({},curData.data);}}
function fixCloneNodeIssues(src,dest){var nodeName,e,data;if(dest.nodeType!==1){return;}
nodeName=dest.nodeName.toLowerCase();if(!support.noCloneEvent&&dest[jQuery.expando]){data=jQuery._data(dest);for(e in data.events){jQuery.removeEvent(dest,e,data.handle);}
dest.removeAttribute(jQuery.expando);}
if(nodeName==="script"&&dest.text!==src.text){disableScript(dest).text=src.text;restoreScript(dest);}else if(nodeName==="object"){if(dest.parentNode){dest.outerHTML=src.outerHTML;}
if(support.html5Clone&&(src.innerHTML&&!jQuery.trim(dest.innerHTML))){dest.innerHTML=src.innerHTML;}}else if(nodeName==="input"&&rcheckableType.test(src.type)){dest.defaultChecked=dest.checked=src.checked;if(dest.value!==src.value){dest.value=src.value;}}else if(nodeName==="option"){dest.defaultSelected=dest.selected=src.defaultSelected;}else if(nodeName==="input"||nodeName==="textarea"){dest.defaultValue=src.defaultValue;}}
jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var destElements,node,clone,i,srcElements,inPage=jQuery.contains(elem.ownerDocument,elem);if(support.html5Clone||jQuery.isXMLDoc(elem)||!rnoshimcache.test("<"+elem.nodeName+">")){clone=elem.cloneNode(true);}else{fragmentDiv.innerHTML=elem.outerHTML;fragmentDiv.removeChild(clone=fragmentDiv.firstChild);}
if((!support.noCloneEvent||!support.noCloneChecked)&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){destElements=getAll(clone);srcElements=getAll(elem);for(i=0;(node=srcElements[i])!=null;++i){if(destElements[i]){fixCloneNodeIssues(node,destElements[i]);}}}
if(dataAndEvents){if(deepDataAndEvents){srcElements=srcElements||getAll(elem);destElements=destElements||getAll(clone);for(i=0;(node=srcElements[i])!=null;i++){cloneCopyEvent(node,destElements[i]);}}else{cloneCopyEvent(elem,clone);}}
destElements=getAll(clone,"script");if(destElements.length>0){setGlobalEval(destElements,!inPage&&getAll(elem,"script"));}
destElements=srcElements=node=null;return clone;},buildFragment:function(elems,context,scripts,selection){var j,elem,contains,tmp,tag,tbody,wrap,l=elems.length,safe=createSafeFragment(context),nodes=[],i=0;for(;i<l;i++){elem=elems[i];if(elem||elem===0){if(jQuery.type(elem)==="object"){jQuery.merge(nodes,elem.nodeType?[elem]:elem);}else if(!rhtml.test(elem)){nodes.push(context.createTextNode(elem));}else{tmp=tmp||safe.appendChild(context.createElement("div"));tag=(rtagName.exec(elem)||["",""])[1].toLowerCase();wrap=wrapMap[tag]||wrapMap._default;tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2];j=wrap[0];while(j--){tmp=tmp.lastChild;}
if(!support.leadingWhitespace&&rleadingWhitespace.test(elem)){nodes.push(context.createTextNode(rleadingWhitespace.exec(elem)[0]));}
if(!support.tbody){elem=tag==="table"&&!rtbody.test(elem)?tmp.firstChild:wrap[1]==="<table>"&&!rtbody.test(elem)?tmp:0;j=elem&&elem.childNodes.length;while(j--){if(jQuery.nodeName((tbody=elem.childNodes[j]),"tbody")&&!tbody.childNodes.length){elem.removeChild(tbody);}}}
jQuery.merge(nodes,tmp.childNodes);tmp.textContent="";while(tmp.firstChild){tmp.removeChild(tmp.firstChild);}
tmp=safe.lastChild;}}}
if(tmp){safe.removeChild(tmp);}
if(!support.appendChecked){jQuery.grep(getAll(nodes,"input"),fixDefaultChecked);}
i=0;while((elem=nodes[i++])){if(selection&&jQuery.inArray(elem,selection)!==-1){continue;}
contains=jQuery.contains(elem.ownerDocument,elem);tmp=getAll(safe.appendChild(elem),"script");if(contains){setGlobalEval(tmp);}
if(scripts){j=0;while((elem=tmp[j++])){if(rscriptType.test(elem.type||"")){scripts.push(elem);}}}}
tmp=null;return safe;},cleanData:function(elems,acceptData){var elem,type,id,data,i=0,internalKey=jQuery.expando,cache=jQuery.cache,deleteExpando=support.deleteExpando,special=jQuery.event.special;for(;(elem=elems[i])!=null;i++){if(acceptData||jQuery.acceptData(elem)){id=elem[internalKey];data=id&&cache[id];if(data){if(data.events){for(type in data.events){if(special[type]){jQuery.event.remove(elem,type);}else{jQuery.removeEvent(elem,type,data.handle);}}}
if(cache[id]){delete cache[id];if(deleteExpando){delete elem[internalKey];}else if(typeof elem.removeAttribute!==strundefined){elem.removeAttribute(internalKey);}else{elem[internalKey]=null;}
deletedIds.push(id);}}}}}});jQuery.fn.extend({text:function(value){return access(this,function(value){return value===undefined?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value));},null,value,arguments.length);},append:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.appendChild(elem);}});},prepend:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild);}});},before:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this);}});},after:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this.nextSibling);}});},remove:function(selector,keepData){var elem,elems=selector?jQuery.filter(selector,this):this,i=0;for(;(elem=elems[i])!=null;i++){if(!keepData&&elem.nodeType===1){jQuery.cleanData(getAll(elem));}
if(elem.parentNode){if(keepData&&jQuery.contains(elem.ownerDocument,elem)){setGlobalEval(getAll(elem,"script"));}
elem.parentNode.removeChild(elem);}}
return this;},empty:function(){var elem,i=0;for(;(elem=this[i])!=null;i++){if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));}
while(elem.firstChild){elem.removeChild(elem.firstChild);}
if(elem.options&&jQuery.nodeName(elem,"select")){elem.options.length=0;}}
return this;},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents);});},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined){return elem.nodeType===1?elem.innerHTML.replace(rinlinejQuery,""):undefined;}
if(typeof value==="string"&&!rnoInnerhtml.test(value)&&(support.htmlSerialize||!rnoshimcache.test(value))&&(support.leadingWhitespace||!rleadingWhitespace.test(value))&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;i<l;i++){elem=this[i]||{};if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.innerHTML=value;}}
elem=0;}catch(e){}}
if(elem){this.empty().append(value);}},null,value,arguments.length);},replaceWith:function(){var arg=arguments[0];this.domManip(arguments,function(elem){arg=this.parentNode;jQuery.cleanData(getAll(this));if(arg){arg.replaceChild(elem,this);}});return arg&&(arg.length||arg.nodeType)?this:this.remove();},detach:function(selector){return this.remove(selector,true);},domManip:function(args,callback){args=concat.apply([],args);var first,node,hasScripts,scripts,doc,fragment,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||(l>1&&typeof value==="string"&&!support.checkClone&&rchecked.test(value))){return this.each(function(index){var self=set.eq(index);if(isFunction){args[0]=value.call(this,index,self.html());}
self.domManip(args,callback);});}
if(l){fragment=jQuery.buildFragment(args,this[0].ownerDocument,false,this);first=fragment.firstChild;if(fragment.childNodes.length===1){fragment=first;}
if(first){scripts=jQuery.map(getAll(fragment,"script"),disableScript);hasScripts=scripts.length;for(;i<l;i++){node=fragment;if(i!==iNoClone){node=jQuery.clone(node,true,true);if(hasScripts){jQuery.merge(scripts,getAll(node,"script"));}}
callback.call(this[i],node,i);}
if(hasScripts){doc=scripts[scripts.length-1].ownerDocument;jQuery.map(scripts,restoreScript);for(i=0;i<hasScripts;i++){node=scripts[i];if(rscriptType.test(node.type||"")&&!jQuery._data(node,"globalEval")&&jQuery.contains(doc,node)){if(node.src){if(jQuery._evalUrl){jQuery._evalUrl(node.src);}}else{jQuery.globalEval((node.text||node.textContent||node.innerHTML||"").replace(rcleanScript,""));}}}}
fragment=first=null;}}
return this;}});jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var elems,i=0,ret=[],insert=jQuery(selector),last=insert.length-1;for(;i<=last;i++){elems=i===last?this:this.clone(true);jQuery(insert[i])[original](elems);push.apply(ret,elems.get());}
return this.pushStack(ret);};});var iframe,elemdisplay={};function actualDisplay(name,doc){var style,elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=window.getDefaultComputedStyle&&(style=window.getDefaultComputedStyle(elem[0]))?style.display:jQuery.css(elem[0],"display");elem.detach();return display;}
function defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];if(!display){display=actualDisplay(nodeName,doc);if(display==="none"||!display){iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement);doc=(iframe[0].contentWindow||iframe[0].contentDocument).document;doc.write();doc.close();display=actualDisplay(nodeName,doc);iframe.detach();}
elemdisplay[nodeName]=display;}
return display;}
(function(){var shrinkWrapBlocksVal;support.shrinkWrapBlocks=function(){if(shrinkWrapBlocksVal!=null){return shrinkWrapBlocksVal;}
shrinkWrapBlocksVal=false;var div,body,container;body=document.getElementsByTagName("body")[0];if(!body||!body.style){return;}
div=document.createElement("div");container=document.createElement("div");container.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px";body.appendChild(container).appendChild(div);if(typeof div.style.zoom!==strundefined){div.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;"+"box-sizing:content-box;display:block;margin:0;border:0;"+"padding:1px;width:1px;zoom:1";div.appendChild(document.createElement("div")).style.width="5px";shrinkWrapBlocksVal=div.offsetWidth!==3;}
body.removeChild(container);return shrinkWrapBlocksVal;};})();var rmargin=(/^margin/);var rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i");var getStyles,curCSS,rposition=/^(top|right|bottom|left)$/;if(window.getComputedStyle){getStyles=function(elem){return elem.ownerDocument.defaultView.getComputedStyle(elem,null);};curCSS=function(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;computed=computed||getStyles(elem);ret=computed?computed.getPropertyValue(name)||computed[name]:undefined;if(computed){if(ret===""&&!jQuery.contains(elem.ownerDocument,elem)){ret=jQuery.style(elem,name);}
if(rnumnonpx.test(ret)&&rmargin.test(name)){width=style.width;minWidth=style.minWidth;maxWidth=style.maxWidth;style.minWidth=style.maxWidth=style.width=ret;ret=computed.width;style.width=width;style.minWidth=minWidth;style.maxWidth=maxWidth;}}
return ret===undefined?ret:ret+"";};}else if(document.documentElement.currentStyle){getStyles=function(elem){return elem.currentStyle;};curCSS=function(elem,name,computed){var left,rs,rsLeft,ret,style=elem.style;computed=computed||getStyles(elem);ret=computed?computed[name]:undefined;if(ret==null&&style&&style[name]){ret=style[name];}
if(rnumnonpx.test(ret)&&!rposition.test(name)){left=style.left;rs=elem.runtimeStyle;rsLeft=rs&&rs.left;if(rsLeft){rs.left=elem.currentStyle.left;}
style.left=name==="fontSize"?"1em":ret;ret=style.pixelLeft+"px";style.left=left;if(rsLeft){rs.left=rsLeft;}}
return ret===undefined?ret:ret+""||"auto";};}
function addGetHookIf(conditionFn,hookFn){return{get:function(){var condition=conditionFn();if(condition==null){return;}
if(condition){delete this.get;return;}
return(this.get=hookFn).apply(this,arguments);}};}
(function(){var div,style,a,pixelPositionVal,boxSizingReliableVal,reliableHiddenOffsetsVal,reliableMarginRightVal;div=document.createElement("div");div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";a=div.getElementsByTagName("a")[0];style=a&&a.style;if(!style){return;}
style.cssText="float:left;opacity:.5";support.opacity=style.opacity==="0.5";support.cssFloat=!!style.cssFloat;div.style.backgroundClip="content-box";div.cloneNode(true).style.backgroundClip="";support.clearCloneStyle=div.style.backgroundClip==="content-box";support.boxSizing=style.boxSizing===""||style.MozBoxSizing===""||style.WebkitBoxSizing==="";jQuery.extend(support,{reliableHiddenOffsets:function(){if(reliableHiddenOffsetsVal==null){computeStyleTests();}
return reliableHiddenOffsetsVal;},boxSizingReliable:function(){if(boxSizingReliableVal==null){computeStyleTests();}
return boxSizingReliableVal;},pixelPosition:function(){if(pixelPositionVal==null){computeStyleTests();}
return pixelPositionVal;},reliableMarginRight:function(){if(reliableMarginRightVal==null){computeStyleTests();}
return reliableMarginRightVal;}});function computeStyleTests(){var div,body,container,contents;body=document.getElementsByTagName("body")[0];if(!body||!body.style){return;}
div=document.createElement("div");container=document.createElement("div");container.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px";body.appendChild(container).appendChild(div);div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;"+"box-sizing:border-box;display:block;margin-top:1%;top:1%;"+"border:1px;padding:1px;width:4px;position:absolute";pixelPositionVal=boxSizingReliableVal=false;reliableMarginRightVal=true;if(window.getComputedStyle){pixelPositionVal=(window.getComputedStyle(div,null)||{}).top!=="1%";boxSizingReliableVal=(window.getComputedStyle(div,null)||{width:"4px"}).width==="4px";contents=div.appendChild(document.createElement("div"));contents.style.cssText=div.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;"+"box-sizing:content-box;display:block;margin:0;border:0;padding:0";contents.style.marginRight=contents.style.width="0";div.style.width="1px";reliableMarginRightVal=!parseFloat((window.getComputedStyle(contents,null)||{}).marginRight);}
div.innerHTML="<table><tr><td></td><td>t</td></tr></table>";contents=div.getElementsByTagName("td");contents[0].style.cssText="margin:0;border:0;padding:0;display:none";reliableHiddenOffsetsVal=contents[0].offsetHeight===0;if(reliableHiddenOffsetsVal){contents[0].style.display="";contents[1].style.display="none";reliableHiddenOffsetsVal=contents[0].offsetHeight===0;}
body.removeChild(container);}})();jQuery.swap=function(elem,options,callback,args){var ret,name,old={};for(name in options){old[name]=elem.style[name];elem.style[name]=options[name];}
ret=callback.apply(elem,args||[]);for(name in options){elem.style[name]=old[name];}
return ret;};var
ralpha=/alpha\([^)]*\)/i,ropacity=/opacity\s*=\s*([^)]*)/,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),rrelNum=new RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","O","Moz","ms"];function vendorPropName(style,name){if(name in style){return name;}
var capName=name.charAt(0).toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;while(i--){name=cssPrefixes[i]+capName;if(name in style){return name;}}
return origName;}
function showHide(elements,show){var display,elem,hidden,values=[],index=0,length=elements.length;for(;index<length;index++){elem=elements[index];if(!elem.style){continue;}
values[index]=jQuery._data(elem,"olddisplay");display=elem.style.display;if(show){if(!values[index]&&display==="none"){elem.style.display="";}
if(elem.style.display===""&&isHidden(elem)){values[index]=jQuery._data(elem,"olddisplay",defaultDisplay(elem.nodeName));}}else{hidden=isHidden(elem);if(display&&display!=="none"||!hidden){jQuery._data(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"));}}}
for(index=0;index<length;index++){elem=elements[index];if(!elem.style){continue;}
if(!show||elem.style.display==="none"||elem.style.display===""){elem.style.display=show?values[index]||"":"none";}}
return elements;}
function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value;}
function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){var i=extra===(isBorderBox?"border":"content")?4:name==="width"?1:0,val=0;for(;i<4;i+=2){if(extra==="margin"){val+=jQuery.css(elem,extra+cssExpand[i],true,styles);}
if(isBorderBox){if(extra==="content"){val-=jQuery.css(elem,"padding"+cssExpand[i],true,styles);}
if(extra!=="margin"){val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles);}}else{val+=jQuery.css(elem,"padding"+cssExpand[i],true,styles);if(extra!=="padding"){val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles);}}}
return val;}
function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=true,val=name==="width"?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=support.boxSizing&&jQuery.css(elem,"boxSizing",false,styles)==="border-box";if(val<=0||val==null){val=curCSS(elem,name,styles);if(val<0||val==null){val=elem.style[name];}
if(rnumnonpx.test(val)){return val;}
valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]);val=parseFloat(val)||0;}
return(val+
augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles))+"px";}
jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return ret===""?"1":ret;}}}},cssNumber:{"columnCount":true,"fillOpacity":true,"flexGrow":true,"flexShrink":true,"fontWeight":true,"lineHeight":true,"opacity":true,"order":true,"orphans":true,"widows":true,"zIndex":true,"zoom":true},cssProps:{"float":support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){return;}
var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(value!==undefined){type=typeof value;if(type==="string"&&(ret=rrelNum.exec(value))){value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name));type="number";}
if(value==null||value!==value){return;}
if(type==="number"&&!jQuery.cssNumber[origName]){value+="px";}
if(!support.clearCloneStyle&&value===""&&name.indexOf("background")===0){style[name]="inherit";}
if(!hooks||!("set"in hooks)||(value=hooks.set(elem,value,extra))!==undefined){try{style[name]=value;}catch(e){}}}else{if(hooks&&"get"in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){return ret;}
return style[name];}},css:function(elem,name,extra,styles){var num,val,hooks,origName=jQuery.camelCase(name);name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(hooks&&"get"in hooks){val=hooks.get(elem,true,extra);}
if(val===undefined){val=curCSS(elem,name,styles);}
if(val==="normal"&&name in cssNormalTransform){val=cssNormalTransform[name];}
if(extra===""||extra){num=parseFloat(val);return extra===true||jQuery.isNumeric(num)?num||0:val;}
return val;}});jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){if(computed){return rdisplayswap.test(jQuery.css(elem,"display"))&&elem.offsetWidth===0?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra);}):getWidthOrHeight(elem,name,extra);}},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,support.boxSizing&&jQuery.css(elem,"boxSizing",false,styles)==="border-box",styles):0);}};});if(!support.opacity){jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?(0.01*parseFloat(RegExp.$1))+"":computed?"1":"";},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNumeric(value)?"alpha(opacity="+value*100+")":"",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=1;if((value>=1||value==="")&&jQuery.trim(filter.replace(ralpha,""))===""&&style.removeAttribute){style.removeAttribute("filter");if(value===""||currentStyle&&!currentStyle.filter){return;}}
style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity;}};}
jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){if(computed){return jQuery.swap(elem,{"display":"inline-block"},curCSS,[elem,"marginRight"]);}});jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){var i=0,expanded={},parts=typeof value==="string"?value.split(" "):[value];for(;i<4;i++){expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];}
return expanded;}};if(!rmargin.test(prefix)){jQuery.cssHooks[prefix+suffix].set=setPositiveNumber;}});jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){styles=getStyles(elem);len=name.length;for(;i<len;i++){map[name[i]]=jQuery.css(elem,name[i],false,styles);}
return map;}
return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name);},name,value,arguments.length>1);},show:function(){return showHide(this,true);},hide:function(){return showHide(this);},toggle:function(state){if(typeof state==="boolean"){return state?this.show():this.hide();}
return this.each(function(){if(isHidden(this)){jQuery(this).show();}else{jQuery(this).hide();}});}});function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing);}
jQuery.Tween=Tween;Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem;this.prop=prop;this.easing=easing||"swing";this.options=options;this.start=this.now=this.cur();this.end=end;this.unit=unit||(jQuery.cssNumber[prop]?"":"px");},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this);},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];if(this.options.duration){this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration);}else{this.pos=eased=percent;}
this.now=(this.end-this.start)*eased+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this);}
if(hooks&&hooks.set){hooks.set(this);}else{Tween.propHooks._default.set(this);}
return this;}};Tween.prototype.init.prototype=Tween.prototype;Tween.propHooks={_default:{get:function(tween){var result;if(tween.elem[tween.prop]!=null&&(!tween.elem.style||tween.elem.style[tween.prop]==null)){return tween.elem[tween.prop];}
result=jQuery.css(tween.elem,tween.prop,"");return!result||result==="auto"?0:result;},set:function(tween){if(jQuery.fx.step[tween.prop]){jQuery.fx.step[tween.prop](tween);}else if(tween.elem.style&&(tween.elem.style[jQuery.cssProps[tween.prop]]!=null||jQuery.cssHooks[tween.prop])){jQuery.style(tween.elem,tween.prop,tween.now+tween.unit);}else{tween.elem[tween.prop]=tween.now;}}}};Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){if(tween.elem.nodeType&&tween.elem.parentNode){tween.elem[tween.prop]=tween.now;}}};jQuery.easing={linear:function(p){return p;},swing:function(p){return 0.5-Math.cos(p*Math.PI)/2;}};jQuery.fx=Tween.prototype.init;jQuery.fx.step={};var
fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||unit!=="px"&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3];parts=parts||[];start=+target||1;do{scale=scale||".5";start=start/scale;jQuery.style(tween.elem,prop,start+unit);}while(scale!==(scale=tween.cur()/target)&&scale!==1&&--maxIterations);}
if(parts){start=tween.start=+start||+target||0;tween.unit=unit;tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2];}
return tween;}]};function createFxNow(){setTimeout(function(){fxNow=undefined;});return(fxNow=jQuery.now());}
function genFx(type,includeWidth){var which,attrs={height:type},i=0;includeWidth=includeWidth?1:0;for(;i<4;i+=2-includeWidth){which=cssExpand[i];attrs["margin"+which]=attrs["padding"+which]=type;}
if(includeWidth){attrs.opacity=attrs.width=type;}
return attrs;}
function createTween(value,prop,animation){var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;for(;index<length;index++){if((tween=collection[index].call(animation,prop,value))){return tween;}}}
function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,checkDisplay,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=jQuery._data(elem,"fxshow");if(!opts.queue){hooks=jQuery._queueHooks(elem,"fx");if(hooks.unqueued==null){hooks.unqueued=0;oldfire=hooks.empty.fire;hooks.empty.fire=function(){if(!hooks.unqueued){oldfire();}};}
hooks.unqueued++;anim.always(function(){anim.always(function(){hooks.unqueued--;if(!jQuery.queue(elem,"fx").length){hooks.empty.fire();}});});}
if(elem.nodeType===1&&("height"in props||"width"in props)){opts.overflow=[style.overflow,style.overflowX,style.overflowY];display=jQuery.css(elem,"display");checkDisplay=display==="none"?jQuery._data(elem,"olddisplay")||defaultDisplay(elem.nodeName):display;if(checkDisplay==="inline"&&jQuery.css(elem,"float")==="none"){if(!support.inlineBlockNeedsLayout||defaultDisplay(elem.nodeName)==="inline"){style.display="inline-block";}else{style.zoom=1;}}}
if(opts.overflow){style.overflow="hidden";if(!support.shrinkWrapBlocks()){anim.always(function(){style.overflow=opts.overflow[0];style.overflowX=opts.overflow[1];style.overflowY=opts.overflow[2];});}}
for(prop in props){value=props[prop];if(rfxtypes.exec(value)){delete props[prop];toggle=toggle||value==="toggle";if(value===(hidden?"hide":"show")){if(value==="show"&&dataShow&&dataShow[prop]!==undefined){hidden=true;}else{continue;}}
orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop);}else{display=undefined;}}
if(!jQuery.isEmptyObject(orig)){if(dataShow){if("hidden"in dataShow){hidden=dataShow.hidden;}}else{dataShow=jQuery._data(elem,"fxshow",{});}
if(toggle){dataShow.hidden=!hidden;}
if(hidden){jQuery(elem).show();}else{anim.done(function(){jQuery(elem).hide();});}
anim.done(function(){var prop;jQuery._removeData(elem,"fxshow");for(prop in orig){jQuery.style(elem,prop,orig[prop]);}});for(prop in orig){tween=createTween(hidden?dataShow[prop]:0,prop,anim);if(!(prop in dataShow)){dataShow[prop]=tween.start;if(hidden){tween.end=tween.start;tween.start=prop==="width"||prop==="height"?1:0;}}}}else if((display==="none"?defaultDisplay(elem.nodeName):display)==="inline"){style.display=display;}}
function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props){name=jQuery.camelCase(index);easing=specialEasing[name];value=props[index];if(jQuery.isArray(value)){easing=value[1];value=props[index]=value[0];}
if(index!==name){props[name]=value;delete props[index];}
hooks=jQuery.cssHooks[name];if(hooks&&"expand"in hooks){value=hooks.expand(value);delete props[name];for(index in value){if(!(index in props)){props[index]=value[index];specialEasing[index]=easing;}}}else{specialEasing[name]=easing;}}}
function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem;}),tick=function(){if(stopped){return false;}
var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;for(;index<length;index++){animation.tweens[index].run(percent);}
deferred.notifyWith(elem,[animation,percent,remaining]);if(percent<1&&length){return remaining;}else{deferred.resolveWith(elem,[animation]);return false;}},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(true,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);animation.tweens.push(tween);return tween;},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped){return this;}
stopped=true;for(;index<length;index++){animation.tweens[index].run(1);}
if(gotoEnd){deferred.resolveWith(elem,[animation,gotoEnd]);}else{deferred.rejectWith(elem,[animation,gotoEnd]);}
return this;}}),props=animation.props;propFilter(props,animation.opts.specialEasing);for(;index<length;index++){result=animationPrefilters[index].call(animation,elem,props,animation.opts);if(result){return result;}}
jQuery.map(props,createTween,animation);if(jQuery.isFunction(animation.opts.start)){animation.opts.start.call(elem,animation);}
jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue}));return animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always);}
jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){if(jQuery.isFunction(props)){callback=props;props=["*"];}else{props=props.split(" ");}
var prop,index=0,length=props.length;for(;index<length;index++){prop=props[index];tweeners[prop]=tweeners[prop]||[];tweeners[prop].unshift(callback);}},prefilter:function(callback,prepend){if(prepend){animationPrefilters.unshift(callback);}else{animationPrefilters.push(callback);}}});jQuery.speed=function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;if(opt.queue==null||opt.queue===true){opt.queue="fx";}
opt.old=opt.complete;opt.complete=function(){if(jQuery.isFunction(opt.old)){opt.old.call(this);}
if(opt.queue){jQuery.dequeue(this,opt.queue);}};return opt;};jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback);},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);if(empty||jQuery._data(this,"finish")){anim.stop(true);}};doAnimation.finish=doAnimation;return empty||optall.queue===false?this.each(doAnimation):this.queue(optall.queue,doAnimation);},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop;stop(gotoEnd);};if(typeof type!=="string"){gotoEnd=clearQueue;clearQueue=type;type=undefined;}
if(clearQueue&&type!==false){this.queue(type||"fx",[]);}
return this.each(function(){var dequeue=true,index=type!=null&&type+"queueHooks",timers=jQuery.timers,data=jQuery._data(this);if(index){if(data[index]&&data[index].stop){stopQueue(data[index]);}}else{for(index in data){if(data[index]&&data[index].stop&&rrun.test(index)){stopQueue(data[index]);}}}
for(index=timers.length;index--;){if(timers[index].elem===this&&(type==null||timers[index].queue===type)){timers[index].anim.stop(gotoEnd);dequeue=false;timers.splice(index,1);}}
if(dequeue||!gotoEnd){jQuery.dequeue(this,type);}});},finish:function(type){if(type!==false){type=type||"fx";}
return this.each(function(){var index,data=jQuery._data(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;data.finish=true;jQuery.queue(this,type,[]);if(hooks&&hooks.stop){hooks.stop.call(this,true);}
for(index=timers.length;index--;){if(timers[index].elem===this&&timers[index].queue===type){timers[index].anim.stop(true);timers.splice(index,1);}}
for(index=0;index<length;index++){if(queue[index]&&queue[index].finish){queue[index].finish.call(this);}}
delete data.finish;});}});jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return speed==null||typeof speed==="boolean"?cssFn.apply(this,arguments):this.animate(genFx(name,true),speed,easing,callback);};});jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback);};});jQuery.timers=[];jQuery.fx.tick=function(){var timer,timers=jQuery.timers,i=0;fxNow=jQuery.now();for(;i<timers.length;i++){timer=timers[i];if(!timer()&&timers[i]===timer){timers.splice(i--,1);}}
if(!timers.length){jQuery.fx.stop();}
fxNow=undefined;};jQuery.fx.timer=function(timer){jQuery.timers.push(timer);if(timer()){jQuery.fx.start();}else{jQuery.timers.pop();}};jQuery.fx.interval=13;jQuery.fx.start=function(){if(!timerId){timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval);}};jQuery.fx.stop=function(){clearInterval(timerId);timerId=null;};jQuery.fx.speeds={slow:600,fast:200,_default:400};jQuery.fn.delay=function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout);};});};(function(){var input,div,select,a,opt;div=document.createElement("div");div.setAttribute("className","t");div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";a=div.getElementsByTagName("a")[0];select=document.createElement("select");opt=select.appendChild(document.createElement("option"));input=div.getElementsByTagName("input")[0];a.style.cssText="top:1px";support.getSetAttribute=div.className!=="t";support.style=/top/.test(a.getAttribute("style"));support.hrefNormalized=a.getAttribute("href")==="/a";support.checkOn=!!input.value;support.optSelected=opt.selected;support.enctype=!!document.createElement("form").enctype;select.disabled=true;support.optDisabled=!opt.disabled;input=document.createElement("input");input.setAttribute("value","");support.input=input.getAttribute("value")==="";input.value="t";input.setAttribute("type","radio");support.radioValue=input.value==="t";})();var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];if(hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret;}
ret=elem.value;return typeof ret==="string"?ret.replace(rreturn,""):ret==null?"":ret;}
return;}
isFunction=jQuery.isFunction(value);return this.each(function(i){var val;if(this.nodeType!==1){return;}
if(isFunction){val=value.call(this,i,jQuery(this).val());}else{val=value;}
if(val==null){val="";}else if(typeof val==="number"){val+="";}else if(jQuery.isArray(val)){val=jQuery.map(val,function(value){return value==null?"":value+"";});}
hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!hooks||!("set"in hooks)||hooks.set(this,val,"value")===undefined){this.value=val;}});}});jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return val!=null?val:jQuery.trim(jQuery.text(elem));}},select:{get:function(elem){var value,option,options=elem.options,index=elem.selectedIndex,one=elem.type==="select-one"||index<0,values=one?null:[],max=one?index+1:options.length,i=index<0?max:one?index:0;for(;i<max;i++){option=options[i];if((option.selected||i===index)&&(support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one){return value;}
values.push(value);}}
return values;},set:function(elem,value){var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;while(i--){option=options[i];if(jQuery.inArray(jQuery.valHooks.option.get(option),values)>=0){try{option.selected=optionSet=true;}catch(_){option.scrollHeight;}}else{option.selected=false;}}
if(!optionSet){elem.selectedIndex=-1;}
return options;}}}});jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(jQuery.isArray(value)){return(elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0);}}};if(!support.checkOn){jQuery.valHooks[this].get=function(elem){return elem.getAttribute("value")===null?"on":elem.value;};}});var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle,ruseDefault=/^(?:checked|selected)$/i,getSetAttribute=support.getSetAttribute,getSetInput=support.input;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1);},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name);});}});jQuery.extend({attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return;}
if(typeof elem.getAttribute===strundefined){return jQuery.prop(elem,name,value);}
if(nType!==1||!jQuery.isXMLDoc(elem)){name=name.toLowerCase();hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook);}
if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name);}else if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret;}else{elem.setAttribute(name,value+"");return value;}}else if(hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null){return ret;}else{ret=jQuery.find.attr(elem,name);return ret==null?undefined:ret;}},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);if(attrNames&&elem.nodeType===1){while((name=attrNames[i++])){propName=jQuery.propFix[name]||name;if(jQuery.expr.match.bool.test(name)){if(getSetInput&&getSetAttribute||!ruseDefault.test(name)){elem[propName]=false;}else{elem[jQuery.camelCase("default-"+name)]=elem[propName]=false;}}else{jQuery.attr(elem,name,"");}
elem.removeAttribute(getSetAttribute?name:propName);}}},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val){elem.value=val;}
return value;}}}}});boolHook={set:function(elem,value,name){if(value===false){jQuery.removeAttr(elem,name);}else if(getSetInput&&getSetAttribute||!ruseDefault.test(name)){elem.setAttribute(!getSetAttribute&&jQuery.propFix[name]||name,name);}else{elem[jQuery.camelCase("default-"+name)]=elem[name]=true;}
return name;}};jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=getSetInput&&getSetAttribute||!ruseDefault.test(name)?function(elem,name,isXML){var ret,handle;if(!isXML){handle=attrHandle[name];attrHandle[name]=ret;ret=getter(elem,name,isXML)!=null?name.toLowerCase():null;attrHandle[name]=handle;}
return ret;}:function(elem,name,isXML){if(!isXML){return elem[jQuery.camelCase("default-"+name)]?name.toLowerCase():null;}};});if(!getSetInput||!getSetAttribute){jQuery.attrHooks.value={set:function(elem,value,name){if(jQuery.nodeName(elem,"input")){elem.defaultValue=value;}else{return nodeHook&&nodeHook.set(elem,value,name);}}};}
if(!getSetAttribute){nodeHook={set:function(elem,value,name){var ret=elem.getAttributeNode(name);if(!ret){elem.setAttributeNode((ret=elem.ownerDocument.createAttribute(name)));}
ret.value=value+="";if(name==="value"||value===elem.getAttribute(name)){return value;}}};attrHandle.id=attrHandle.name=attrHandle.coords=function(elem,name,isXML){var ret;if(!isXML){return(ret=elem.getAttributeNode(name))&&ret.value!==""?ret.value:null;}};jQuery.valHooks.button={get:function(elem,name){var ret=elem.getAttributeNode(name);if(ret&&ret.specified){return ret.value;}},set:nodeHook.set};jQuery.attrHooks.contenteditable={set:function(elem,value,name){nodeHook.set(elem,value===""?false:value,name);}};jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]={set:function(elem,value){if(value===""){elem.setAttribute(name,"auto");return value;}}};});}
if(!support.style){jQuery.attrHooks.style={get:function(elem){return elem.style.cssText||undefined;},set:function(elem,value){return(elem.style.cssText=value+"");}};}
var rfocusable=/^(?:input|select|textarea|button|object)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1);},removeProp:function(name){name=jQuery.propFix[name]||name;return this.each(function(){try{this[name]=undefined;delete this[name];}catch(e){}});}});jQuery.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return;}
notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=jQuery.propFix[name]||name;hooks=jQuery.propHooks[name];}
if(value!==undefined){return hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:(elem[name]=value);}else{return hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null?ret:elem[name];}},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1;}}}});if(!support.hrefNormalized){jQuery.each(["href","src"],function(i,name){jQuery.propHooks[name]={get:function(elem){return elem.getAttribute(name,4);}};});}
if(!support.optSelected){jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;if(parent){parent.selectedIndex;if(parent.parentNode){parent.parentNode.selectedIndex;}}
return null;}};}
jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this;});if(!support.enctype){jQuery.propFix.enctype="encoding";}
var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(value){var classes,elem,cur,clazz,j,finalValue,i=0,len=this.length,proceed=typeof value==="string"&&value;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className));});}
if(proceed){classes=(value||"").match(rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ");if(cur){j=0;while((clazz=classes[j++])){if(cur.indexOf(" "+clazz+" ")<0){cur+=clazz+" ";}}
finalValue=jQuery.trim(cur);if(elem.className!==finalValue){elem.className=finalValue;}}}}
return this;},removeClass:function(value){var classes,elem,cur,clazz,j,finalValue,i=0,len=this.length,proceed=arguments.length===0||typeof value==="string"&&value;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className));});}
if(proceed){classes=(value||"").match(rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"");if(cur){j=0;while((clazz=classes[j++])){while(cur.indexOf(" "+clazz+" ")>=0){cur=cur.replace(" "+clazz+" "," ");}}
finalValue=value?jQuery.trim(cur):"";if(elem.className!==finalValue){elem.className=finalValue;}}}}
return this;},toggleClass:function(value,stateVal){var type=typeof value;if(typeof stateVal==="boolean"&&type==="string"){return stateVal?this.addClass(value):this.removeClass(value);}
if(jQuery.isFunction(value)){return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal);});}
return this.each(function(){if(type==="string"){var className,i=0,self=jQuery(this),classNames=value.match(rnotwhite)||[];while((className=classNames[i++])){if(self.hasClass(className)){self.removeClass(className);}else{self.addClass(className);}}}else if(type===strundefined||type==="boolean"){if(this.className){jQuery._data(this,"__className__",this.className);}
this.className=this.className||value===false?"":jQuery._data(this,"__className__")||"";}});},hasClass:function(selector){var className=" "+selector+" ",i=0,l=this.length;for(;i<l;i++){if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0){return true;}}
return false;}});jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup error contextmenu").split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name);};});jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver);},bind:function(types,data,fn){return this.on(types,null,data,fn);},unbind:function(types,fn){return this.off(types,null,fn);},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn);},undelegate:function(selector,types,fn){return arguments.length===1?this.off(selector,"**"):this.off(types,selector||"**",fn);}});var nonce=jQuery.now();var rquery=(/\?/);var rvalidtokens=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;jQuery.parseJSON=function(data){if(window.JSON&&window.JSON.parse){return window.JSON.parse(data+"");}
var requireNonComma,depth=null,str=jQuery.trim(data+"");return str&&!jQuery.trim(str.replace(rvalidtokens,function(token,comma,open,close){if(requireNonComma&&comma){depth=0;}
if(depth===0){return token;}
requireNonComma=open||comma;depth+=!close-!open;return"";}))?(Function("return "+str))():jQuery.error("Invalid JSON: "+data);};jQuery.parseXML=function(data){var xml,tmp;if(!data||typeof data!=="string"){return null;}
try{if(window.DOMParser){tmp=new DOMParser();xml=tmp.parseFromString(data,"text/xml");}else{xml=new ActiveXObject("Microsoft.XMLDOM");xml.async="false";xml.loadXML(data);}}catch(e){xml=undefined;}
if(!xml||!xml.documentElement||xml.getElementsByTagName("parsererror").length){jQuery.error("Invalid XML: "+data);}
return xml;};var
ajaxLocParts,ajaxLocation,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href;}catch(e){ajaxLocation=document.createElement("a");ajaxLocation.href="";ajaxLocation=ajaxLocation.href;}
ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*";}
var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(func)){while((dataType=dataTypes[i++])){if(dataType.charAt(0)==="+"){dataType=dataType.slice(1)||"*";(structure[dataType]=structure[dataType]||[]).unshift(func);}else{(structure[dataType]=structure[dataType]||[]).push(func);}}}};}
function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){var inspected={},seekingTransport=(structure===transports);function inspect(dataType){var selected;inspected[dataType]=true;jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);if(typeof dataTypeOrTransport==="string"&&!seekingTransport&&!inspected[dataTypeOrTransport]){options.dataTypes.unshift(dataTypeOrTransport);inspect(dataTypeOrTransport);return false;}else if(seekingTransport){return!(selected=dataTypeOrTransport);}});return selected;}
return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*");}
function ajaxExtend(target,src){var deep,key,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src){if(src[key]!==undefined){(flatOptions[key]?target:(deep||(deep={})))[key]=src[key];}}
if(deep){jQuery.extend(true,target,deep);}
return target;}
function ajaxHandleResponses(s,jqXHR,responses){var firstDataType,ct,finalDataType,type,contents=s.contents,dataTypes=s.dataTypes;while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined){ct=s.mimeType||jqXHR.getResponseHeader("Content-Type");}}
if(ct){for(type in contents){if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break;}}}
if(dataTypes[0]in responses){finalDataType=dataTypes[0];}else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break;}
if(!firstDataType){firstDataType=type;}}
finalDataType=finalDataType||firstDataType;}
if(finalDataType){if(finalDataType!==dataTypes[0]){dataTypes.unshift(finalDataType);}
return responses[finalDataType];}}
function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1]){for(conv in s.converters){converters[conv.toLowerCase()]=s.converters[conv];}}
current=dataTypes.shift();while(current){if(s.responseFields[current]){jqXHR[s.responseFields[current]]=response;}
if(!prev&&isSuccess&&s.dataFilter){response=s.dataFilter(response,s.dataType);}
prev=current;current=dataTypes.shift();if(current){if(current==="*"){current=prev;}else if(prev!=="*"&&prev!==current){conv=converters[prev+" "+current]||converters["* "+current];if(!conv){for(conv2 in converters){tmp=conv2.split(" ");if(tmp[1]===current){conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]];if(conv){if(conv===true){conv=converters[conv2];}else if(converters[conv2]!==true){current=tmp[0];dataTypes.unshift(tmp[1]);}
break;}}}}
if(conv!==true){if(conv&&s["throws"]){response=conv(response);}else{try{response=conv(response);}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current};}}}}}}
return{state:"success",data:response};}
jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target);},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined;}
options=options||{};var
parts,i,cacheURL,responseHeadersString,timeoutTimer,fireGlobals,transport,responseHeaders,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(state===2){if(!responseHeaders){responseHeaders={};while((match=rheaders.exec(responseHeadersString))){responseHeaders[match[1].toLowerCase()]=match[2];}}
match=responseHeaders[key.toLowerCase()];}
return match==null?null:match;},getAllResponseHeaders:function(){return state===2?responseHeadersString:null;},setRequestHeader:function(name,value){var lname=name.toLowerCase();if(!state){name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;requestHeaders[name]=value;}
return this;},overrideMimeType:function(type){if(!state){s.mimeType=type;}
return this;},statusCode:function(map){var code;if(map){if(state<2){for(code in map){statusCode[code]=[statusCode[code],map[code]];}}else{jqXHR.always(map[jqXHR.status]);}}
return this;},abort:function(statusText){var finalText=statusText||strAbort;if(transport){transport.abort(finalText);}
done(0,finalText);return this;}};deferred.promise(jqXHR).complete=completeDeferred.add;jqXHR.success=jqXHR.done;jqXHR.error=jqXHR.fail;s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");s.type=options.method||options.type||s.method||s.type;s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""];if(s.crossDomain==null){parts=rurl.exec(s.url.toLowerCase());s.crossDomain=!!(parts&&(parts[1]!==ajaxLocParts[1]||parts[2]!==ajaxLocParts[2]||(parts[3]||(parts[1]==="http:"?"80":"443"))!==(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?"80":"443"))));}
if(s.data&&s.processData&&typeof s.data!=="string"){s.data=jQuery.param(s.data,s.traditional);}
inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(state===2){return jqXHR;}
fireGlobals=s.global;if(fireGlobals&&jQuery.active++===0){jQuery.event.trigger("ajaxStart");}
s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);cacheURL=s.url;if(!s.hasContent){if(s.data){cacheURL=(s.url+=(rquery.test(cacheURL)?"&":"?")+s.data);delete s.data;}
if(s.cache===false){s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++;}}
if(s.ifModified){if(jQuery.lastModified[cacheURL]){jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]);}
if(jQuery.etag[cacheURL]){jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL]);}}
if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){jqXHR.setRequestHeader("Content-Type",s.contentType);}
jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers){jqXHR.setRequestHeader(i,s.headers[i]);}
if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2)){return jqXHR.abort();}
strAbort="abort";for(i in{success:1,error:1,complete:1}){jqXHR[i](s[i]);}
transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport){done(-1,"No Transport");}else{jqXHR.readyState=1;if(fireGlobals){globalEventContext.trigger("ajaxSend",[jqXHR,s]);}
if(s.async&&s.timeout>0){timeoutTimer=setTimeout(function(){jqXHR.abort("timeout");},s.timeout);}
try{state=1;transport.send(requestHeaders,done);}catch(e){if(state<2){done(-1,e);}else{throw e;}}}
function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;if(state===2){return;}
state=2;if(timeoutTimer){clearTimeout(timeoutTimer);}
transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;isSuccess=status>=200&&status<300||status===304;if(responses){response=ajaxHandleResponses(s,jqXHR,responses);}
response=ajaxConvert(s,response,jqXHR,isSuccess);if(isSuccess){if(s.ifModified){modified=jqXHR.getResponseHeader("Last-Modified");if(modified){jQuery.lastModified[cacheURL]=modified;}
modified=jqXHR.getResponseHeader("etag");if(modified){jQuery.etag[cacheURL]=modified;}}
if(status===204||s.type==="HEAD"){statusText="nocontent";}else if(status===304){statusText="notmodified";}else{statusText=response.state;success=response.data;error=response.error;isSuccess=!error;}}else{error=statusText;if(status||!statusText){statusText="error";if(status<0){status=0;}}}
jqXHR.status=status;jqXHR.statusText=(nativeStatusText||statusText)+"";if(isSuccess){deferred.resolveWith(callbackContext,[success,statusText,jqXHR]);}else{deferred.rejectWith(callbackContext,[jqXHR,statusText,error]);}
jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals){globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]);}
completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!(--jQuery.active)){jQuery.event.trigger("ajaxStop");}}}
return jqXHR;},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json");},getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script");}});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=undefined;}
return jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback});};});jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn);};});jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:false,global:false,"throws":true});};jQuery.fn.extend({wrapAll:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapAll(html.call(this,i));});}
if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){wrap.insertBefore(this[0]);}
wrap.map(function(){var elem=this;while(elem.firstChild&&elem.firstChild.nodeType===1){elem=elem.firstChild;}
return elem;}).append(this);}
return this;},wrapInner:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this,i));});}
return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length){contents.wrapAll(html);}else{self.append(html);}});},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html);});},unwrap:function(){return this.parent().each(function(){if(!jQuery.nodeName(this,"body")){jQuery(this).replaceWith(this.childNodes);}}).end();}});jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0||(!support.reliableHiddenOffsets()&&((elem.style&&elem.style.display)||jQuery.css(elem,"display"))==="none");};jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem);};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj)){jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix)){add(prefix,v);}else{buildParams(prefix+"["+(typeof v==="object"?i:"")+"]",v,traditional,add);}});}else if(!traditional&&jQuery.type(obj)==="object"){for(name in obj){buildParams(prefix+"["+name+"]",obj[name],traditional,add);}}else{add(prefix,obj);}}
jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():(value==null?"":value);s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value);};if(traditional===undefined){traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional;}
if(jQuery.isArray(a)||(a.jquery&&!jQuery.isPlainObject(a))){jQuery.each(a,function(){add(this.name,this.value);});}else{for(prefix in a){buildParams(prefix,a[prefix],traditional,add);}}
return s.join("&").replace(r20,"+");};jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray());},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this;}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type));}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")};}):{name:elem.name,value:val.replace(rCRLF,"\r\n")};}).get();}});jQuery.ajaxSettings.xhr=window.ActiveXObject!==undefined?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&createStandardXHR()||createActiveXHR();}:createStandardXHR;var xhrId=0,xhrCallbacks={},xhrSupported=jQuery.ajaxSettings.xhr();if(window.ActiveXObject){jQuery(window).on("unload",function(){for(var key in xhrCallbacks){xhrCallbacks[key](undefined,true);}});}
support.cors=!!xhrSupported&&("withCredentials"in xhrSupported);xhrSupported=support.ajax=!!xhrSupported;if(xhrSupported){jQuery.ajaxTransport(function(options){if(!options.crossDomain||support.cors){var callback;return{send:function(headers,complete){var i,xhr=options.xhr(),id=++xhrId;xhr.open(options.type,options.url,options.async,options.username,options.password);if(options.xhrFields){for(i in options.xhrFields){xhr[i]=options.xhrFields[i];}}
if(options.mimeType&&xhr.overrideMimeType){xhr.overrideMimeType(options.mimeType);}
if(!options.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest";}
for(i in headers){if(headers[i]!==undefined){xhr.setRequestHeader(i,headers[i]+"");}}
xhr.send((options.hasContent&&options.data)||null);callback=function(_,isAbort){var status,statusText,responses;if(callback&&(isAbort||xhr.readyState===4)){delete xhrCallbacks[id];callback=undefined;xhr.onreadystatechange=jQuery.noop;if(isAbort){if(xhr.readyState!==4){xhr.abort();}}else{responses={};status=xhr.status;if(typeof xhr.responseText==="string"){responses.text=xhr.responseText;}
try{statusText=xhr.statusText;}catch(e){statusText="";}
if(!status&&options.isLocal&&!options.crossDomain){status=responses.text?200:404;}else if(status===1223){status=204;}}}
if(responses){complete(status,statusText,responses,xhr.getAllResponseHeaders());}};if(!options.async){callback();}else if(xhr.readyState===4){setTimeout(callback);}else{xhr.onreadystatechange=xhrCallbacks[id]=callback;}},abort:function(){if(callback){callback(undefined,true);}}};}});}
function createStandardXHR(){try{return new window.XMLHttpRequest();}catch(e){}}
function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP");}catch(e){}}
jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){jQuery.globalEval(text);return text;}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined){s.cache=false;}
if(s.crossDomain){s.type="GET";s.global=false;}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||jQuery("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script");script.async=true;if(s.scriptCharset){script.charset=s.scriptCharset;}
script.src=s.url;script.onload=script.onreadystatechange=function(_,isAbort){if(isAbort||!script.readyState||/loaded|complete/.test(script.readyState)){script.onload=script.onreadystatechange=null;if(script.parentNode){script.parentNode.removeChild(script);}
script=null;if(!isAbort){callback(200,"success");}}};head.insertBefore(script,head.firstChild);},abort:function(){if(script){script.onload(undefined,true);}}};}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||(jQuery.expando+"_"+(nonce++));this[callback]=true;return callback;}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==false&&(rjsonp.test(s.url)?"url":typeof s.data==="string"&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||s.dataTypes[0]==="jsonp"){callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback;if(jsonProp){s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName);}else if(s.jsonp!==false){s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName;}
s.converters["script json"]=function(){if(!responseContainer){jQuery.error(callbackName+" was not called");}
return responseContainer[0];};s.dataTypes[0]="json";overwritten=window[callbackName];window[callbackName]=function(){responseContainer=arguments;};jqXHR.always(function(){window[callbackName]=overwritten;if(s[callbackName]){s.jsonpCallback=originalSettings.jsonpCallback;oldCallbacks.push(callbackName);}
if(responseContainer&&jQuery.isFunction(overwritten)){overwritten(responseContainer[0]);}
responseContainer=overwritten=undefined;});return"script";}});jQuery.parseHTML=function(data,context,keepScripts){if(!data||typeof data!=="string"){return null;}
if(typeof context==="boolean"){keepScripts=context;context=false;}
context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];if(parsed){return[context.createElement(parsed[1])];}
parsed=jQuery.buildFragment([data],context,scripts);if(scripts&&scripts.length){jQuery(scripts).remove();}
return jQuery.merge([],parsed.childNodes);};var _load=jQuery.fn.load;jQuery.fn.load=function(url,params,callback){if(typeof url!=="string"&&_load){return _load.apply(this,arguments);}
var selector,response,type,self=this,off=url.indexOf(" ");if(off>=0){selector=jQuery.trim(url.slice(off,url.length));url=url.slice(0,off);}
if(jQuery.isFunction(params)){callback=params;params=undefined;}else if(params&&typeof params==="object"){type="POST";}
if(self.length>0){jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments;self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText);}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR]);});}
return this;};jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem;}).length;};var docElem=window.document.documentElement;function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType===9?elem.defaultView||elem.parentWindow:false;}
jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};if(position==="static"){elem.style.position="relative";}
curOffset=curElem.offset();curCSSTop=jQuery.css(elem,"top");curCSSLeft=jQuery.css(elem,"left");calculatePosition=(position==="absolute"||position==="fixed")&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left;}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0;}
if(jQuery.isFunction(options)){options=options.call(elem,i,curOffset);}
if(options.top!=null){props.top=(options.top-curOffset.top)+curTop;}
if(options.left!=null){props.left=(options.left-curOffset.left)+curLeft;}
if("using"in options){options.using.call(elem,props);}else{curElem.css(props);}}};jQuery.fn.extend({offset:function(options){if(arguments.length){return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i);});}
var docElem,win,box={top:0,left:0},elem=this[0],doc=elem&&elem.ownerDocument;if(!doc){return;}
docElem=doc.documentElement;if(!jQuery.contains(docElem,elem)){return box;}
if(typeof elem.getBoundingClientRect!==strundefined){box=elem.getBoundingClientRect();}
win=getWindow(doc);return{top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)};},position:function(){if(!this[0]){return;}
var offsetParent,offset,parentOffset={top:0,left:0},elem=this[0];if(jQuery.css(elem,"position")==="fixed"){offset=elem.getBoundingClientRect();}else{offsetParent=this.offsetParent();offset=this.offset();if(!jQuery.nodeName(offsetParent[0],"html")){parentOffset=offsetParent.offset();}
parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",true);parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",true);}
return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",true),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",true)};},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent||docElem;while(offsetParent&&(!jQuery.nodeName(offsetParent,"html")&&jQuery.css(offsetParent,"position")==="static")){offsetParent=offsetParent.offsetParent;}
return offsetParent||docElem;});}});jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top=/Y/.test(prop);jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem);if(val===undefined){return win?(prop in win)?win[prop]:win.document.documentElement[method]:elem[method];}
if(win){win.scrollTo(!top?val:jQuery(win).scrollLeft(),top?val:jQuery(win).scrollTop());}else{elem[method]=val;}},method,val,arguments.length,null);};});jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed){computed=curCSS(elem,prop);return rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed;}});});jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||typeof margin!=="boolean"),extra=defaultExtra||(margin===true||value===true?"margin":"border");return access(this,function(elem,type,value){var doc;if(jQuery.isWindow(elem)){return elem.document.documentElement["client"+name];}
if(elem.nodeType===9){doc=elem.documentElement;return Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name]);}
return value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra);},type,chainable?margin:undefined,chainable,null);};});});jQuery.fn.size=function(){return this.length;};jQuery.fn.andSelf=jQuery.fn.addBack;if(typeof define==="function"&&define.amd){define("jquery",[],function(){return jQuery;});}
var
_jQuery=window.jQuery,_$=window.$;jQuery.noConflict=function(deep){if(window.$===jQuery){window.$=_$;}
if(deep&&window.jQuery===jQuery){window.jQuery=_jQuery;}
return jQuery;};if(typeof noGlobal===strundefined){window.jQuery=window.$=jQuery;}
return jQuery;}));var ComagicCaptcha=function(api_url,jquery){jquery=jquery||Comagic.$;var IE=(function(){if(document.documentMode){return document.documentMode;}else{for(var i=7;i>0;i--){var div=document.createElement("div");div.innerHTML="<!--[if IE "+i+"]><span></span><![endif]-->";if(div.getElementsByTagName("span").length){return i;}}}
return undefined;})();var _ajaxRequest=function(url,callback,postData,method,headers){var xhr;var xhrMethod=method||postData?'POST':'GET';postData=postData||'';headers=headers||{};if(typeof XMLHttpRequest!=='undefined'){xhr=new XMLHttpRequest();}else{var versions=['MSXML2.XmlHttp.5.0','MSXML2.XmlHttp.4.0','MSXML2.XmlHttp.3.0','MSXML2.XmlHttp.2.0','Microsoft.XmlHttp'];for(var i=0;i<versions.length;i++){try{xhr=new ActiveXObject(versions[i]);}catch(e){}}}
xhr.onreadystatechange=function(){if(xhr.readyState===4&&xhr.status==200){callback(xhr);}};xhr.open(xhrMethod,url,true);for(var h in headers){if(headers.hasOwnProperty(h)){xhr.setRequestHeader(h,headers[h]);}}
xhr.send(postData);};var _apiRequest=function(method,params,callback){if(jquery){if(IE<=9&&window.XDomainRequest){var xdr=new XDomainRequest();xdr.open('POST',api_url);xdr.onload=function(){callback(JSON.parse(xdr.responseText).result)};xdr.send(JSON.stringify({method:method,params:params||{}}));}else{jquery.ajax({url:api_url,crossDomain:true,data:JSON.stringify({method:method,params:params||{}}),type:'POST',dataType:'json',headers:{'Content-Type':'application/json'},success:function(data){callback(data.result);}})}}else{var request_data={method:method,params:params||{}};_ajaxRequest(api_url,_apiResponse(callback),JSON.stringify(request_data),'POST',{'Content-Type':'application/json'});}};var _apiResponse=function(callback){return function(xhr){var response=JSON.parse(xhr.responseText);response.success&&callback(response.result);}};this.get_captcha=function(callback){_apiRequest('get_captcha',{},callback);};};if(!window.console){window.console={};}
if(!window.console.log){window.console.log=function(){};}
__comagic_tmp={};__comagic_tmp.SockJS=window.SockJS;try{(function(){var globalObjects=['Comagic','__cs'];for(var idx=0,len=globalObjects.length;idx<len;idx++){if(window[globalObjects[idx]]){if($.isArray(window[globalObjects[idx]])){__comagic_tmp[globalObjects[idx]]=window[globalObjects[idx]];window[globalObjects[idx]]={};}else if($.isPlainObject(window[globalObjects[idx]])){__comagic_tmp[globalObjects[idx]]=window[globalObjects[idx]].embedCodeQueue;}else{window[globalObjects[idx]]={};}}}})();window.__cs_onReplacePhones=window.__cs_onReplacePhones||function(phones){return true;};var Comagic=__cs=$.extend(new function(){var OpenUrlDialog=function(url,acceptCallback,cancelCallback){var that=this;this.url=url;this.acceptCallback=acceptCallback;this.cancelCallback=cancelCallback;this.html='<!--[if lt IE 9]><div class="comagic-popup-overlay comagic-popup-overlay-ie"></div><![endif]-->'+'<div class="comagic-popup-overlay">'+'<div class="comagic-popup">'+'<p>Оператор предлагает Вам открыть страницу с адресом '+this.url+'.</p>'+'<input type="button" value="Да" name="comagic-popup-y"/>'+'<input type="button" value="Нет" name="comagic-popup-n" />'+'</div><!--[if lt IE 9]><div class="comagic-popup-valign"></div><![endif]--></div>';this.css='<style type="text/css">'+'.comagic-popup-overlay {'+'display: none;'+'position: fixed;'+'left: 0;'+'top: 0;'+'width: 100%;'+'height: 100%;'+'background: rgba(255,255,255,.7);'+'text-align: center; '+'z-index: 16000;}'+'.comagic-popup-overlay:after {'+'display: inline-block;'+'*display: inline;'+'*zoom: 1;'+'height: 100%;'+'width: 0;'+'vertical-align: middle;'+'content: ""}'+'.comagic-popup-overlay-ie {'+'background: #fff;'+'opacity: .7;'+'filter: alpha(opacity=70)}'+'.comagic-popup {'+'font: 14px/125% Arial;'+'display: inline-block;'+'*display: inline;'+'*zoom: 1;'+'position: relative;'+'max-width: 80%;'+'padding: 20px;'+'border: 1px solid #ccc;'+'box-shadow: 0 0 10px rgba(120,120,120,0.5);'+'background: #fff;'+'vertical-align: middle}'+'.comagic-popup p {'+'margin: 1em 0;'+'text-align: center}'+'.comagic-popup-valign {'+'display: inline-block;'+'*display: inline;'+'*zoom: 1;'+'width: 0;'+'height: 100%;'+'vertical-align: middle}'+'.comagic-popup input[type="button"] {'+'padding: 6px 16px;'+'border: 1px solid #ccc;'+'border-radius: 2px;'+'cursor: pointer;'+'background: #fff;'+'color: #333;}'+'</style>';$(this.css).appendTo('head');$(this.html).appendTo('body').hide();$('.comagic-popup input[name=comagic-popup-y]').click(function(){that.hide();that.acceptCallback();window.location.href=that.url;});$('.comagic-popup input[name=comagic-popup-n]').click(function(){that.hide();that.cancelCallback();});this.show=function(){$('.comagic-popup-overlay').show();};this.hide=function(){$('.comagic-popup-overlay').hide();};};var URL=function(url){var self=this;var regexp=new RegExp('^(([^:/\\?#]+):)?(//(([^:/\\?#]*)(?::([^/\\?#]*))?))?([^\\?#]*)(\\?([^#]*))?(#(.*))?$');this.url=url;function init(){var parts=regexp.exec(self.url);self.protocol=parts[2]||'';self.host=parts[5]||'';self.port=parts[6]||'';self.path=parts[7]||'/';self.query=parts[8]||'';self.hash=parts[10]||'';}
this.replace=function(o){var protocol=o.protocol||self.protocol;var host=o.host||self.host;var port=o.port||self.port;var path=o.path||self.path;var query=o.query||self.query;var hash=o.hash||self.hash;return(protocol?protocol+':':protocol)+'//'+host+(port?':'+port:port)+
path+(query?'&'+query:query)+(hash?'#'+hash:hash);};init();};var Cookie={};Cookie.set=function(name,value,expires){expires=expires||2*365*24*60*60*1000;var expiresDate=new Date();var cookie=[];expiresDate.setTime(expiresDate.getTime()+expires);cookie.push(name+'='+encodeURIComponent(value));cookie.push('path=/');this.getDomain()&&cookie.push('domain='+Cookie.getDomain());expires!=-1&&cookie.push('expires='+expiresDate.toGMTString());document.cookie=cookie.join(';');};Cookie.get=function(name){var prefix=name+'=';var cookieStartIndex=document.cookie.indexOf(prefix);if(cookieStartIndex==-1)
return null;var cookieEndIndex=document.cookie.indexOf(';',cookieStartIndex+prefix.length);if(cookieEndIndex==-1)
cookieEndIndex=document.cookie.length;return decodeURIComponent(document.cookie.substring(cookieStartIndex+prefix.length,cookieEndIndex));};Cookie.remove=function(name){document.cookie=name+'=; expires='+new Date(0).toGMTString()+'; domain='+Cookie.getDomain()+'; path=/;';};Cookie.getDomain=function(){return _cookieDomain;};Cookie.setDomain=function(domain){_cookieDomain=domain;var v='cmgtest';this.set(v,v);if(v!=this.get(v)){_cookieDomain=null;}
this.remove(v);};Cookie.isEnabled=function(){return navigator.cookieEnabled||("cookie"in document&&(document.cookie.length>0||(document.cookie="test").indexOf.call(document.cookie,"test")>-1));};var ComagicCookie=function(name,ttl,key){var self=this;this.name=name;this.ttl=ttl;this.key=key||'';};ComagicCookie.prototype.getName=function(){return this.name+this.key.substring(0,5);};ComagicCookie.prototype.set=function(value,ttl){Cookie.set(this.getName(),value,ttl||this.ttl);};ComagicCookie.prototype.get=function(){return Cookie.get(this.getName());};ComagicCookie.prototype.remove=function(){Cookie.remove(this.getName());};var Util={};Util.uuid=function(){var S4=function(){return(((1+Math.random())*0x10000)|0).toString(16).substring(1);};return(S4()+S4()+'-'+S4()+'-'+S4()+'-'+
S4()+'-'+S4()+S4()+S4());};Util.padNumber=function(n){return(n<10?'0':'')+n;};Util.getTimeStr=function(date){date=date||new Date();return Util.padNumber(date.getHours())+':'+
Util.padNumber(date.getMinutes())+':'+
Util.padNumber(date.getSeconds())+'.'+
date.getMilliseconds();};Util.getTimestamp=function(){return Math.round(new Date().getTime()/1000);};Util.arrayIndexOf=function(array,obj,start){for(var i=(start||0),j=array.length;i<j;i++){if(array[i]===obj){return i;}}
return-1;};Util.getExponentialBackoff=function(){return Math.pow(2,_backoffStep++)*1000+
Math.round(Math.random()*1000);};Util.getUrlParams=function(paramsStr){var rawData=paramsStr.substring(1).split('&'),params={};for(var i=0;i<rawData.length;i++){var item=rawData[i].split('=');if(item[0]){try{params[item[0]]=decodeURIComponent(item[1]);}catch(e){}}}
return params;};Util.getUrlQuery=function(){return Util.getUrlParams(window.location.search);};Util.getUrlHash=function(){return Util.getUrlParams(window.location.hash);};Util.prepareSelector=function(element){if(element.indexOf('/')===0){var re=/(\w+)\[(\d+)\]/;var tree=element.split('/');tree.splice(0,1);for(var i=0;i<tree.length;i++){if(re.test(tree[i])){tree[i]=tree[i].replace(re,function(str,p1,p2){return p1+':eq('+(parseInt(p2,10)-1)+')';});}}
return tree.join(' > ');}else{return element;}};Util.getComagicWebUrl=function(){if(window.sessionStorage){return window.sessionStorage.getItem('cmg:comagicWebUrl')||_comagicWebUrl;}
return _comagicWebUrl;};Util.getDebugExternalChatComagicWebUrl=function(){if(window.sessionStorage){return window.sessionStorage.getItem('cmg:debugExternalChatComagicWebUrl');}};var UA={};UA.detect=function(){try{window[window['GoogleAnalyticsObject']](UA.getClientId);}catch(e){if(new Date().getTime()-_startTime<3000){window.setTimeout(UA.detect,300);}}};UA.getClientId=function(tracker){try{_uaClientId=tracker?tracker.get('clientId'):window[window['GoogleAnalyticsObject']].getAll()[0].get('clientId');}catch(e){_uaClientId=undefined;}
if(_handshakeState==_HANDSHAKE_DONE){_sendMessage('set_ua_client_id',{ua_client_id:_uaClientId});}else if(_handshakeState==_HANDSHAKE_SENDED){_deferredTasks.push(function(){_sendMessage('set_ua_client_id',{ua_client_id:_uaClientId});});}};var HttpTracker=function(url){this.url=url;};HttpTracker.prototype.trackEvent=function(siteKey,visitorKey,sessionId,eventId,hitId,pageId,magic){var params={sk:siteKey,vk:visitorKey,si:sessionId,ei:eventId,hi:hitId,pa:pageId,ma:magic,v:(new Date()).getTime()};var img=new Image();img.src=this.url+'?'+cm_$.param(params);};var PhoneReplacer=function(){var self=this;this.defaultPhonesObj={};};PhoneReplacer.prototype.getDefaultPhones=function(){var result=[];cm_$.each(this.defaultPhonesObj,function(k,v){result.push(v);});return result;};PhoneReplacer.prototype.addDefaultPhone=function(pdata){if(!(pdata.id in this.defaultPhonesObj)){this.defaultPhonesObj[pdata.id]=pdata;}};PhoneReplacer.prototype.embed=function(phones){if(!this.getEnabled()){return;}
if(window.__cs_onReplacePhones&&typeof window.__cs_onReplacePhones==='function'&&!window.__cs_onReplacePhones(phones)){return;}
if(phones&&phones.length>0&&cm_$.isArray(phones[0])){return;}
if(phones){for(var i=0;i<phones.length;i++){var pTag=phones[i].id,pText=phones[i].text,pImg=phones[i].img,pRaw=phones[i].raw;if(pTag){try{var el,selector=Util.prepareSelector(pTag);if(pImg){el=cm_$(selector);this.addDefaultPhone({id:pTag,img:el.attr('src'),text:null,raw:null});el.attr('src',pImg);}else if(pText){var aEl=cm_$('a'+selector+'[href^="tel:"]');if(aEl.length){this.addDefaultPhone({id:pTag,img:null,text:aEl.html(),raw:(aEl.attr('href')||'').split('tel:')[1]});aEl.html(pText).attr('href','tel:+'+pRaw);}
el=cm_$(selector).not(aEl);if(el.length){this.addDefaultPhone({id:pTag,img:null,text:el.html(),raw:null});el.html(pText);}}}catch(e){}}}}};PhoneReplacer.prototype.embedDefault=function(){this.getDefaultPhones().length!=0&&this.embed(this.getDefaultPhones());};PhoneReplacer.prototype.getEnabled=function(){return _getPhoneReplacementStateCookie().phone_replacement_enabled;};PhoneReplacer.prototype.setEnabled=function(o){_setPhoneReplacementStateCookie(o);};var DynamicalTracking=function(phones,ttl){var self=this;this.phones=phones||null;this.ttl=ttl||null;this.reserveTime=Util.getTimestamp();var cookieName='_cmg_dt';var dtTimeout=undefined;var dtInterval=undefined;var stringify=function(){return JSON.stringify({ph:self.phones,ttl:self.ttl,rt:self.reserveTime});};var parse=function(raw){var data=JSON.parse(raw)||{};return{phones:data.ph,ttl:data.ttl,reserveTime:data.rt}};this.saveCookie=function(){_setComagicCookie(cookieName,stringify(),_sessionCookieTtl);};this.loadCookie=function(){$.extend(self,parse(_getComagicCookie(cookieName)));};this.delCookie=function(){_delComagicCookie(cookieName);};this.showPhones=function(){if(self.phones){_phoneReplacer.embed(self.phones);dtInterval=setInterval(function(){!_getSessionCookie().key&&self.hidePhones();},1000);}};this.hidePhones=function(tag){dtTimeout&&clearTimeout(dtTimeout);dtTimeout=undefined;dtInterval&&clearInterval(dtInterval);dtInterval=undefined;if(tag){self.phones=$.grep(self.phones,function(e,i){return e.id!=tag});self.saveCookie();_phoneReplacer.embed($.grep(comagicStorage.getItem('_cmg_phones'),function(e,i){return e.id==tag}));}else{self.delCookie();_phoneReplacer.embed(comagicStorage.getItem('_cmg_phones'));}};};var Observer=function(){var self=this;var defaultCallback=function(){if(self.lastEventTime&&new Date().getTime()-self.lastEventTime<self.eventDelay){return;}
self.lastEventTime=new Date().getTime();_setPhonesFromCookies();};this.MutationObserver=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;this.eventDelay=200;this.lastEventTime=undefined;this.interval=undefined;this.observer=undefined;this.lastInnerHTML=undefined;this.observerEl=document.body;this._DOMSubtreeModifiedSupported=undefined;this.addMutationEventListener=function(element,event,callback){if(element.addEventListener){element.addEventListener(event,callback,false);return true;}
if(element.attachEvent){element.attachEvent('on'+event,callback);return true;}
return false;};this.removeMutationEventListener=function(element,event,callback){if(element.removeEventListener){element.removeEventListener(event,callback,false);}else if(element.detachEvent){element.detachEvent('on'+event,callback);}};this.isDOMSubtreeModifiedSupported=function(){if(this._DOMSubtreeModifiedSupported===undefined){var p=document.createElement('p');this._DOMSubtreeModifiedSupported=false;if(this.addMutationEventListener(p,'DOMSubtreeModified',function(){self._DOMSubtreeModifiedSupported=true})){p.appendChild(document.createElement('p'));}}
return this._DOMSubtreeModifiedSupported;};this.start=function(){var observerConf={childList:true,subtree:true};if(this.MutationObserver){this.observer=new this.MutationObserver(function(mutations){self.observer.disconnect();_setPhonesFromCookies();self.observer.observe(self.observerEl,observerConf);});this.observer.observe(self.observerEl,observerConf);}else if(self.isDOMSubtreeModifiedSupported()){this.addMutationEventListener(this.observerEl,'DOMSubtreeModified',defaultCallback);}else{this.lastInnerHTML=this.observerEl.innerHTML;this.interval=setInterval(function(){if(self.lastInnerHTML!=self.observerEl.innerHTML){self.lastInnerHTML=self.observerEl.innerHTML;defaultCallback();}},100);}};this.stop=function(){if(this.MutationObserver){this.observer&&this.observer.disconnect();}
else if(this.isDOMSubtreeModifiedSupported()){this.removeMutationEventListener(this.observerEl,'DOMSubtreeModified',defaultCallback);}
if(this.interval){this.interval&&clearInterval(this.interval);}};};var comagicStorage=new function(){var backend=window.localStorage||{getItem:function(key){return this.items.hasOwnProperty(key)?this.items[key]:null;},setItem:function(key,value){this.items[key]=value;},removeItem:function(key){delete this.items[key];},items:{}};var makeKey=function(key){return key+_getUniquePostfix();};this.getItem=function(key){return JSON.parse(backend.getItem(makeKey(key)));};this.setItem=function(key,value){value=value===undefined?null:value;backend.setItem(makeKey(key),JSON.stringify(value||""));};this.removeItem=function(key){backend.removeItem(makeKey(key));};};var _startTime=new Date().getTime(),_wsUrl,_conn,_siteKey,_hitId,_banner,_bannerParams,_comagicWebUrl,_pingInterval,_pingTimeout,_operatorStatus,_visitorIdElementText,_magic,_httpTracker,_pageId,_sleep,dtPhoneTimeout,_openUrlDialog,_visitorInsiteSended,_ocState,_uaClientId,_deferredTasks=[],_cookieSeparator='||',_cookieTtl=90*24*60*60*1000,_sessionCookieTtl=30*60*1000,_backoffStep=1,_HANDSHAKE_NOT_SENDED=0,_HANDSHAKE_SENDED=1,_HANDSHAKE_DONE=2,_handshakeState=_HANDSHAKE_NOT_SENDED,_queue=[],_cookieDomain=document.domain.indexOf('www.')==0?document.domain.substring(4):document.domain,_host=document.location.host.indexOf('www.')==0?document.location.host.slice(4):document.location.host,_scrollEvents={scrollStart:null,scrollEnd:null,scrollTo:{}},_clickEvents={},_linkEvents={},_debug,_externalLink='_external_link_',_consultant_initialized=false,_isEnabled=true,_timeDelta=0,_chatWatch=false,_rpcCallbacks={},_phoneReplacer=new PhoneReplacer(),_isDynamicalReplacementEnabled=false,_mutationObserver,_dt={};this.$=window.jQuery.noConflict(true);var $=this.$;var cm_$=this.$;var SockJS=window.SockJS;if(__comagic_tmp){for(var gObjects=['Comagic','__cs'],idx=0,len=gObjects.length;idx<len;idx++){if(__comagic_tmp[gObjects[idx]]&&cm_$.isArray(__comagic_tmp[gObjects[idx]])){_queue=_queue.concat(__comagic_tmp[gObjects[idx]]);}}
if(__comagic_tmp.SockJS){window.SockJS=__comagic_tmp.SockJS;}else{try{delete window.SockJS;}catch(e){}}}
try{delete window.__comagic_tmp;}catch(e){}
var self=this;var _rpcHandlers={setup_events:_bind(_onSetupEvents,this),event_action:_bind(_onEventAction,this),init_consultant:_bind(_onInitConsultant,this),refresh_state:_bind(_onConsultantRefreshState,this),pong:_bind(_pong,this),disconnect:_bind(_onDisconnect,this),sleep:_bind(_onSleep,this),message:_bind(_onMessage,this),close_chat:_bind(_onChatClose,this),set_operator_rating:_bind(_onSetOperatorRating,this),show_chat:_bind(_onShowChat,this),disable_dt:_bind(_onDisableDt,this),hide_dt_phone:_bind(_onHideDtPhone,this),connected:_bind(_onConnected,this),disable_phone_replacement:_bind(_onDisablePhoneReplacement,this),enable_phone_replacement:_bind(_onEnablePhoneReplacement,this),show_lead_request:_bind(_onShowLeadRequest,this),hide_lead_request:_bind(_onHideLeadRequest,this),enable_retention:_bind(_onEnableRetention,this),disable_retention:_bind(_onDisableRetention,this),show_popup_message:_bind(_onShowPopupMessage,this),show_open_url_dialog:_bind(_onShowOpenUrlDialog,this),hide_open_url_dialog:_bind(_onHideOpenUrlDialog,this),sitephone_call_result:_bind(_onSitephoneCallResult,this),write_notify:_bind(_onWriteNotify,this),chat_watch:_bind(_onChatWatch,this),show_popup_notification:_bind(_onShowPopupNotification,this),enable_comagic:_bind(_onEnableComagic,this),disable_comagic:_bind(_onDisableComagic,this),operator_reject:_bind(_onOperatorReject,this),update_operator:_bind(_onUpdateOperator,this),show_chat_retention_action:_bind(_onShowChatRetentionAction,this)};function _checkQueue(){if(!_isReady()){for(var i=0;i<_queue.length;i++){if(cm_$.isArray(_queue[i])){switch(_queue[i][0]){case'setAccount':_setAccount(_queue.splice(i,1)[0][1]);i--;break;case'setHost':_setHost(_queue.splice(i,1)[0][1]);i--;break;case'setWebUrl':self.setWebUrl(_queue.splice(i,1)[0][1]);i--;break;}}}}
if(_handshakeState==_HANDSHAKE_DONE){while(_queue.length>0){var action=_queue.shift();if(cm_$.isArray(action)){if(action[0]in self){var params;if(action.length>=2){params=typeof(action[1])=='object'&&(action[1]instanceof Array)?action[1]:[action[1]];}
self[action[0]].apply(self,params||[]);}}}}}
function _setAccount(key){if(!_siteKey){_siteKey=key;_onReady();}}
function _setHost(url){_wsUrl=url;_httpTracker=new HttpTracker(new URL(_wsUrl).replace({path:'/tr/b.gif'}));_onReady();}
function _isReady(){return!!(_siteKey&&_wsUrl);}
function _onReady(){if(!_isReady()){return;}
cm_$(document).ready(function(){_setPhonesFromCookies();});self.setDebug();_connect();}
this.push=function(param){_queue.push(param);};function _getUniquePostfix(){return _siteKey.substring(0,5)}
function _setComagicCookie(name,value,expires){return Cookie.set(name+_getUniquePostfix(),value,expires);}
function _getComagicCookie(name){return Cookie.get(name+_getUniquePostfix());}
function _delComagicCookie(name){return Cookie.remove(name+_getUniquePostfix());}
function _setPhoneReplacementStateCookie(params){params.phone_replacement_enabled?_delPhoneReplacementStateCookie():_setComagicCookie('_comagic_phr',params.phone_replacement_enabled,_sessionCookieTtl);}
function _getPhoneReplacementStateCookie(){return{phone_replacement_enabled:_getComagicCookie('_comagic_phr')!=='false'};}
function _delPhoneReplacementStateCookie(){_delComagicCookie('_comagic_phr');}
function _setVisitorCookie(params){_setComagicCookie('_comagic_visitor',params.key+_cookieSeparator+
params.id);}
function _getVisitorCookie(){var tmp=_getComagicCookie('_comagic_visitor');tmp=tmp?tmp.split(_cookieSeparator):[];return{key:tmp[0],id:tmp[1]};}
function _setBannerStateCookie(params){_setComagicCookie('_comagic_banner_state',params.state);}
function _getBannerStateCookie(params){return{state:_getComagicCookie('_comagic_banner_state')==='true'};}
function _setSessionCookie(params){_setComagicCookie('_comagic_session',params.key,_sessionCookieTtl);}
function _delSessionCookie(){_delComagicCookie('_comagic_session');}
function _getSessionCookie(){var tmp=_getComagicCookie('_comagic_session');tmp=tmp?tmp.split(_cookieSeparator):[];return{key:tmp[0]};}
function _updateSessionCookie(){_setSessionCookie(_getSessionCookie())}
function _sendGetRequest(eventId){if(!_getSessionCookie().key&&Cookie.isEnabled()){_deferredTasks.push(function(){_sendGetRequest(eventId);});_sleep?_reconnect():_handshake();}
_httpTracker&&_httpTracker.trackEvent(_siteKey,_getVisitorCookie().key,_getSessionCookie().key,eventId,_hitId,_pageId,_magic);}
function _makeMessage(name,params,id){return JSON.stringify({name:name,params:params,id:id||null,type:'rpc'});}
function _loadMessage(message){return JSON.parse(message);}
function _onSocketOpen(){_debug&&console.log(Util.getTimeStr(),'Connection opened');_pingInterval=setInterval(function(){_ping()},30000);_handshake();if(_consultant_initialized){_sendConsultantPresence();_banner.show(true);}}
function _onSocketClose(){_debug&&console.log(Util.getTimeStr(),'Connection closed');_consultant_initialized&&_banner.show(false);_pingInterval&&clearInterval(_pingInterval);_visitorInsiteSended=false;_reconnect();}
function _onSocketMessage(m){_debug&&console.log(Util.getTimeStr(),'Receive message, ',m.data);var msg;try{msg=_loadMessage(m.data);}catch(e){_debug&&console.log(e);msg={};}
if(msg.type=='rpc-result'){if(msg.id in _rpcCallbacks){_rpcCallbacks[msg.id]({success:msg.success,result:msg.result});delete _rpcCallbacks[msg.id];}}
else if(msg.type=='rpc'){if(msg.name in _rpcHandlers){_rpcHandlers[msg.name](msg.params);}}}
function _setupHandlers(){_conn.onopen=_onSocketOpen;_conn.onclose=_onSocketClose;_conn.onmessage=_onSocketMessage;}
function _connect(){if(window.location.search.indexOf('xhr_only')!==-1){WebSocket=undefined;}
var comagicOffline=_getComagicCookie('_comagic_offline');comagicOffline=='1'&&_setComagicCookie('_comagic_offline',2,30*60*1000);if(!comagicOffline){_conn=new SockJS(_wsUrl);try{_setupHandlers();}catch(e){_debug&&console.log(e);}}}
function _reconnect(){_sleep&&(_sleep=false);if(_backoffStep>5){return;}
_conn={};setTimeout(function(){_connect()},Util.getExponentialBackoff());}
function _sendMessage(name,params,callback){if(!_getSessionCookie().key&&Cookie.isEnabled()&&name!='handshake'){_debug&&console.log('Got command '+name+', but session not found, running handshake');_deferredTasks.push(function(){_sendMessage(name,params,callback)});_sleep?_reconnect():_handshake();return;}
var msg_id=null;if(callback){msg_id=Util.uuid();_rpcCallbacks[msg_id]=callback;}
var msg=_makeMessage(name,params,msg_id);_debug&&console.log(Util.getTimeStr(),'Send message:',msg);_conn&&_conn.readyState===SockJS.OPEN&&_conn.send(msg);}
function _ping(){if(_getSessionCookie().key&&!_sleep){_sendMessage('ping');_pingTimeout=setTimeout(function(){_onpingTimeout();},10000);}}
function _pong(params){_pingTimeout&&clearTimeout(_pingTimeout);if(params&&'state'in params){_debug&&console.log(Util.getTimeStr(),'Got state in pong:',params.state);_onConsultantRefreshState(params);}}
function _onpingTimeout(){_debug&&console.log(Util.getTimeStr(),'ping timeout(((');_onSocketClose();}
function _handshake(){if(_handshakeState==_HANDSHAKE_SENDED){return;}else if(!_siteKey||!_wsUrl||(_conn&&_conn.readyState!==SockJS.OPEN)){return;}else if(_handshakeState==_HANDSHAKE_DONE&&_getSessionCookie().key){_sendMessage('reconnected',{visitor_key:_getVisitorCookie().key,session_key:_getSessionCookie().key,site_key:_siteKey,hit:_hitId,magic:_magic});return;}
_handshakeState=_HANDSHAKE_SENDED;_rpcHandlers['handshake']=_handshakeHandler;_sendMessage('handshake',{site_key:_siteKey,visitor_key:_getVisitorCookie().key,session_key:_getSessionCookie().key,useragent:navigator.userAgent,lang:navigator.language,screen:screen.width+'x'+screen.height,url:document.location.href,title:encodeURI(document.title),referrer:document.referrer,ua_client_id:_uaClientId});}
function _handshakeHandler(params){_backoffStep=1;if('t'in params){_timeDelta=params.t-Util.getTimestamp();}
if('cookie_ttl'in params){_cookieTtl=params.cookie_ttl||_cookieTtl;}
if('domain'in params){Cookie.setDomain(params.domain);}
if('phone_replacement_enabled'in params){!params.phone_replacement_enabled&&_phoneReplacer.embedDefault();_phoneReplacer.setEnabled(params);}
if('comagic_enabled'in params){_isEnabled=params['comagic_enabled'];}
if('visitor_key'in params&&'visitor_id'in params&&'session_key'in params){_setVisitorCookie({key:params.visitor_key,id:params.visitor_id});_setSessionCookie({key:params.session_key});if('phones_and_tags'in params){_adCampaignHandler(params);}
if('dt_phones_and_tags'in params){_dtPhoneHandler(params);}}
if('hit'in params){_hitId=params.hit;}
if('page'in params){_pageId=params.page;}
if('vid_embedding'in params){_embedVisitorId(params.vid_embedding);}
if('magic'in params){_magic=params.magic;}
_handshakeState=_HANDSHAKE_DONE;while(_deferredTasks.length){var t=_deferredTasks.pop();t();}}
function _embedVisitorId(settings){if(settings.tag){var selector=Util.prepareSelector(settings.tag);var el=cm_$(selector);if(el){try{if(_visitorIdElementText===undefined){_visitorIdElementText=el.text();}
var visitorId=_getVisitorCookie().id;el.text((_visitorIdElementText||'')+settings.prefix+(visitorId.length<=+settings.tail?visitorId:visitorId.slice(-settings.tail)));}catch(e){_debug&&console.log(e);}}}}
function _adCampaignHandler(params){comagicStorage.setItem('_cmg_phones',params.phones_and_tags);_phoneReplacer.embed(params.phones_and_tags);}
function _dtPhoneHandler(params){_dt=new DynamicalTracking(params.dt_phones_and_tags,params.dt_phone_ttl);_dt.saveCookie();_dt.showPhones();}
function _onHideDtPhone(params){_dt&&_dt.hidePhones(params.el);}
function _bind(func,context){return function(){return func.apply(context,arguments||[]);};}
function _notifyOnEvent(eventId,method){method=method||'sockjs';_debug&&console.log('Sending event notification, event:',eventId,'method:',method);if(method=='sockjs'){_sendMessage('notify_on_event',{site_key:_siteKey,visitor_key:_getVisitorCookie().key,session_key:_getSessionCookie().key,hit:_hitId,page:_pageId,event_id:eventId});}else if(method=='get'||method=='http'){_sendGetRequest(eventId);}}
function _scrollStartHandler(event){cm_$(window).unbind('scroll',_scrollStartHandler);_notifyOnEvent(_scrollEvents['scrollStart']);}
function _scrollEndHandler(event){if(cm_$(window).scrollTop()+cm_$(window).height()===cm_$(document).height()){cm_$(window).unbind('scroll',_scrollEndHandler);_notifyOnEvent(_scrollEvents['scrollEnd']);}}
function _isElementVisible(element){var el=cm_$(element);if(el){var viewTop=cm_$(window).scrollTop();var viewBottom=cm_$(window).height()+viewTop;var elementTop=cm_$(element).offset().top;var elementBottom=elementTop+cm_$(element).height();return((elementBottom<=viewBottom)&&(elementTop>=viewTop));}else{return false;}}
function _scrollToHandler(event){for(var el in _scrollEvents['scrollTo']){if(_scrollEvents['scrollTo'].hasOwnProperty(el)&&_isElementVisible(el)){_notifyOnEvent(_scrollEvents['scrollTo'][el]);delete _scrollEvents['scrollTo'][el];}}}
function _clickEventHandler(event){for(var el in _clickEvents){if(_clickEvents.hasOwnProperty(el)&&cm_$(event.target).is(cm_$(el)))
{_notifyOnEvent(_clickEvents[el],'http');break;}}}
function _linkEventHandler(event){for(var re in _linkEvents){if(re==_externalLink){if(event.target.href&&event.target.href.indexOf(_host)==-1){_notifyOnEvent(_linkEvents[re],'http');break;}}else if(event.target.href&&event.target.href.match(new RegExp(re))){_notifyOnEvent(_linkEvents[re],'http');break;}}}
function _onDisconnect(params){_setComagicCookie('_comagic_offline',2,30*60*1000);if(_conn){_conn.onclose=null;_conn.readyState===SockJS.OPEN&&_conn.close();_conn=null;}
_pingInterval&&clearInterval(_pingInterval);_phoneReplacer.embedDefault();}
function _onSleep(params){_sleep=true;if(_conn){_conn.onclose=null;_conn.readyState===SockJS.OPEN&&_conn.close();_conn=null;}
_pingInterval&&clearInterval(_pingInterval);}
function _onSetupEvents(params){var i;if(params.click_events){for(i=0;i<params.click_events.length;i++){_clickEvents[Util.prepareSelector(params.click_events[i][1])]=params.click_events[i][0];}
cm_$(document).on('click',_clickEventHandler);}
if(params.link_events){if(params.link_events){for(i=0;i<params.link_events.length;i++){_linkEvents[params.link_events[i][1]]=params.link_events[i][0];}
cm_$(document).on('click','a',_linkEventHandler);}}
if(params.scroll_events){for(i=0;i<params.scroll_events.length;i++){if(params.scroll_events[i][1]=='comagic_scroll_start'){_scrollEvents['scrollStart']=params.scroll_events[i][0];cm_$(window).bind('scroll',_scrollStartHandler);}else if(params.scroll_events[i][1]=='comagic_scroll_end'){_scrollEvents['scrollEnd']=params.scroll_events[i][0];cm_$(window).bind('scroll',_scrollEndHandler);}else{_scrollEvents['scrollTo'][Util.prepareSelector(params.scroll_events[i][1])]=params.scroll_events[i][0];}}
if(_scrollEvents['scrollTo']){cm_$(window).bind('scroll',_scrollToHandler);}}
if(params.timers){for(i=0;i<params.timers.length;i++){var f=function(event,timeout){setTimeout(function(){_notifyOnEvent(event)},timeout)}(params.timers[i][0],params.timers[i][1]*1000);}}}
function _onMessage(params){_banner.onComagicMessage(params);}
function _onChatClose(params){if(_banner.activeComponent.ftype!=='site-phone'&&_banner.activeComponent.ftype!=='site_request'){_banner&&_banner.openCmp('label');_banner.setOperator(' ',null,' ',false);}}
function _onSetOperatorRating(params){_banner.getCmp('consultant').setOperatorRating(params.rating);}
function _onShowChat(){_banner.openCmp('consultant');}
function _onDisableDt(){_dt&&_dt.hidePhones();}
function _onConnected(params){var consultant=_banner.getCmp('consultant');consultant.setOperator(params['operator_name'],params['avatar'],params['operator_position'],params['is_file_transfer_available']);consultant.getConsultantLogCmp().hideAlternateCommunicationButtons();}
function _onShowOpenUrlDialog(params){_openUrlDialog=new OpenUrlDialog(params.url,function(){_sendMessage('open_url_accepted');},function(){_sendMessage('open_url_canceled');});_openUrlDialog.show();}
function _onHideOpenUrlDialog(){_openUrlDialog&&_openUrlDialog.hide();}
function _sitePhoneStartCall(params,callback){_sendMessage('sitephone_call',{site_key:_siteKey,visitor_key:_getVisitorCookie().key,session_key:_getSessionCookie().key,captcha_key:params.captcha_key||null,captcha_val:params.captcha_val||null,phone:params.phone,is_custom:!!callback},callback);}
function _sendOfflineRequest(params,is_custom,callback){if(typeof(is_custom)==='undefined'){is_custom=false;}
_sendMessage('offline_request',{site_key:_siteKey,visitor_key:_getVisitorCookie().key,session_key:_getSessionCookie().key,email:params.email,name:params.name,phone:params.phone,text:params.message,is_sale:params.is_sale,sale_cost:params.sale_cost,is_custom:is_custom},callback);}
function _sendRejectInvite(){_sendMessage('reject_invite',{site_key:_siteKey,visitor_key:_getVisitorCookie().key,session_key:_getSessionCookie().key});}
function _sendBannerForm(params){params['site_key']=_siteKey;params['visitor_key']=_getVisitorCookie().key;params['session_key']=_getSessionCookie().key;_sendMessage('set_form_data',params)}
function _onEventAction(params){}
function _notifyOperatorStatusChange(state){try{_operatorStatus=state;self.onOperatorStatusChange(state);}catch(e){_debug&&console.log(e);}}
function _popupChatWindow(cmp,params){var url=Util.getComagicWebUrl();if(!_getSessionCookie().key&&Cookie.isEnabled()){_debug&&console.log('Session expired');_deferredTasks.push(function(){_popupChatWindow();});_sleep?_reconnect():_handshake();}else{var comagicUrl=url+'consultant/visitor_chat'+'/?site_key='+_siteKey+'&visitor_key='+
_getVisitorCookie().key+'&hit_id='+_hitId+'&session_key='+_getSessionCookie().key+'&join=1'+'&web_url='+encodeURIComponent(url)+'&parent_href='+encodeURIComponent(window.location.href)+'&server='+encodeURIComponent(_wsUrl)+
(uLiB.util.getDebugParam?'&bannerdebug='+uLiB.util.getDebugParam('encodejson'):'')+'&time_delta='+_timeDelta,popupWindowParams=params||{},dUrl=Util.getDebugExternalChatComagicWebUrl();if(dUrl){comagicUrl+=('&comagic_web_url='+dUrl);}
for(var p in popupWindowParams){if(popupWindowParams.hasOwnProperty(p)){comagicUrl+='&'+p+'='+popupWindowParams[p]}}
window.open(comagicUrl,'',_banner.getPopupWindowDimensions()+',scrollbars=yes,resizable=yes,location=no,status=no')}}
function _openSitePhonePanel(){_banner&&_banner.openCmp('site_phone');}
function _openSiteRequestPanel(){_banner&&_banner.openCmp('site_request');}
function _openLeadRequestPanel(params){_banner&&_banner.openCmp('lead_request',params);}
function _closeLeadRequestPanel(params){}
function _openRetentionPanel(params){_banner&&_banner.openModalCmp('retention',params);}
function _setPhonesFromCookies(){if(_getComagicCookie('_comagic_offline')=='2'){return;}
_phoneReplacer.embed(comagicStorage.getItem('_cmg_phones'));_dt=new DynamicalTracking();_dt.loadCookie();_dt.showPhones();}
function _onBannerFormSubmit(params){_sendBannerForm(params);}
function _onLeadRequestSubmit(lead_id,params){_sendMessage('lead_request_submit',{lead_id:lead_id,data:params});}
function _onLeadRequestCancel(lead_id){lead_id&&_sendMessage('lead_request_cancel',{lead_id:lead_id});}
function _onRetentionSubmit(retention_id,params){_sendMessage('retention_submit',{retention_id:retention_id,data:params});}
function _onRetentionCancel(retention_id){retention_id&&_sendMessage('retention_cancel',{retention_id:retention_id});}
function _onConsultantSubmit(params){self.onChatMessageSend(params);}
function _onSendChatByEmail(params){self.onSendChatByMail(params);}
function _onBannerInviteReject(){_debug&&console.log('Sending reject...');_sendRejectInvite();}
function _onBannerChatOpen(o){if(_banner.banner_skin==='touch'){_banner.onChatPopup(_banner.activeComponent,{action:'consultant',is_touch:true});return;}
o&&_ocState==='online'&&_sendMessage('start_visitor_chat');o&&_ocState==='in_chat'&&_banner.openCmp('consultant');}
function _onBannerChatClose(){self.onChatClose();}
function _onBannerChatPopup(cmp,params){_banner.openCmp('label');_popupChatWindow(cmp,params);}
function _onBannerShow(state){}
function _onBannerActivate(state){}
function _onBannerExpand(state){_setBannerStateCookie({state:state});}
function _onBannerSitePhoneStartCall(obj){_debug&&console.log(obj);_sitePhoneStartCall(obj);}
function _onBannerSiteRequestSubmit(obj){_debug&&console.log(obj);_sendOfflineRequest(obj);}
function _onBannerSitePhoneOpen(obj){self.trackSysEvent({component_event:'callme_first_click'});}
function _onCurrentMessage(msg){self.onCurrentMessageSend(msg);}
function _onOfflineState(params){_notifyOperatorStatusChange(false);_banner.activate(false);}
function _onOnlineState(params){_notifyOperatorStatusChange(true);_banner.activate(true);}
function _onInChatState(params){_notifyOperatorStatusChange(true);if(params.show_chat&&!uLiB.util.storageGet('isMinimized')){_banner.openCmp('consultant');}else{_banner.activate(true);_banner.openCmp('label');}}
function _onInviteState(params){if(_banner.getCmp('consultant').isLogEmpty()){_onMessage(params);return;}
_banner.openCmp(params.show_chat?'consultant':'label',params);}
function _onLeadState(params){_onShowLeadRequest(params.settings);}
function _onConsultantRefreshState(params){_ocState=params.state;if('chat_watch'in params){_chatWatch=params.chat_watch;}
switch(params.state){case'offline':_consultant_initialized&&_onOfflineState(params);break;case'online':_consultant_initialized&&_onOnlineState(params);break;case'in_chat':_consultant_initialized&&_onInChatState(params);break;case'invite':_consultant_initialized&&_onInviteState(params);break;case'lead':_consultant_initialized&&_onLeadState(params);}}
function _onDisablePhoneReplacement(params){_phoneReplacer.embedDefault();_phoneReplacer.setEnabled({phone_replacement_enabled:false});}
function _onEnablePhoneReplacement(params){_phoneReplacer.setEnabled({phone_replacement_enabled:true});_setPhonesFromCookies();}
function _onShowLeadRequest(params){self.openLeadRequestPanel(params);}
function _onHideLeadRequest(params){self.closeLeadRequestPanel();}
function _onEnableRetention(params){self.enableRetentionPanel(params);}
function _onDisableRetention(params){self.disableRetentionPanel(params);}
function _onEnableComagic(params){_isEnabled=true;_onEnablePhoneReplacement();!_consultant_initialized&&_initConsultant(_bannerParams);}
function _onDisableComagic(params){_isEnabled=false;_onDisablePhoneReplacement();_banner.show(false);_banner.destroy();_consultant_initialized=false;_visitorInsiteSended=false;}
function _onShowPopupMessage(params){_banner.showPopupMessage(params);}
function _onShowPopupNotification(params){_banner.showPopupNotification(params.code);}
function _onSitephoneCallResult(params){_banner.onSitePhoneCallResult(params.result);}
function _onWriteNotify(params){_banner.onComagicWriteNotify();}
function _onChatWatch(params){_chatWatch=params['enabled'];}
function _onOperatorRate(rating){self.onOperatorRate(rating);}
function _onChatTyping(){self.onChatTyping();}
function _onChatRetentionBtnClick(){_sendMessage('close_chat');}
function _sendConsultantPresence(){if(!_visitorInsiteSended){_sendMessage('visitor_insite',{visitor_key:_getVisitorCookie().key,site_key:_siteKey});_visitorInsiteSended=true;}}
function _onOperatorReject(params){_banner.setOperator(' ',null,' ',false);}
function _onUpdateOperator(params){_banner.setFileTransferEnable(params.operator.is_file_transfer_avaiable);}
function _onShowChatRetentionAction(params){_banner.getCmp('consultant').getConsultantLogCmp().showChatRetentionAction(params.communication_way)}
function _onInitConsultant(params){if(_comagicWebUrl){params.comagic_web_url=_comagicWebUrl;}else{_comagicWebUrl=params.comagic_web_url;}
_bannerParams=params;_isEnabled&&!_consultant_initialized&&_initConsultant(params);}
function _initConsultant(params){if(ComagicCaptcha){self.Captcha=new ComagicCaptcha(params.comagic_web_url+params.api_path);}
if(ComagicBanner){params.comagic_obj=self;_banner=new ComagicBanner(params);_banner.onVisitorInfoSubmit=_onBannerFormSubmit;_banner.onInviteReject=_onBannerInviteReject;_banner.onChatOpen=_onBannerChatOpen;_banner.onChatClose=_onBannerChatClose;_banner.onChatPopup=_onBannerChatPopup;_banner.onShow=_onBannerShow;_banner.onActivate=_onBannerActivate;_banner.onExpand=_onBannerExpand;_banner.onSitePhoneStartCall=_onBannerSitePhoneStartCall;_banner.onSiteRequestSubmit=_onBannerSiteRequestSubmit;_banner.onSitePhoneOpen=_onBannerSitePhoneOpen;_banner.onLeadRequestSubmit=_onLeadRequestSubmit;_banner.onLeadRequestCancel=_onLeadRequestCancel;_banner.onRetentionSubmit=_onRetentionSubmit;_banner.onRetentionCancel=_onRetentionCancel;_banner.onConsultantSubmit=_onConsultantSubmit;_banner.onSendChatByEmail=_onSendChatByEmail;_banner.onConsultantTextAreaChange=_onCurrentMessage;_banner.onOperatorRate=_onOperatorRate;_banner.onChatTyping=_onChatTyping;_banner.onChatRetentionBtnClick=_onChatRetentionBtnClick;_consultant_initialized=true;_debug&&(self.banner=_banner);_banner.loadHistory(params['messages']);params.operator&&_banner.setOperator(params.operator.operator_name,params.operator.avatar,params.operator.operator_position,params.operator.is_file_transfer_available);_sendConsultantPresence();}
else{setTimeout(function(){_initConsultant(params);},100);}}
this.setDynamicalReplacement=function(v){if(_isDynamicalReplacementEnabled!=v){_isDynamicalReplacementEnabled=!!v;if(_isDynamicalReplacementEnabled){_mutationObserver&&_mutationObserver.start();}else{_mutationObserver&&_mutationObserver.stop();}}};this.setWebUrl=function(webUrl){_comagicWebUrl=webUrl;_onReady();};this.getOperatorStatus=function(){return _operatorStatus;};this.setAccount=function(key){_setAccount(key);};this.trackEvent=function(category,action,name,value){_sendMessage('track_event',{site_key:_siteKey,visitor_key:_getVisitorCookie().key,session_key:_getSessionCookie().key,category:category,action:action,name:name,value:value});};this.trackSysEvent=function(params){_sendMessage('track_system_event',{site_key:_siteKey,visitor_key:_getVisitorCookie().key,session_key:_getSessionCookie().key,params:params});};this.setProperty=function(name,value){_sendMessage('set_property',{name:name,value:value});};this.remoteTraceback=function(e){var seen=[];_sendMessage('remote_traceback',{site_key:_siteKey,err:JSON.stringify(e.message,function(key,val){if(typeof val=='object'){if(Util.arrayIndexOf(seen,val)>=0)
return undefined;seen.push(val);}
return val;})})};this.getCaptchaUrl=function(key){if(key==undefined){var chars='0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz'.split('');key='';for(var i=0;i<64;i++){key+=chars[Math.floor(Math.random()*chars.length)];}}
return[key,_comagicWebUrl+'captcha/?key='+key]};this.openChatWindow=function(){if(_operatorStatus){_consultant_initialized&&_onBannerChatOpen({});}else{_consultant_initialized&&_openSiteRequestPanel();}};this.openSitePhonePanel=function(){_consultant_initialized&&_openSitePhonePanel();};this.openSiteRequestPanel=function(){_consultant_initialized&&_openSiteRequestPanel();};this.openLeadRequestPanel=function(params){_consultant_initialized&&_openLeadRequestPanel(params);};this.closeLeadRequestPanel=function(){_consultant_initialized&&_closeLeadRequestPanel();};this.isRetentionDisabled=false;this.trackMouseForShowRetention=function(retentionParams){var lastDate=null,lastY=null,lastV=null,isRetentionShowed=false,aMin=350;var onMouseMove=function(e){if(isRetentionShowed||this.isRetentionDisabled){$('body').unbind('mousemove',onMouseMove);return;}
var y=e.screenY,windowHeight=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0;if(y>windowHeight*2/3||lastY!==null&&y>=lastY){lastDate=null;lastY=null;lastV=null;return;}
if(lastDate===null){lastDate=+new Date;lastY=y;return;}
var date=+new Date,dateDelta=date-lastDate;if(dateDelta<5){return;}
var moveLength=Math.abs(y-lastY),v=moveLength/dateDelta,vDelta=v-lastV,a=vDelta/dateDelta;if(a*1000>aMin){_openRetentionPanel(retentionParams);isRetentionShowed=true;}
lastDate=date;lastY=y;lastV=v;};$('body').bind('mousemove',onMouseMove);};this.enableRetentionPanel=function(params){if(_consultant_initialized){this.isRetentionDisabled=false;params.is_show_on_close?this.trackMouseForShowRetention(params):_openRetentionPanel(params);}};this.disableRetentionPanel=function(params){this.isRetentionDisabled=true;};this.openFormPanel=function(){};this.onOperatorStatusChange=function(isActive){};this.setDebug=function(debugMode){try{if(debugMode===undefined){debugMode=Util.getUrlQuery()._comagic_set_debug!==undefined?Util.getUrlQuery()._comagic_set_debug:Util.getUrlHash()._comagic_set_debug!==undefined?Util.getUrlHash()._comagic_set_debug:_getComagicCookie('_comagic_debug');}
if(debugMode!==undefined){_debug=Util.arrayIndexOf([1,true,'true','1'],debugMode)!=-1;_debug&&_setComagicCookie('_comagic_debug',_debug,-1);}}catch(e){_debug&&console.log(e);}};this.sitePhoneCall=function(params,callback){_sitePhoneStartCall(params,callback);};this.onChatMessageSend=function(params){_updateSessionCookie();_sendMessage('message',params);};this.onChatClose=function(){_sendMessage('close_chat');_onChatClose();};this.onSendChatByMail=function(params){_sendMessage('send_chat_by_mail',params);};this.onOperatorRate=function(rating){_sendMessage('set_operator_rating',{rating:rating,comment:null});};this.onChatTyping=function(){_sendMessage('write_notify');};this.getOCState=function(){return _ocState;};this.getTimeDelta=function(){return _timeDelta;};this.onCurrentMessageSend=function(msg){_chatWatch&&_sendMessage('current_message',{'message':msg});};this.getProperty=function(name,callback){_sendMessage('get_property',{name:name},callback);};this.hasProperty=function(name,callback){_sendMessage('has_property',{name:name},callback);};this.deleteProperty=function(name){_sendMessage('delete_property',{name:name});};this.addOfflineRequest=function(req,callback){if(req.name||req.email||req.phone||req.message){_sendOfflineRequest(req,true,callback);}};this.getUploadUrl=function(callback){_sendMessage('get_upload_url',{},callback);};this.getDTPhones=function(){return _dt.phones;};this.getPhones=function(){return comagicStorage.getItem('_cmg_phones');};function init(){cm_$(document).ready(function(){_mutationObserver=new Observer();_isDynamicalReplacementEnabled&&_mutationObserver.start();});_checkQueue();setInterval(_checkQueue,1000);UA.detect();var _onbeforeunload=window.onbeforeunload;window.onbeforeunload=function(){try{_conn.onclose=null;_conn.readyState===SockJS.OPEN&&_conn.close();_onbeforeunload&&_onbeforeunload();}catch(e){}};}
this.banner=undefined;init();},window.Comagic,window.__cs);}catch(e){console.log(e);}
(function(g,namespace){var __cs=g['__cs'],_$=__cs?__cs.$:g.$,C={ATTR_COMAGIC_TOOLTIP:'title',ATTR_COMAGIC_TOOLTIP_RICH:'original-title',ATTR_COMAGIC_CTYPE:'comagic-type',ATTR_UNSELECTABLE:'unselectable',ATTRS_SPECIAL:['tag','renderTo','text','children','cls','defaults','ctype'],BASE_ZINDEX:10,CTYPE_DELIMITER:'--',CSS_SELECTOR_PREFIX:'comagic-',CSS_FIELD_ERROR:'field-error',CSS_FIELD_CONTAINER_ERROR:'field-container-error',CSS_ELEMENT_MASK:'element-mask',CSS_ELEMENT_MASK_FIXED:'element-mask-fixed',CSS_ELEMENT_MASKED:'element-masked',CSS_UNSELECTABLE:'unselectable',CSS_CONSULTANT_INPUT:'input-area',CSS_IE_LT_10:'ie-lt-10',CSS_IE_LT_9:'ie-lt-9',CSS_IE_LT_8:'ie-lt-8',CW_CONSULTANT:'consultant',CW_SITE_PHONE:'site_phone',CW_SITE_REQUEST:'site_request',CW_VISITOR_INFO_REQUEST:'visitor_info_request',CW_LEAD_REQUEST:'lead_request',CW_LEAD_REQUEST_PREVIEW:'lead_request_preview',CW_CONSULTANT_PREVIEW:'consultant_preview',CW_RETENTION:'retention',DURATION_INPUT_CMP_ANIMATION:50,IS_IE_LT_11:!!Function('/*@cc_on return true@*/')(),IS_IE_LT_10:!window.navigator.msPointerEnabled&&!!Function('/*@cc_on return true@*/')(),IS_IE_LT_9:!g.document.addEventListener,IS_IE_LT_8:!g.document.querySelector,IS_TOUCH_DEVICE:/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(navigator.userAgent||navigator.vendor||window.opera)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test((navigator.userAgent||navigator.vendor||window.opera).substr(0,4)),RE_EMAIL:/^(\w+)([\-+.][\w]+)*@(\w[\-\w]*\.){1,5}([A-Za-z]){2,6}$/,RE_HREF:/(^|\s)((?:http|https|ftp):\/\/(?:[^:]+:[^@]+@)?)([^\s]+)+/mgi,TPL_CSS_LINK:'{comagic_web_url}static/comagic/banner/resources/css/{banner_skin}-{banner_color}.css',TPL_CSS_LINK_DEBUG:'{url}{banner_skin}-{banner_color}.css',TPL_HREF:'$1<a href="$2$3">$3</a>',SRC_IMG_BLANK:'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7',VALID_FILE_EXTENSIONS:['png','xpm','jpg','doc','docx','txt','xls','xlsx','csv','odt','ods','pdf','djvu','xml','fb2','epub'],ZZZZZZ:'ZZZZZZ'},u={_$:_$,log:function(){var args=[].concat(arguments);args.unshift('[ComagicBanner]');this.__debug&&g.console&&console.log.apply&&console.log.apply(console,args);},error:function(){var args=[].concat(arguments);args.unshift('[ComagicBanner]');this.__debug&&console.error.apply(console,args);},getDebugParam:function(name){var dp=this.__debugparams;if(!name||(name=='encodejson'&&_$.isPlainObject(dp))){return name=='encodejson'?JSON.stringify(dp):dp;}
return _$.isPlainObject(dp)&&dp[name]||'';},ensure$:function(el){return el instanceof _$?el:_$(el);},maskElement:function(el,isPositionFixed){el=this.ensure$(el);var maskEl=el.find('.'+this.getCssSelector(this.C.CSS_ELEMENT_MASK,true));if(maskEl.length){return maskEl;}
if(el.css('position')=='static'){el.addClass(this.getCssSelector(this.C.CSS_ELEMENT_MASKED,true));}
maskEl=new uLiB.el.Div({cls:this.C.CSS_ELEMENT_MASK,renderTo:el});maskEl.css('z-index',this.comagicTopZIndex());if(isPositionFixed){maskEl.addClass(this.getCssSelector(this.C.CSS_ELEMENT_MASK_FIXED,true));}
return maskEl;},unmaskElement:function(el){el=this.ensure$(el);var maskEl=el.find('.'+this.getCssSelector(this.C.CSS_ELEMENT_MASK,true));if(!maskEl.length){return;}
maskEl.remove();el.removeClass(this.getCssSelector(this.C.CSS_ELEMENT_MASKED,true));},zoomElement:function(el){el=el?this.ensure$(el):_$('body');el.css({zoom:window.innerWidth<window.innerHeight?window.innerWidth/480:window.innerHeight/640});},getCssSelector:function(selector,autoPrefix,isClassSelector){selector=selector.replace(/_/g,'-');selector=selector.replace(/\s{2,}/g,' ');var parts=selector.split(' '),ret=[],part;while(part=parts.shift()){if(u.arrayIsContain(['>','*'],part)){ret.push(part);continue;}
if(isClassSelector===true&&part.indexOf('.')!==0){part='.'+part;}
if(part.indexOf('.')===0){part=part.replace('.',('.'+this.C.CSS_SELECTOR_PREFIX));}else if(autoPrefix&&part.indexOf(this.C.CSS_SELECTOR_PREFIX)!=0){part=this.C.CSS_SELECTOR_PREFIX+part;}
ret.push(part);}
return ret.join(' ');},elementHeight:function(el){if(!el||el===window){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0;}
el=this.ensure$(el);return el.height();},elementWidth:function(el){if(!el){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth||0;}
el=this.ensure$(el);return el.width();},appendCssSelector:function(selector){var args=Array.prototype.slice.call(arguments,1),parts=[];if(this._$.type(selector)==='object'&&selector['class']){args=args.concat(selector['class'].split(' '));}
for(var i=0,a;(a=args[i]);i++){parts.push(a);}
if(this._$.type(selector)==='string'){parts.unshift(selector);return this.getCssSelector(parts.join(' '),true);}else if(this._$.type(selector)==='object'){selector['class']=this.getCssSelector(parts.join(' '),true);return selector;}},addCls:function(el,cls,options){return el.addClass(this.getCssSelector(cls,true),options);},removeCls:function(el,cls,options){if(this._$.type(cls)==='array'){for(var i=0,c;(c=cls[i]);i++){this.removeCls(el,c);}}else{return el.removeClass(this.getCssSelector(cls,true),options);}},topZIndex:function(selector,filterFn){var a=((selector||'*')==='*')?u._$.makeArray(document.getElementsByTagName('*')):u._$(selector);if(_$.type(filterFn)==='function'){a=_$.grep(a,filterFn);}
return Math.max(0,Math.max.apply(null,_$.map(a,function(v){var zIndex=parseFloat(_$(v).css('z-index'));return zIndex===2147483647||!zIndex?null:zIndex;})));},zIndexFilterFn:function(el){return el.style&&el.style.position!=='static';},comagicTopZIndex:function(){var zIndex=this.topZIndex('*',this.zIndexFilterFn);return zIndex>10000?zIndex:10000;},getZIndex:function(offset){offset=offset||0;return this.C.BASE_ZINDEX+(+offset);},getZIndexStr:function(offset){return''+this.getZIndex(offset);},addCssLink:function(o){var cssLink=o.css_url?o.css_url:this.sformat(this.C.TPL_CSS_LINK,o),debugCssUrl=this.getDebugParam('cssurl');if(debugCssUrl){if(this.endsWith(debugCssUrl,'.css')){cssLink=debugCssUrl+'?'+Math.floor((Math.random()*100)+1);}else{cssLink=this.sformat(this.C.TPL_CSS_LINK_DEBUG,this.apply({url:debugCssUrl},o));}}
_$('<link/>').attr('rel','stylesheet').attr('id','comagic-banner-stylesheet').attr('type','text/css').attr('href',cssLink).appendTo(o.iframe?o.iframe.find('head'):'head')},jfind:function(rootEl,selector){return rootEl.find(this.getCssSelector(selector,true,true));},jhasClass:function(el,cls){return el.hasClass(this.getCssSelector(cls,true));},camelize:function(str){return str.replace(/(?:^|[-_])(\w)/g,function(_,c){return c?c.toUpperCase():'';})},sformat:function(tpl,params){var s=arguments[0],o=arguments[1],regex;if(_$.type(o)=='object'){var field,fields={},value;regex=/{([^}]+)}/g;while(field=regex.exec(s)){field=field[1];value=o[field];if(value===undefined){continue;}
if(field=='cls'||this.endsWith(field,'Cls')){value=this.getCssSelector(value,true);}
fields[field]=value;}
for(var k in fields){if(!fields.hasOwnProperty(k)){continue;}
regex=new RegExp('\\{'+k+'\\}','gm');s=s.replace(regex,fields[k]);}}else{for(var i=0;i<arguments.length-1;i++){regex=new RegExp('\\{'+i+'\\}','gm');s=s.replace(regex,arguments[i+1]);}}
return s;},endsWith:function(str,suffix){return str.indexOf(suffix,str.length-suffix.length)!=-1;},startsWith:function(str,prefix){if(_$.type(prefix)=='array'){for(var i=0,p;(p=prefix[i]);i++){if(this.startsWith(str,p)){return true;}}
return false;}else{return str.indexOf(prefix)==0;}},stripTags:function(str){return str.replace(/(<([^>]+)>)/ig,"");},textLinksToHtml:function(str){return(''+str).replace(this.C.RE_HREF,this.C.TPL_HREF);},crLfToBr:function(str){return str.replace(/\n\r/g,'<br/>').replace(/\r\n/g,'<br/>').replace(/\n/g,'<br/>').replace(/\r/g,'<br/>');},brToCrLf:function(str){return str.replace('/<br/>/g','\n');},strim:function(str){str=''+str;return str.replace(/\s/g,'');},dformat:function(date){var d=date.getDate(),m=date.getMonth()+1,y=date.getFullYear();return''+y+'-'+(m<=9?'0'+m:m)+'-'+(d<=9?'0'+d:d);},tformat:function(date){date=date||new Date();var hours=date.getHours(),minutes=date.getMinutes();hours<10&&(hours="0"+hours);minutes<10&&(minutes="0"+minutes);return hours+':'+minutes;},dApplyTimeDelta:function(date,timeDelta){timeDelta=timeDelta||0;date=date.split(/(?:\s|T)/);date[0]=date[0].split('.');date[1]=date[1].split(':');date=new Date(date[0][2],date[0][1],date[0][0],date[1][0],date[1][1],date[1][2]);date.setTime(date.getTime()-timeDelta*1000);return date;},dnow:function(){return+new Date();},dGetTimeDelta:function(){return this.timeDelta;},dSetTimeDelta:function(delta){this.timeDelta=delta;},arrayIndexOf:function(array,obj,start){for(var i=(start||0),j=array.length;i<j;i++){if(array[i]===obj){return i;}}
return-1;},arrayIsContain:function(array,item){if(this._$.type(item)==='array'){for(var i=0,ii;(ii=item[i]);i++){if(this.arrayIsContain(array,ii)){return true;}}
return false;}else{return this.arrayIndexOf(array,item)!==-1;}},inArray:function(item,array){return this.arrayIndexOf(array,item);},copyArgs:function(args){return Array.prototype.slice.apply(args);},bind:function(func,scope){return function(){return func.apply(scope,arguments);};},wrapEvent:function(wrapper,func,scope){return function(){var args=wrapper.apply(scope,arguments);if(args){return func.apply(scope,args);}
return null;};},extend:function(Child,Parent){if(this._$.type(Parent)==='string'){Parent=this.getObjByName(Parent);}
var F=function(){};F.prototype=Parent.prototype;Child.prototype=new F();Child.prototype.constructor=Child;Child.superclass=Parent.prototype;},mixIn:function(target,source,properties,name){var args=Array.prototype.slice.apply(arguments);target=args.shift();source=args.shift();properties=this._$.type(args[0])==='array'?args[0]:args;if(this._$.type(source)==='string'){source=this.getObjByName(source);}
if(this._$.type(properties)==='string'){name=properties;properties=undefined;}
if(!name){name=source.name;}
if(!source){throw'Cannot mix-in from undefined source';}
if(!target){throw'Cannot mix-in to undefined target';}
if(!target.prototype.hasOwnProperty('mixins')){var mixins=target.prototype.mixins;target.prototype.mixins={};if(mixins){for(var k in mixins){target.prototype.mixins[k]=mixins[k];}}}
source=this._$.type(source)==='function'?source.prototype:source;if(name){target.prototype.mixins[name]=source;}
if(properties.length){for(var i=0,p;(p=properties[i]);i++){target.prototype[p]=this._$.type(source)==='function'?source.prototype[p]:source[p];}}else{for(var p in source){target.prototype[p]=source[p];}}},isinstance:function(obj,classes){if(this._$.type(classes)!=='array'){classes=[classes];}
for(var i=0,c;(c=classes[i]);i++){if(this._$.type(c)==='string'){c=this.getObjByName(c);}
if(obj instanceof c){return true;}
var mixins=obj.mixins;if(mixins){for(var j=0,m;(m=mixins[j]);j++){if(obj instanceof m){return true;}}}}
return false;},getFunctionName:function(fn){var ret=fn.toString();ret=ret.substr('function '.length);ret=ret.substr(0,ret.indexOf('('));return ret;},ensureFunctionName:function(fn){if(!fn.name){fn.name=this.getFunctionName(fn);}},apply:function(object,config,defaults){if(defaults){this.apply(object,defaults);}
if(object&&config&&typeof config==='object'){var i,j,k;for(i in config){object[i]=config[i];}}
return object;},applyIf:function(object,defaults){for(var k in defaults){if(defaults.hasOwnProperty(k)&&object[k]===undefined){object[k]=defaults[k];}}
return object;},ns:function(ns,global){var root=global||g;var parts=ns.split('.');for(var i=0,p;(p=parts[i]);i++){root=(root[p]=root[p]||{});}
return root;},getObjByName:function(str){var root=g;var parts=str.split('.'),pparts=[];for(var i=0,p;(p=parts[i]);i++){if(!root[p]){this.error('Property',p,'of',pparts.join('.'),'is not an Object');return null;}
root=root[p];pparts.push(p);}
return root;},getURLParameter:function(name){return decodeURI(((new RegExp(name+'='+'(.+?)(&|$)')).exec(g.location.search)||[,''])[1]);},getHashParameter:function(name){return decodeURI(((new RegExp(name+'='+'(.+?)(&|$)')).exec(g.location.hash)||[,''])[1]);},clone:function(o){if(!o||'object'!==typeof o){return o;}
var c='function'===typeof o.pop?[]:{};var p,v;for(p in o){if(o.hasOwnProperty(p)){v=o[p];if(v&&'object'===typeof v){c[p]=this.clone(v);}else{c[p]=v;}}}
return c;},isInstance:function(obj,className){if(this._$.type(className)==='string'){className=this.getObjByName(className);}
return obj instanceof className;},getCTypeOf:function(el,suffix){suffix=suffix||'';el=this.isInstance(el,'uLiB.cmp.Component')?el.getEl():el;el=this.ensure$(el);var ctype=el.attr(this.C.ATTR_COMAGIC_CTYPE)||'',parent=el.parent(),ret=ctype&&suffix?[ctype,suffix].join(this.C.CTYPE_DELIMITER):(ctype||suffix);if(!parent.length){return ret;}else{return this.getCTypeOf(parent,ret);}},okeys:function(o){var ret=[];for(var k in o){if(o.hasOwnProperty(k)){ret.push(k);}}
return ret;},ovalues:function(o){var ret=[];for(var k in o){if(o.hasOwnProperty(k)){ret.push(o[k]);}}},opop:function(o,prop){var ret=o[prop];delete o[prop];return ret;},storageEnabled:function(){return _$.ezstorage.enabled();},storageGet:function(key){return _$.ezstorage.get(key);},storageSet:function(key,val,isPersist){return _$.ezstorage.set(key,val,{persist:typeof isPersist!=='undefined'?isPersist:true});},label:function(text){text=text||'-------------------------------';return new uLiB.el.TestLabel({text:text});},hereDoc:function(f){return f.toString().replace(/^[^\/]+\/\*!?/,'').replace(/\*\/[^\/]+$/,'');},isParentWindowOpen:function(){return!!window.opener&&!window.opener.closed;},buildUrl:function(url){url=url||'';if(u.startsWith(url,['http://','https://','ftp://','//'])){return url;}
if(u.startsWith(url,'/')){return this['comagic_web_url']+url;}
return'';},hasConnectWayEnabled:function(o,way){if(u._$.type(o)==='string'){way=o;o=this;}
var key='available_connect_ways',acws=o[key];return!!acws&&u.arrayIsContain(acws,way);},isMsSkin:function(o){return u.arrayIndexOf(['main','simple','touch'],(o||this)['banner_skin'])!=-1;},maybeCall:function(obj,fn,scope,args){if(u._$.type(obj)==='function'){fn=obj;}
if(u._$.type(fn)==='object'){scope=fn;}
if(u._$.type(fn)==='string'&&u._$.type(obj)==='object'){fn=obj[fn];}
if(scope===undefined&&u._$.type(obj)==='object'){scope=obj;}
if(u._$.type(fn)==='array'){args=fn;}
if(u._$.type(scope)==='array'){args=scope;}
if(u._$.type(fn)==='function'){return fn.apply(scope||this,args||[]);}
return null;},init:function(){this.__debugparams=this.getURLParameter('bannerdebug');this.__debug=(!__cs||__cs.__debug===undefined)?!!this.__debugparams:__cs.__debug;this.__debugger=this.getURLParameter('bannerdebug')==2;try{this.__debugparams=JSON.parse(this.__debugparams);}catch(e){this.log('Cannot parse debug params. Going to plain debug mode.')}
this.C.BASE_ZINDEX=this.comagicTopZIndex()+1;var timeDelta=this.getURLParameter('time_delta');timeDelta!==''&&this.dSetTimeDelta(timeDelta);}};u.apply(u,{C:C});u.init();u.apply(u.ns(namespace,g),u);})(window,'uLiB.util');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$,$=_$;(function($){var pluses=/\+/g;function encode(s){return config.raw?s:encodeURIComponent(s);}
function decode(s){return config.raw?s:decodeURIComponent(s);}
function stringifyCookieValue(value){return encode(config.json?JSON.stringify(value):String(value));}
function parseCookieValue(s){if(s.indexOf('"')===0){s=s.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,'\\');}
try{s=decodeURIComponent(s.replace(pluses,' '));return config.json?JSON.parse(s):s;}catch(e){}}
function read(s,converter){var value=config.raw?s:parseCookieValue(s);return $.isFunction(converter)?converter(value):value;}
var config=$.cookie=function(key,value,options){if(value!==undefined&&!$.isFunction(value)){options=$.extend({},config.defaults,options);if(typeof options.expires==='number'){var days=options.expires,t=options.expires=new Date();t.setTime(+t+days*864e+5);}
return(document.cookie=[encode(key),'=',stringifyCookieValue(value),options.expires?'; expires='+options.expires.toUTCString():'',options.path?'; path='+options.path:'',options.domain?'; domain='+options.domain:'',options.secure?'; secure':''].join(''));}
var result=key?undefined:{};var cookies=document.cookie?document.cookie.split('; '):[];for(var i=0,l=cookies.length;i<l;i++){var parts=cookies[i].split('=');var name=decode(parts.shift());var cookie=parts.join('=');if(key&&key===name){result=read(cookie,value);break;}
if(!key&&(cookie=read(cookie))!==undefined){result[name]=cookie;}}
return result;};config.defaults={};$.removeCookie=function(key,options){if($.cookie(key)===undefined){return false;}
$.cookie(key,'',$.extend({},options,{expires:-1}));return!$.cookie(key);};})(_$);})(window,'uLiB.jplugin');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$,$=_$;$('document').ready(function(){var JSON={parse:window.JSON&&(window.JSON.parse||window.JSON.decode)||String.prototype.evalJSON&&function(str){return String(str).evalJSON();}||$.parseJSON||$.evalJSON,stringify:Object.toJSON||window.JSON&&(window.JSON.stringify||window.JSON.encode)||$.toJSON};if(!('parse'in JSON)||!('stringify'in JSON)){$.getScript('http://cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js',function(){console.log('EZStorage: loaded JSON library dynamically');});}
if(typeof($.cookie)==='undefined'){$.getScript('https://raw.github.com/carhartl/jquery-cookie/master/jquery.cookie.js',function(){console.log('EZStorage: loaded jQuery.cookie library dynamically');});}});var ezs=$.ezstorage=function EZStorage(action,key,value,options){options=$.extend({},ezs.settings,options);if(options.expires){if(options.expires instanceof Date){}
else if(typeof options.expires==='number'){options.expires=new Date(new Date().setTime(new Date().getTime()+((options.expires*24)*60*60*1000)));}
else{try{options.expires=new Date(options.expires);}catch(err){delete options.expires;}}}
switch(action){case'enabled':if(typeof(Storage)!=="undefined"){return true;}
else{$.cookie('ezstorage_cookies_enabled','enabled',{path:'/'});if($.cookie('ezstorage_cookies_enabled')){$.removeCookie('ezstorage_cookies_enabled',{path:'/'});return true;}}
return false;break;case'get':if(typeof(Storage)!=="undefined"){var item=localStorage.getItem(key);if(item){try{item=JSON.parse(item);}catch(err){return item;}
if(!item.ezstorage){return item;}
if(item.expires&&new Date(item.expires)<new Date()){localStorage.removeItem(key);return null;}
return(options.full)?item:item.value;}
else{item=sessionStorage.getItem(key);if(item){try{return JSON.parse(item);}catch(err){return item;}}}}
return $.cookie(key);break;case'set':var v=JSON.stringify(value);if(typeof(Storage)!=="undefined"){if(options.expires||options.persist){v=JSON.stringify($.extend({},{value:value},options));localStorage.setItem(key,v);}
else{sessionStorage.setItem(key,v);}}
else{$.cookie(key,v,options)}
return v;break;case'remove':if(typeof(Storage)!=="undefined"){localStorage.removeItem(key);sessionStorage.removeItem(key);}
$.removeCookie(key,options);return true;break;default:break;}
return null;};$.extend(ezs,{enabled:function(){return this('enabled');},get:function(key,options){return this('get',key,null,options);},set:function(key,value,options){return this('set',key,value,options);},remove:function(key,options){return this('remove',key,null,options);},defaultSettings:function(){this.settings={ezstorage:true,path:'/'};},settings:{ezstorage:true,path:'/'}});})(window,'uLiB.jplugin');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$;_$.fn.fileupload=function(options){var settings={action:'',onSubmit:function(fileName){},onReceive:function(response){},onUsupportedFileExtension:function(currentExtension,validExtensions){},validExtensions:undefined};if(options){_$.extend(settings,options)}
return this.each(function(){var input=_$(this);if(!input.data('fileupload-initialized')){var frameId='fileupload-iframe-'+input.attr('id'),iframe='<iframe width="0" height="0" style="display:none" name="'+frameId+'" id="'+frameId+'" />',form='<form action="'+settings.action+'" method="POST" enctype="multipart/form-data" target="'+frameId+'" style="margin:0;padding:0" />';input.wrap(form);_$('body').after(iframe);_$('#'+frameId).load(function(){var response,responseStr;try{responseStr=this.contentWindow.document.body.textContent;try{response=JSON.parse(responseStr);}catch(e){response=responseStr;}
this.contentWindow.document.body.innerHtml='';}catch(e){}
settings.onReceive.apply(input,[response]);input.data('fileupload-busy',false)});input.change(function(){if(input.data('fileupload-busy')!==true){var file=input.val();if(file){var extension=file.split('.').pop().toLowerCase();var isExtensionValid=!settings.validExtensions||_$.inArray(extension,settings.validExtensions)>=0;if(isExtensionValid){settings.onSubmit.apply(input,[file]);input.data('fileupload-busy',true);input.parents('form:first').submit(function(e){e.stopPropagation()}).submit()
input.val('');}else{settings.onUnsupportedFileExtension.apply(input,[extension,settings.validExtensions.join(", ")])}}}});input.data('fileupload-initialized',true)}})};})(window,'uLiB.jplugin');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$;_$.fn.center=function(target,direction,monitorResize){direction=direction||'hv';target=target||window;var offset=_$(target).offset(),top=offset?offset.top:0,left=offset?offset.left:0;if(this.css('position')!=='fixed'){this.css('position','absolute');}
if(direction.indexOf('v')!=-1){var h=u.elementHeight(target===window?null:target);this.css('top',Math.max(0,((h-_$(this).outerHeight())/2)+
(this.css('position')=='fixed'?0:_$(target).scrollTop()))+
top+'px');}
if(direction.indexOf('h')!=-1){var w=u.elementWidth(target===window?null:target);this.css('left',Math.max(0,((w-_$(this).outerWidth())/2)+
(this.css('position')=='fixed'?0:_$(target).scrollLeft()))+
left+'px');}
var me=this;if(monitorResize){_$(window).resize(function(){_$(me).center(target,direction,false);});}
return this;};})(window,'uLiB.');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$;_$.fn.anchor=function(target,anchor,monitorScrollAndResize,offset){var me=this;if(u._$.type(monitorScrollAndResize)==='object'){offset=monitorScrollAndResize;}
if(!offset){offset={};}
if(!offset.x){offset.x=0;}
if(!offset.y){offset.y=0;}
function doAnchor(){var parts=anchor.split('-'),_$target=_$(target),_$this=_$(me),targetPos=_$target.offset(),bodyOffset,bodyPosition=_$('body').css('position'),x=0,y=0;if(parts[0].indexOf('b')!=-1){y+=_$target.outerHeight();}
if(parts[0].indexOf('r')!=-1){x+=_$target.outerWidth();}
if(parts[1].indexOf('b')!=-1){y-=_$this.outerHeight();}
if(parts[1].indexOf('r')!=-1){x-=_$this.outerWidth();}
y=targetPos.top+y+offset.y;x=targetPos.left+x+offset.x;if(bodyPosition!=='static'){bodyOffset=_$('body').offset();y-=bodyOffset.top;x-=bodyOffset.left;}
_$(me).css({top:y+'px',left:x+'px'});}
doAnchor();if(monitorScrollAndResize){_$(g).scroll(doAnchor).resize(doAnchor);}
return _$(this);};})(window,'uLiB.');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$,$=_$,jQuery=_$;jQuery.fn.extend({slimScroll:function(options){var defaults={width:'auto',height:'250px',size:'7px',color:'#000',position:'right',distance:'1px',start:'top',opacity:.4,alwaysVisible:false,disableFadeOut:false,railVisible:false,railColor:'#333',railOpacity:.2,railDraggable:true,railClass:'slimScrollRail',barClass:'slimScrollBar',wrapperClass:'slimScrollDiv',allowPageScroll:false,wheelStep:20,touchScrollStep:200,borderRadius:'7px',railBorderRadius:'7px'};var o=$.extend(defaults,options);this.each(function(){var isOverPanel,isOverBar,isDragg,queueHide,touchDif,barHeight,percentScroll,lastScroll,divS='<div></div>',minBarHeight=30,releaseScroll=false;var me=$(this);if(me.parent().hasClass(o.wrapperClass)){var offset=me.scrollTop();bar=me.parent().find('.'+o.barClass);rail=me.parent().find('.'+o.railClass);getBarHeight();if($.isPlainObject(options)){if('height'in options&&options.height=='auto'){me.parent().css('height','auto');me.css('height','auto');var height=me.parent().parent().height();me.parent().css('height',height);me.css('height',height);}
if('scrollTo'in options){offset=parseInt(o.scrollTo);}
else if('scrollBy'in options){offset+=parseInt(o.scrollBy);}
else if('destroy'in options){bar.remove();rail.remove();me.unwrap();return;}
scrollContent(offset,false,true);}
return;}
o.height=(options.height=='auto')?me.parent().actual('height'):options.height;var wrapper=$(divS).addClass(o.wrapperClass).css({position:'relative',overflow:'hidden',width:o.width,height:o.height});me.css({overflow:'hidden',height:o.height});if(me.css('display')==='block'){me.css({width:o.width});}
var rail=$(divS).addClass(o.railClass).css({width:o.size,height:'100%',position:'absolute',top:0,display:(o.alwaysVisible&&o.railVisible)?'block':'none','border-radius':o.railBorderRadius,background:o.railColor,opacity:o.railOpacity,zIndex:90});var bar=$(divS).addClass(o.barClass).css({background:o.color,width:o.size,position:'absolute',top:0,opacity:o.opacity,display:o.alwaysVisible?'block':'none','border-radius':o.borderRadius,BorderRadius:o.borderRadius,MozBorderRadius:o.borderRadius,WebkitBorderRadius:o.borderRadius,zIndex:99});var posCss=(o.position=='right')?{right:o.distance}:{left:o.distance};rail.css(posCss);bar.css(posCss);me.wrap(wrapper);me.parent().append(bar);me.parent().append(rail);if(o.railDraggable){bar.bind("mousedown",function(e){var $doc=$(document);isDragg=true;var t=parseFloat(bar.css('top'));var pageY=e.pageY;$doc.bind("mousemove.slimscroll",function(e){var currTop=t+e.pageY-pageY;bar.css('top',currTop);scrollContent(0,bar.position().top,false);});$doc.bind("mouseup.slimscroll",function(e){isDragg=false;hideBar();$doc.unbind('.slimscroll');});return false;}).bind("selectstart.slimscroll",function(e){e.stopPropagation();e.preventDefault();return false;});}
rail.hover(function(){showBar();},function(){hideBar();});bar.hover(function(){isOverBar=true;},function(){isOverBar=false;});me.hover(function(){isOverPanel=true;showBar();hideBar();},function(){isOverPanel=false;hideBar();});me.bind('touchstart',function(e,b){if(e.originalEvent.touches.length){touchDif=e.originalEvent.touches[0].pageY;}});me.bind('touchmove',function(e){if(!releaseScroll){e.originalEvent.preventDefault();}
if(e.originalEvent.touches.length){var diff=(touchDif-e.originalEvent.touches[0].pageY)/o.touchScrollStep;scrollContent(diff,true);touchDif=e.originalEvent.touches[0].pageY;}});getBarHeight();if(o.start==='bottom'){bar.css({top:me.outerHeight()-bar.outerHeight()});scrollContent(0,true);}
else if(o.start!=='top'){scrollContent($(o.start).position().top,null,true);if(!o.alwaysVisible){bar.hide();}}
attachWheel();function _onWheel(e){if(!isOverPanel){return;}
var e=e||g.event;var delta=0;if(e.wheelDelta){delta=-e.wheelDelta/120;}
if(e.detail){delta=e.detail/3;}
var target=e.target||e.srcTarget||e.srcElement;if($(target).closest('.'+o.wrapperClass).is(me.parent())){scrollContent(delta,true);}
if(e.preventDefault&&!releaseScroll){e.preventDefault();}
if(!releaseScroll){e.returnValue=false;}}
function scrollContent(y,isWheel,isJump){releaseScroll=false;var delta=y;var maxTop=me.outerHeight()-bar.outerHeight();if(isWheel){delta=parseInt(bar.css('top'))+y*parseInt(o.wheelStep)/100*bar.outerHeight();delta=Math.min(Math.max(delta,0),maxTop);delta=(y>0)?Math.ceil(delta):Math.floor(delta);bar.css({top:delta+'px'});}
percentScroll=parseInt(bar.css('top'))/(me.outerHeight()-bar.outerHeight());delta=percentScroll*(me[0].scrollHeight-me.outerHeight());if(isJump){delta=y;var offsetTop=delta/me[0].scrollHeight*me.outerHeight();offsetTop=Math.min(Math.max(offsetTop,0),maxTop);bar.css({top:offsetTop+'px'});}
me.scrollTop(delta);me.trigger('slimscrolling',~~delta);showBar();hideBar();}
function attachWheel(){if(g.addEventListener){this.addEventListener('DOMMouseScroll',_onWheel,false);this.addEventListener('mousewheel',_onWheel,false);}
else{document.attachEvent("onmousewheel",_onWheel)}}
function getTopAndBottomBorderWidth(){return parseInt(me.css('border-top-width'),10)
+parseInt(me.css('border-top-width'),10);}
function getBarHeight(){var scrollHeight=me[0].scrollHeight;if(scrollHeight){barHeight=Math.max((me.outerHeight()/(scrollHeight+getTopAndBottomBorderWidth()))*me.outerHeight(),minBarHeight);bar.css({height:barHeight+'px'});}
var display=barHeight==me.outerHeight()?'none':'block';bar.css({display:display});}
function showBar(){getBarHeight();clearTimeout(queueHide);if(percentScroll==~~percentScroll){releaseScroll=o.allowPageScroll;if(lastScroll!=percentScroll){var msg=(~~percentScroll==0)?'top':'bottom';me.trigger('slimscroll',msg);}}
else{releaseScroll=false;}
lastScroll=percentScroll;if(barHeight>=me.outerHeight()){releaseScroll=true;return;}
bar.stop(true,true).fadeIn('fast');if(o.railVisible){rail.stop(true,true).fadeIn('fast');}}
function hideBar(){if(!o.alwaysVisible){queueHide=setTimeout(function(){if(!(o.disableFadeOut&&isOverPanel)&&!isOverBar&&!isDragg){bar.fadeOut('slow');rail.fadeOut('slow');}},1000);}}});return this;}});jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll});})(window,'uLiB.jplugin');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$;(function($,g){var
dataFlag="watermark",dataClass="watermarkClass",dataFocus="watermarkFocus",dataFormSubmit="watermarkSubmit",dataMaxLen="watermarkMaxLength",dataPassword="watermarkPassword",dataText="watermarkText",rreturn=/\r/g,rInvalidType=/^(button|checkbox|hidden|image|radio|range|reset|submit)$/i,selWatermarkDefined="input:data("+dataFlag+"),textarea:data("+dataFlag+")",selWatermarkAble=":watermarkable",triggerFns=["Page_ClientValidate"],pageDirty=false,hasNativePlaceholder=("placeholder"in document.createElement("input"));$.watermark=$.watermark||{version:"3.1.4",runOnce:true,options:{className:"watermark",useNative:true,hideBeforeUnload:true},hide:function(selector){$(selector).filter(selWatermarkDefined).each(function(){$.watermark._hide($(this));});},_hide:function($input,focus){var elem=$input[0],inputVal=(elem.value||"").replace(rreturn,""),inputWm=$input.data(dataText)||"",maxLen=$input.data(dataMaxLen)||0,className=$input.data(dataClass);if((inputWm.length)&&(inputVal==inputWm)){elem.value="";if($input.data(dataPassword)){if(($input.attr("type")||"")==="text"){var $pwd=$input.data(dataPassword)||[],$wrap=$input.parent()||[];if(($pwd.length)&&($wrap.length)){$wrap[0].removeChild($input[0]);$wrap[0].appendChild($pwd[0]);$input=$pwd;}}}
if(maxLen){$input.attr("maxLength",maxLen);$input.removeData(dataMaxLen);}
if(focus){$input.attr("autocomplete","off");window.setTimeout(function(){$input.select();},1);}}
className&&$input.removeClass(className);},show:function(selector){$(selector).filter(selWatermarkDefined).each(function(){$.watermark._show($(this));});},_show:function($input){var elem=$input[0],val=(elem.value||"").replace(rreturn,""),text=$input.data(dataText)||"",type=$input.attr("type")||"",className=$input.data(dataClass);if(((val.length==0)||(val==text))&&(!$input.data(dataFocus))){pageDirty=true;if($input.data(dataPassword)){if(type==="password"){var $pwd=$input.data(dataPassword)||[],$wrap=$input.parent()||[];if(($pwd.length)&&($wrap.length)){$wrap[0].removeChild($input[0]);$wrap[0].appendChild($pwd[0]);$input=$pwd;$input.attr("maxLength",text.length);elem=$input[0];}}}
if((type==="text")||(type==="search")){var maxLen=$input.attr("maxLength")||0;if((maxLen>0)&&(text.length>maxLen)){$input.data(dataMaxLen,maxLen);$input.attr("maxLength",text.length);}}
className&&$input.addClass(className);elem.value=text;}
else{$.watermark._hide($input);}},hideAll:function(){if(pageDirty){$.watermark.hide(selWatermarkAble);pageDirty=false;}},showAll:function(){$.watermark.show(selWatermarkAble);}};$.fn.watermark=$.fn.watermark||function(text,options){if(!this.length){return this;}
var hasClass=false,hasText=(typeof(text)==="string");if(hasText){text=text.replace(rreturn,"");}
if(typeof(options)==="object"){hasClass=(typeof(options.className)==="string");options=$.extend({},$.watermark.options,options);}
else if(typeof(options)==="string"){hasClass=true;options=$.extend({},$.watermark.options,{className:options});}
else{options=$.watermark.options;}
if(typeof(options.useNative)!=="function"){options.useNative=options.useNative?function(){return true;}:function(){return false;};}
return this.each(function(){var $input=$(this);if(!$input.is(selWatermarkAble)){return;}
if($input.data(dataFlag)){if(hasText||hasClass){$.watermark._hide($input);if(hasText){$input.data(dataText,text);}
if(hasClass){$input.data(dataClass,options.className);}}}
else{if((hasNativePlaceholder)&&(options.useNative.call(this,$input))&&(($input.attr("tagName")||"")!=="TEXTAREA")){if(hasText){$input.attr("placeholder",text);}
return;}
$input.data(dataText,hasText?text:"");$input.data(dataClass,options.className);$input.data(dataFlag,1);if(($input.attr("type")||"")==="password"){var $wrap=$input.wrap("<span>").parent(),$wm=$($wrap.html().replace(/type=["']?password["']?/i,'type="text"'));$wm.data(dataText,$input.data(dataText));$wm.data(dataClass,$input.data(dataClass));$wm.data(dataFlag,1);$wm.attr("maxLength",text.length);$wm.focus(function(){$.watermark._hide($wm,true);}).bind("dragenter",function(){$.watermark._hide($wm);}).bind("dragend",function(){window.setTimeout(function(){$wm.blur();},1);});$input.blur(function(){$.watermark._show($input);}).bind("dragleave",function(){$.watermark._show($input);});$wm.data(dataPassword,$input);$input.data(dataPassword,$wm);}
else{$input.focus(function(){$input.data(dataFocus,1);$.watermark._hide($input,true);}).blur(function(){$input.data(dataFocus,0);$.watermark._show($input);}).bind("dragenter",function(){$.watermark._hide($input);}).bind("dragleave",function(){$.watermark._show($input);}).bind("dragend",function(){window.setTimeout(function(){$.watermark._show($input);},1);}).bind("drop",function(evt){var elem=$input[0],dropText=evt.originalEvent.dataTransfer.getData("Text");if((elem.value||"").replace(rreturn,"").replace(dropText,"")===$input.data(dataText)){elem.value=dropText;}
$input.focus();});}
if(this.form){var form=this.form,$form=$(form);if(!$form.data(dataFormSubmit)){$form.submit($.watermark.hideAll);if(form.submit){$form.data(dataFormSubmit,form.submit);form.submit=(function(f,$f){return function(){var nativeSubmit=$f.data(dataFormSubmit);$.watermark.hideAll();if(nativeSubmit.apply){nativeSubmit.apply(f,Array.prototype.slice.call(arguments));}
else{nativeSubmit();}};})(form,$form);}
else{$form.data(dataFormSubmit,1);form.submit=(function(f){return function(){$.watermark.hideAll();delete f.submit;f.submit();};})(form);}}}}
$.watermark._show($input);});};if($.watermark.runOnce){$.watermark.runOnce=false;$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return!!$.data(elem,dataName);};}):function(elem,i,match){return!!$.data(elem,match[3]);},watermarkable:function(elem){var type,name=elem.nodeName;if(name==="TEXTAREA"){return true;}
if(name!=="INPUT"){return false;}
type=elem.getAttribute("type");return((!type)||(!rInvalidType.test(type)));}});(function(valOld){$.fn.val=function(){var args=Array.prototype.slice.call(arguments);if(!this.length){return args.length?this:undefined;}
if(!args.length){if(this.data(dataFlag)){var v=(this[0].value||"").replace(rreturn,"");return(v===(this.data(dataText)||""))?"":v;}
else{return valOld.apply(this);}}
else{valOld.apply(this,args);$.watermark.show(this);return this;}};})($.fn.val);if(triggerFns.length){$(function(){var i,name,fn;for(i=triggerFns.length-1;i>=0;i--){name=triggerFns[i];fn=window[name];if(typeof(fn)==="function"){window[name]=(function(origFn){return function(){$.watermark.hideAll();return origFn.apply(null,Array.prototype.slice.call(arguments));};})(fn);}}});}
$(window).bind("beforeunload",function(){if($.watermark.options.hideBeforeUnload){$.watermark.hideAll();}});}})(_$);})(window,'uLiB.');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$;(function($){$.fn.resizecrop=function(options){var defaults={width:50,height:50,vertical:"center",horizontal:"center",wrapper:"span",moveClass:true,moveId:true,className:"resizecrop",zoom:true,wrapperCreated:false,wrapperCSS:{}};var options=$.extend(defaults,options);return this.each(function(){var $obj=$(this);$obj.css("display","none");$obj.width("auto").height("auto");if(!options.wrapperCreated){var wrapper=$(document.createElement(options.wrapper)).css({width:options.width,height:options.height,overflow:"hidden",display:"inline-block","vertical-align":"middle","position":"relative"}).css(options.wrapperCSS);if(options.moveClass){var classAttr=$obj.attr("class");if(typeof classAttr!=='undefined'&&classAttr!==false&&classAttr!==""){var classList=classAttr.split(/\s+/);$.each(classList,function(index,className){wrapper.addClass(className);});$obj.removeAttr("class");$obj.addClass(options.className);}}
if(options.moveId){var idName=$obj.attr("id");if(typeof idName!=="undefined"&&idName!==false&&idName!==""){$obj.removeAttr("id");wrapper.attr("id",idName);}}
$obj.wrap(wrapper);}
function transform(ref){realWidth=ref[0].width;realHeight=ref[0].height;width_ratio=options.width/realWidth;height_ratio=options.height/realHeight;if(width_ratio>height_ratio){if(options.zoom||width_ratio<1){ref.width(options.width);realHeight=width_ratio*realHeight;}
switch(options.vertical){case"top":ref.css("top",0);break;case"bottom":ref.css("bottom",0);break;case"center":default:ref.css("top",((realHeight-options.height)/-2)+"px");}
if(options.zoom||width_ratio<1)
ref.css("left",0);else
ref.css("left",((realWidth-options.width)/-2)+"px");}else{if(options.zoom||height_ratio<1){ref.height(options.height);realWidth=height_ratio*realWidth;}
switch(options.horizontal){case"left":ref.css("left",0);break;case"right":ref.css("right",0);break;case"center":default:ref.css("left",((realWidth-options.width)/-2)+"px");}
if(options.zoom||height_ratio<1)
ref.css("top",0);else
ref.css("top",((realHeight-options.height)/-2)+"px");}
ref.css({position:"relative",display:"block"});}
if(this.complete){transform($obj);}else{$obj.load(function(){transform($(this));});}});};$.fn.cropresize=$.fn.resizecrop;})(_$);})(window,'uLiB.jplugin');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$,$=_$;var CSL_NAME_PREFIX='tipsy';function getCssClass(s,isSelector){var cls=[];if(s){var parts=s.split(' ');if(parts.length>1){s=parts;}
if(_$.type(s)=='array'){for(var i=0,p;(p=parts[i]);i++){parts[i]=getCssClass(p);}
s=parts.join(' ');}else{cls.push(CSL_NAME_PREFIX);}
cls.push(s);}else{cls.push(CSL_NAME_PREFIX);}
cls=cls.join('-');if(isSelector){cls='.'+cls;}
return u.getCssSelector(cls,true);}
function maybeCall(thing,ctx){return(typeof thing=='function')?(thing.call(ctx)):thing;}
function isElementInDOM(ele){while(ele=ele.parentNode){if(ele==document)return true;}
return false;}
function Tipsy(element,options){this.$element=$(element);this.options=options;this.enabled=true;this.fixTitle();}
Tipsy.prototype={show:function(){var title=this.getTitle();if(title&&this.enabled){var $tip=this.tip();$tip.find(getCssClass('inner',true))[this.options.html?'html':'text'](title);$tip[0].className=getCssClass();$tip.remove().css({top:0,left:0,visibility:'hidden',display:'block'}).prependTo(document.body);var pos=$.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight});var actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight,gravity=maybeCall(this.options.gravity,this.$element[0]);var tp;switch(gravity.charAt(0)){case'n':tp={top:this.options.offsetV+pos.top+pos.height+this.options.offset,left:pos.left+pos.width/2-actualWidth/2};break;case's':tp={top:this.options.offsetV+pos.top-actualHeight-this.options.offset,left:this.options.offsetH+pos.left+pos.width/2-actualWidth/2};break;case'e':tp={top:this.options.offsetV+pos.top+pos.height/2-actualHeight/2,left:this.options.offsetH+pos.left-actualWidth-this.options.offset};break;case'w':tp={top:this.options.offsetV+pos.top+pos.height/2-actualHeight/2,left:this.options.offsetH+pos.left+pos.width+this.options.offset};break;}
if(gravity.length==2){if(gravity.charAt(1)=='w'){tp.left=this.options.offsetH+pos.left+pos.width/2-15;}else{tp.left=this.options.offsetH+pos.left+pos.width/2-actualWidth+15;}}
if($('body').css('position')!=='static'){var bodyOffset=_$('body').offset();tp.left-=bodyOffset.left;tp.top-=bodyOffset.top;}
$tip.css(tp).addClass(getCssClass(gravity));$tip.find(getCssClass('arrow',true))[0].className=getCssClass('arrow arrow-'+gravity.charAt(0));if(this.options.className){$tip.addClass(maybeCall(this.options.className,this.$element[0]));}
if(this.options.fade){$tip.stop().css({opacity:0,display:'block',visibility:'visible',zIndex:u.getZIndexStr(10)}).animate({opacity:this.options.opacity});}else{$tip.css({visibility:'visible',opacity:this.options.opacity,zIndex:u.getZIndexStr(10)});}}},hide:function(){if(this.options.fade){this.tip().stop().fadeOut(function(){$(this).remove();});}else{this.tip().remove();}},fixTitle:function(){var $e=this.$element;if($e.attr('title')||typeof($e.attr('original-title'))!='string'){$e.attr('original-title',$e.attr('title')||'').removeAttr('title');}},getTitle:function(){var title,$e=this.$element,o=this.options;this.fixTitle();var title,o=this.options;if(typeof o.title=='string'){title=$e.attr(o.title=='title'?'original-title':o.title);}else if(typeof o.title=='function'){title=o.title.call($e[0]);}
title=(''+title).replace(/(^\s*|\s*$)/,"");return title||o.fallback;},tip:function(){if(!this.$tip){this.$tip=$(u.sformat('<div class="{0}"></div>',getCssClass())).html(u.sformat('<div class="{0}"></div><div class="{1}"></div>',getCssClass('arrow'),getCssClass('inner')));this.$tip.data('tipsy-pointee',this.$element[0]);}
return this.$tip;},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null;}},enable:function(){this.enabled=true;},disable:function(){this.enabled=false;},toggleEnabled:function(){this.enabled=!this.enabled;}};$.fn.tipsy=function(options){if(options===true){return this.data('tipsy');}else if(typeof options=='string'){var tipsy=this.data('tipsy');if(tipsy)tipsy[options]();return this;}
options=$.extend({},$.fn.tipsy.defaults,options);function get(ele){var tipsy=$.data(ele,'tipsy');if(!tipsy){tipsy=new Tipsy(ele,$.fn.tipsy.elementOptions(ele,options));$.data(ele,'tipsy',tipsy);}
return tipsy;}
function enter(){var tipsy=get(this);tipsy.hoverState='in';if(options.delayIn==0){tipsy.show();}else{tipsy.fixTitle();setTimeout(function(){if(tipsy.hoverState=='in')tipsy.show();},options.delayIn);}};function leave(){var tipsy=get(this);tipsy.hoverState='out';if(options.delayOut==0){tipsy.hide();}else{setTimeout(function(){if(tipsy.hoverState=='out')tipsy.hide();},options.delayOut);}};if(!options.live)this.each(function(){get(this);});if(options.trigger!='manual'){var binder=options.live?'live':'bind',eventIn=options.trigger=='hover'?'mouseenter':'focus',eventOut=options.trigger=='hover'?'mouseleave':'blur';this[binder](eventIn,enter)[binder](eventOut,leave);}
return this;};$.fn.tipsy.defaults={className:null,delayIn:0,delayOut:0,fade:false,fallback:'',gravity:'n',html:false,live:false,offset:0,opacity:0.8,title:'title',trigger:'hover',offsetH:0,offsetV:0};$.fn.tipsy.revalidate=function(){$(getCssClass(undefined,true)).each(function(){var pointee=$.data(this,'tipsy-pointee');if(!pointee||!isElementInDOM(pointee)){$(this).remove();}});};$.fn.tipsy.elementOptions=function(ele,options){return $.metadata?$.extend({},options,$(ele).metadata()):options;};$.fn.tipsy.autoNS=function(){return $(this).offset().top>($(document).scrollTop()+$(window).height()/2)?'s':'n';};$.fn.tipsy.autoWE=function(){return $(this).offset().left>($(document).scrollLeft()+$(window).width()/2)?'e':'w';};$.fn.tipsy.autoBounds=function(margin,prefer){return function(){var dir={ns:prefer[0],ew:(prefer.length>1?prefer[1]:false)},boundTop=$(document).scrollTop()+margin,boundLeft=$(document).scrollLeft()+margin,$this=$(this);if($this.offset().top<boundTop)dir.ns='n';if($this.offset().left<boundLeft)dir.ew='w';if($(window).width()+$(document).scrollLeft()-$this.offset().left<margin)dir.ew='e';if($(window).height()+$(document).scrollTop()-$this.offset().top<margin)dir.ns='s';return dir.ns+(dir.ew?dir.ew:'');}};})(window,'uLiB.');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$,$=_$;var CLS_TEXTAREA_MIRROR='autogrow-textarea-mirror';$.fn.autogrow=function(options){options=$.extend({},{animation:u.C.ANIMATION_DURATION,maxHeight:0},options);return this.each(function(){var createMirror=function(textarea){$(textarea).after(u.sformat('<div class="{0}"></div>',u.getCssSelector(CLS_TEXTAREA_MIRROR,true)));return $(textarea).next(u.getCssSelector(CLS_TEXTAREA_MIRROR,true,true))[0];};var escapeText=function(text){return(''+text).replace(/&/g,'&amp;').replace(/"/g,'&quot;').replace(/'/g,'&#39;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\n/g,'<br />')+'.';};var sendContentToMirror=function(textarea){mirror.innerHTML=escapeText(textarea.value);var mh=$(mirror).height(),tah=$(textarea).height();if(options.maxHeight&&mh>options.maxHeight){return;}
var callback=function(){options.onHeightSet&&options.onHeightSet(mh,mh-tah,options.animation);};if(tah!=mh){if(options.animation&&!options.disableAnimationOnce){$(textarea).animate({height:mh},options.animation,'swing',callback);}else{if(options.disableAnimationOnce){options.disableAnimationOnce=false;}
$(textarea).height(mh);callback();}}};var growTextarea=function(){sendContentToMirror(this);};var mirror=createMirror(this);mirror.style.display='none';mirror.style.wordWrap='break-word';mirror.style.whiteSpace='normal';mirror.style.padding=$(this).css('padding');mirror.style.width=$(this).css('width');mirror.style.minHeight=$(this).css('minHeight');mirror.style.boxSizing=$(this).css('box-sizing');mirror.style.fontFamily=$(this).css('font-family');mirror.style.fontSize=$(this).css('font-size');mirror.style.lineHeight=$(this).css('line-height');this.style.overflow="hidden";this.onkeyup=growTextarea;sendContentToMirror(this);});};})(window,'uLiB.');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$;(function($){var dataSpace="ui-effects-";$.effects={effect:{}};(function(jQuery,undefined){var stepHooks="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",rplusequals=/^([\-+])=\s*(\d+\.?\d*)/,stringParsers=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[execResult[1],execResult[2],execResult[3],execResult[4]];}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[execResult[1]*2.55,execResult[2]*2.55,execResult[3]*2.55,execResult[4]];}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(execResult){return[parseInt(execResult[1],16),parseInt(execResult[2],16),parseInt(execResult[3],16)];}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(execResult){return[parseInt(execResult[1]+execResult[1],16),parseInt(execResult[2]+execResult[2],16),parseInt(execResult[3]+execResult[3],16)];}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(execResult){return[execResult[1],execResult[2]/100,execResult[3]/100,execResult[4]];}}],color=jQuery.Color=function(color,green,blue,alpha){return new jQuery.Color.fn.parse(color,green,blue,alpha);},spaces={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},propTypes={"byte":{floor:true,max:255},"percent":{max:1},"degrees":{mod:360,floor:true}},support=color.support={},supportElem=jQuery("<p>")[0],colors,each=jQuery.each;supportElem.style.cssText="background-color:rgba(1,1,1,.5)";support.rgba=supportElem.style.backgroundColor.indexOf("rgba")>-1;each(spaces,function(spaceName,space){space.cache="_"+spaceName;space.props.alpha={idx:3,type:"percent",def:1};});function clamp(value,prop,allowEmpty){var type=propTypes[prop.type]||{};if(value==null){return(allowEmpty||!prop.def)?null:prop.def;}
value=type.floor?~~value:parseFloat(value);if(isNaN(value)){return prop.def;}
if(type.mod){return(value+type.mod)%type.mod;}
return 0>value?0:type.max<value?type.max:value;}
function stringParse(string){var inst=color(),rgba=inst._rgba=[];string=string.toLowerCase();each(stringParsers,function(i,parser){var parsed,match=parser.re.exec(string),values=match&&parser.parse(match),spaceName=parser.space||"rgba";if(values){parsed=inst[spaceName](values);inst[spaces[spaceName].cache]=parsed[spaces[spaceName].cache];rgba=inst._rgba=parsed._rgba;return false;}});if(rgba.length){if(rgba.join()==="0,0,0,0"){jQuery.extend(rgba,colors.transparent);}
return inst;}
return colors[string];}
color.fn=jQuery.extend(color.prototype,{parse:function(red,green,blue,alpha){if(red===undefined){this._rgba=[null,null,null,null];return this;}
if(red.jquery||red.nodeType){red=jQuery(red).css(green);green=undefined;}
var inst=this,type=jQuery.type(red),rgba=this._rgba=[];if(green!==undefined){red=[red,green,blue,alpha];type="array";}
if(type==="string"){return this.parse(stringParse(red)||colors._default);}
if(type==="array"){each(spaces.rgba.props,function(key,prop){rgba[prop.idx]=clamp(red[prop.idx],prop);});return this;}
if(type==="object"){if(red instanceof color){each(spaces,function(spaceName,space){if(red[space.cache]){inst[space.cache]=red[space.cache].slice();}});}else{each(spaces,function(spaceName,space){var cache=space.cache;each(space.props,function(key,prop){if(!inst[cache]&&space.to){if(key==="alpha"||red[key]==null){return;}
inst[cache]=space.to(inst._rgba);}
inst[cache][prop.idx]=clamp(red[key],prop,true);});if(inst[cache]&&jQuery.inArray(null,inst[cache].slice(0,3))<0){inst[cache][3]=1;if(space.from){inst._rgba=space.from(inst[cache]);}}});}
return this;}},is:function(compare){var is=color(compare),same=true,inst=this;each(spaces,function(_,space){var localCache,isCache=is[space.cache];if(isCache){localCache=inst[space.cache]||space.to&&space.to(inst._rgba)||[];each(space.props,function(_,prop){if(isCache[prop.idx]!=null){same=(isCache[prop.idx]===localCache[prop.idx]);return same;}});}
return same;});return same;},_space:function(){var used=[],inst=this;each(spaces,function(spaceName,space){if(inst[space.cache]){used.push(spaceName);}});return used.pop();},transition:function(other,distance){var end=color(other),spaceName=end._space(),space=spaces[spaceName],startColor=this.alpha()===0?color("transparent"):this,start=startColor[space.cache]||space.to(startColor._rgba),result=start.slice();end=end[space.cache];each(space.props,function(key,prop){var index=prop.idx,startValue=start[index],endValue=end[index],type=propTypes[prop.type]||{};if(endValue===null){return;}
if(startValue===null){result[index]=endValue;}else{if(type.mod){if(endValue-startValue>type.mod/2){startValue+=type.mod;}else if(startValue-endValue>type.mod/2){startValue-=type.mod;}}
result[index]=clamp((endValue-startValue)*distance+startValue,prop);}});return this[spaceName](result);},blend:function(opaque){if(this._rgba[3]===1){return this;}
var rgb=this._rgba.slice(),a=rgb.pop(),blend=color(opaque)._rgba;return color(jQuery.map(rgb,function(v,i){return(1-a)*blend[i]+a*v;}));},toRgbaString:function(){var prefix="rgba(",rgba=jQuery.map(this._rgba,function(v,i){return v==null?(i>2?1:0):v;});if(rgba[3]===1){rgba.pop();prefix="rgb(";}
return prefix+rgba.join()+")";},toHslaString:function(){var prefix="hsla(",hsla=jQuery.map(this.hsla(),function(v,i){if(v==null){v=i>2?1:0;}
if(i&&i<3){v=Math.round(v*100)+"%";}
return v;});if(hsla[3]===1){hsla.pop();prefix="hsl(";}
return prefix+hsla.join()+")";},toHexString:function(includeAlpha){var rgba=this._rgba.slice(),alpha=rgba.pop();if(includeAlpha){rgba.push(~~(alpha*255));}
return"#"+jQuery.map(rgba,function(v){v=(v||0).toString(16);return v.length===1?"0"+v:v;}).join("");},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString();}});color.fn.parse.prototype=color.fn;function hue2rgb(p,q,h){h=(h+1)%1;if(h*6<1){return p+(q-p)*h*6;}
if(h*2<1){return q;}
if(h*3<2){return p+(q-p)*((2/3)-h)*6;}
return p;}
spaces.hsla.to=function(rgba){if(rgba[0]==null||rgba[1]==null||rgba[2]==null){return[null,null,null,rgba[3]];}
var r=rgba[0]/255,g=rgba[1]/255,b=rgba[2]/255,a=rgba[3],max=Math.max(r,g,b),min=Math.min(r,g,b),diff=max-min,add=max+min,l=add*0.5,h,s;if(min===max){h=0;}else if(r===max){h=(60*(g-b)/diff)+360;}else if(g===max){h=(60*(b-r)/diff)+120;}else{h=(60*(r-g)/diff)+240;}
if(diff===0){s=0;}else if(l<=0.5){s=diff/add;}else{s=diff/(2-add);}
return[Math.round(h)%360,s,l,a==null?1:a];};spaces.hsla.from=function(hsla){if(hsla[0]==null||hsla[1]==null||hsla[2]==null){return[null,null,null,hsla[3]];}
var h=hsla[0]/360,s=hsla[1],l=hsla[2],a=hsla[3],q=l<=0.5?l*(1+s):l+s-l*s,p=2*l-q;return[Math.round(hue2rgb(p,q,h+(1/3))*255),Math.round(hue2rgb(p,q,h)*255),Math.round(hue2rgb(p,q,h-(1/3))*255),a];};each(spaces,function(spaceName,space){var props=space.props,cache=space.cache,to=space.to,from=space.from;color.fn[spaceName]=function(value){if(to&&!this[cache]){this[cache]=to(this._rgba);}
if(value===undefined){return this[cache].slice();}
var ret,type=jQuery.type(value),arr=(type==="array"||type==="object")?value:arguments,local=this[cache].slice();each(props,function(key,prop){var val=arr[type==="object"?key:prop.idx];if(val==null){val=local[prop.idx];}
local[prop.idx]=clamp(val,prop);});if(from){ret=color(from(local));ret[cache]=local;return ret;}else{return color(local);}};each(props,function(key,prop){if(color.fn[key]){return;}
color.fn[key]=function(value){var vtype=jQuery.type(value),fn=(key==="alpha"?(this._hsla?"hsla":"rgba"):spaceName),local=this[fn](),cur=local[prop.idx],match;if(vtype==="undefined"){return cur;}
if(vtype==="function"){value=value.call(this,cur);vtype=jQuery.type(value);}
if(value==null&&prop.empty){return this;}
if(vtype==="string"){match=rplusequals.exec(value);if(match){value=cur+parseFloat(match[2])*(match[1]==="+"?1:-1);}}
local[prop.idx]=value;return this[fn](local);};});});color.hook=function(hook){var hooks=hook.split(" ");each(hooks,function(i,hook){jQuery.cssHooks[hook]={set:function(elem,value){var parsed,curElem,backgroundColor="";if(value!=="transparent"&&(jQuery.type(value)!=="string"||(parsed=stringParse(value)))){value=color(parsed||value);if(!support.rgba&&value._rgba[3]!==1){curElem=hook==="backgroundColor"?elem.parentNode:elem;while((backgroundColor===""||backgroundColor==="transparent")&&curElem&&curElem.style){try{backgroundColor=jQuery.css(curElem,"backgroundColor");curElem=curElem.parentNode;}catch(e){}}
value=value.blend(backgroundColor&&backgroundColor!=="transparent"?backgroundColor:"_default");}
value=value.toRgbaString();}
try{elem.style[hook]=value;}catch(e){}}};jQuery.fx.step[hook]=function(fx){if(!fx.colorInit){fx.start=color(fx.elem,hook);fx.end=color(fx.end);fx.colorInit=true;}
jQuery.cssHooks[hook].set(fx.elem,fx.start.transition(fx.end,fx.pos));};});};color.hook(stepHooks);jQuery.cssHooks.borderColor={expand:function(value){var expanded={};each(["Top","Right","Bottom","Left"],function(i,part){expanded["border"+part+"Color"]=value;});return expanded;}};colors=jQuery.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"};})($);(function(){var classAnimationActions=["add","remove","toggle"],shorthandStyles={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};$.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(_,prop){$.fx.step[prop]=function(fx){if(fx.end!=="none"&&!fx.setAttr||fx.pos===1&&!fx.setAttr){jQuery.style(fx.elem,prop,fx.end);fx.setAttr=true;}};});function getElementStyles(elem){var key,len,style=elem.ownerDocument.defaultView?elem.ownerDocument.defaultView.getComputedStyle(elem,null):elem.currentStyle,styles={};if(style&&style.length&&style[0]&&style[style[0]]){len=style.length;while(len--){key=style[len];if(typeof style[key]==="string"){styles[$.camelCase(key)]=style[key];}}}else{for(key in style){if(typeof style[key]==="string"){styles[key]=style[key];}}}
return styles;}
function styleDifference(oldStyle,newStyle){var diff={},name,value;for(name in newStyle){value=newStyle[name];if(oldStyle[name]!==value){if(!shorthandStyles[name]){if($.fx.step[name]||!isNaN(parseFloat(value))){diff[name]=value;}}}}
return diff;}
if(!$.fn.addBack){$.fn.addBack=function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector));};}
$.effects.animateClass=function(value,duration,easing,callback){var o=$.speed(duration,easing,callback);return this.queue(function(){var animated=$(this),baseClass=animated.attr("class")||"",applyClassChange,allAnimations=o.children?animated.find("*").addBack():animated;allAnimations=allAnimations.map(function(){var el=$(this);return{el:el,start:getElementStyles(this)};});applyClassChange=function(){$.each(classAnimationActions,function(i,action){if(value[action]){animated[action+"Class"](value[action]);}});};applyClassChange();allAnimations=allAnimations.map(function(){this.end=getElementStyles(this.el[0]);this.diff=styleDifference(this.start,this.end);return this;});animated.attr("class",baseClass);allAnimations=allAnimations.map(function(){var styleInfo=this,dfd=$.Deferred(),opts=$.extend({},o,{queue:false,complete:function(){dfd.resolve(styleInfo);}});this.el.animate(this.diff,opts);return dfd.promise();});$.when.apply($,allAnimations.get()).done(function(){applyClassChange();$.each(arguments,function(){var el=this.el;$.each(this.diff,function(key){el.css(key,"");});});o.complete.call(animated[0]);});});};$.fn.extend({addClass:(function(orig){return function(classNames,speed,easing,callback){return speed?$.effects.animateClass.call(this,{add:classNames},speed,easing,callback):orig.apply(this,arguments);};})($.fn.addClass),removeClass:(function(orig){return function(classNames,speed,easing,callback){return arguments.length>1?$.effects.animateClass.call(this,{remove:classNames},speed,easing,callback):orig.apply(this,arguments);};})($.fn.removeClass),toggleClass:(function(orig){return function(classNames,force,speed,easing,callback){if(typeof force==="boolean"||force===undefined){if(!speed){return orig.apply(this,arguments);}else{return $.effects.animateClass.call(this,(force?{add:classNames}:{remove:classNames}),speed,easing,callback);}}else{return $.effects.animateClass.call(this,{toggle:classNames},force,speed,easing);}};})($.fn.toggleClass),switchClass:function(remove,add,speed,easing,callback){return $.effects.animateClass.call(this,{add:add,remove:remove},speed,easing,callback);}});})();(function(){$.extend($.effects,{version:"@VERSION",save:function(element,set){for(var i=0;i<set.length;i++){if(set[i]!==null){element.data(dataSpace+set[i],element[0].style[set[i]]);}}},restore:function(element,set){var val,i;for(i=0;i<set.length;i++){if(set[i]!==null){val=element.data(dataSpace+set[i]);if(val===undefined){val="";}
element.css(set[i],val);}}},setMode:function(el,mode){if(mode==="toggle"){mode=el.is(":hidden")?"show":"hide";}
return mode;},getBaseline:function(origin,original){var y,x;switch(origin[0]){case"top":y=0;break;case"middle":y=0.5;break;case"bottom":y=1;break;default:y=origin[0]/original.height;}
switch(origin[1]){case"left":x=0;break;case"center":x=0.5;break;case"right":x=1;break;default:x=origin[1]/original.width;}
return{x:x,y:y};},createWrapper:function(element){if(element.parent().is(".ui-effects-wrapper")){return element.parent();}
var props={width:element.outerWidth(true),height:element.outerHeight(true),"float":element.css("float")},wrapper=$("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),size={width:element.width(),height:element.height()},active=document.activeElement;try{active.id;}catch(e){active=document.body;}
element.wrap(wrapper);if(element[0]===active||$.contains(element[0],active)){$(active).focus();}
wrapper=element.parent();if(element.css("position")==="static"){wrapper.css({position:"relative"});element.css({position:"relative"});}else{$.extend(props,{position:element.css("position"),zIndex:element.css("z-index")});$.each(["top","left","bottom","right"],function(i,pos){props[pos]=element.css(pos);if(isNaN(parseInt(props[pos],10))){props[pos]="auto";}});element.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"});}
element.css(size);return wrapper.css(props).show();},removeWrapper:function(element){var active=document.activeElement;if(element.parent().is(".ui-effects-wrapper")){element.parent().replaceWith(element);if(element[0]===active||$.contains(element[0],active)){$(active).focus();}}
return element;},setTransition:function(element,list,factor,value){value=value||{};$.each(list,function(i,x){var unit=element.cssUnit(x);if(unit[0]>0){value[x]=unit[0]*factor+unit[1];}});return value;}});function _normalizeArguments(effect,options,speed,callback){if($.isPlainObject(effect)){options=effect;effect=effect.effect;}
effect={effect:effect};if(options==null){options={};}
if($.isFunction(options)){callback=options;speed=null;options={};}
if(typeof options==="number"||$.fx.speeds[options]){callback=speed;speed=options;options={};}
if($.isFunction(speed)){callback=speed;speed=null;}
if(options){$.extend(effect,options);}
speed=speed||options.duration;effect.duration=$.fx.off?0:typeof speed==="number"?speed:speed in $.fx.speeds?$.fx.speeds[speed]:$.fx.speeds._default;effect.complete=callback||options.complete;return effect;}
function standardAnimationOption(option){if(!option||typeof option==="number"||$.fx.speeds[option]){return true;}
if(typeof option==="string"&&!$.effects.effect[option]){return true;}
if($.isFunction(option)){return true;}
if(typeof option==="object"&&!option.effect){return true;}
return false;}
$.fn.extend({effect:function(){var args=_normalizeArguments.apply(this,arguments),mode=args.mode,queue=args.queue,effectMethod=$.effects.effect[args.effect];if($.fx.off||!effectMethod){if(mode){return this[mode](args.duration,args.complete);}else{return this.each(function(){if(args.complete){args.complete.call(this);}});}}
function run(next){var elem=$(this),complete=args.complete,mode=args.mode;function done(){if($.isFunction(complete)){complete.call(elem[0]);}
if($.isFunction(next)){next();}}
if(elem.is(":hidden")?mode==="hide":mode==="show"){elem[mode]();done();}else{effectMethod.call(elem[0],args,done);}}
return queue===false?this.each(run):this.queue(queue||"fx",run);},show:(function(orig){return function(option){if(standardAnimationOption(option)){return orig.apply(this,arguments);}else{var args=_normalizeArguments.apply(this,arguments);args.mode="show";return this.effect.call(this,args);}};})($.fn.show),hide:(function(orig){return function(option){if(standardAnimationOption(option)){return orig.apply(this,arguments);}else{var args=_normalizeArguments.apply(this,arguments);args.mode="hide";return this.effect.call(this,args);}};})($.fn.hide),toggle:(function(orig){return function(option){if(standardAnimationOption(option)||typeof option==="boolean"){return orig.apply(this,arguments);}else{var args=_normalizeArguments.apply(this,arguments);args.mode="toggle";return this.effect.call(this,args);}};})($.fn.toggle),cssUnit:function(key){var style=this.css(key),val=[];$.each(["em","px","%","pt"],function(i,unit){if(style.indexOf(unit)>0){val=[parseFloat(style),unit];}});return val;}});})();(function(){var baseEasings={};$.each(["Quad","Cubic","Quart","Quint","Expo"],function(i,name){baseEasings[name]=function(p){return Math.pow(p,i+2);};});$.extend(baseEasings,{Sine:function(p){return 1-Math.cos(p*Math.PI/2);},Circ:function(p){return 1-Math.sqrt(1-p*p);},Elastic:function(p){return p===0||p===1?p:-Math.pow(2,8*(p-1))*Math.sin(((p-1)*80-7.5)*Math.PI/15);},Back:function(p){return p*p*(3*p-2);},Bounce:function(p){var pow2,bounce=4;while(p<((pow2=Math.pow(2,--bounce))-1)/11){}
return 1/Math.pow(4,3-bounce)-7.5625*Math.pow((pow2*3-2)/22-p,2);}});$.each(baseEasings,function(name,easeIn){$.easing["easeIn"+name]=easeIn;$.easing["easeOut"+name]=function(p){return 1-easeIn(1-p);};$.easing["easeInOut"+name]=function(p){return p<0.5?easeIn(p*2)/2:1-easeIn(p*-2+2)/2;};});})();return $.effects;})(_$);})(window,'uLiB.');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$;(function($){return $.effects.effect.fade=function(o,done){var el=$(this),mode=$.effects.setMode(el,o.mode||"toggle");el.animate({opacity:mode},{queue:false,duration:o.duration,easing:o.easing,complete:done});};})(_$);})(window,'uLiB.');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$;(function($){return $.effects.effect.slide=function(o,done){var el=$(this),props=["position","top","bottom","left","right","width","height"],mode=$.effects.setMode(el,o.mode||"show"),show=mode==="show",direction=o.direction||"left",ref=(direction==="up"||direction==="down")?"top":"left",positiveMotion=(direction==="up"||direction==="left"),distance,animation={};$.effects.save(el,props);el.show();distance=o.distance||el[ref==="top"?"outerHeight":"outerWidth"](true);$.effects.createWrapper(el).css({overflow:"hidden"});if(show){el.css(ref,positiveMotion?(isNaN(distance)?"-"+distance:-distance):distance);}
animation[ref]=(show?(positiveMotion?"+=":"-="):(positiveMotion?"-=":"+="))+
distance;el.animate(animation,{queue:false,duration:o.duration,easing:o.easing,start:function(obj){o.start&&(obj.tweens[0].start=o.start);},step:function(a,b){o.step&&o.step(a,b);},complete:function(){if(mode==="hide"){el.hide();}
$.effects.restore(el,props);$.effects.removeWrapper(el);done();}});};})(_$);})(window,'uLiB.');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$;(function(factory){if(typeof define==="function"&&define.amd){}else{factory(_$);}}(function($){return $.effects.effect.transfer=function(o,done){var elem=$(this),target=$(o.to),targetFixed=target.css("position")==="fixed",body=$("body"),fixTop=targetFixed?body.scrollTop():0,fixLeft=targetFixed?body.scrollLeft():0,endPosition=target.offset(),animation={top:endPosition.top-fixTop,left:endPosition.left-fixLeft,height:target.innerHeight(),width:target.innerWidth()},startPosition=elem.offset(),transfer=$("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(o.className).css({top:startPosition.top-fixTop,left:startPosition.left-fixLeft,height:elem.innerHeight(),width:elem.innerWidth(),position:targetFixed?"fixed":"absolute"}).animate(animation,o.duration,o.easing,function(){transfer.remove();done();});};}));})(window,'uLiB.');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$;(function($){$.fn.addBack=$.fn.addBack||$.fn.andSelf;$.fn.extend({actual:function(method,options){if(!this[method]){throw'$.actual => The jQuery method "'+method+'" you called does not exist';}
var defaults={absolute:false,clone:false,includeMargin:false};var configs=$.extend(defaults,options);var $target=this.eq(0);var fix,restore;if(configs.clone===true){fix=function(){var style='position: absolute !important; top: -1000 !important; ';$target=$target.clone().attr('style',style).appendTo('body');};restore=function(){$target.remove();};}else{var tmp=[];var style='';var $hidden;fix=function(){$hidden=$target.parents().addBack().filter(':hidden');style+='visibility: hidden !important; display: block !important; ';if(configs.absolute===true)style+='position: absolute !important; ';$hidden.each(function(){var $this=$(this);var thisStyle=$this.attr('style');tmp.push(thisStyle);$this.attr('style',thisStyle?thisStyle+';'+style:style);});};restore=function(){$hidden.each(function(i){var $this=$(this);var _tmp=tmp[i];if(_tmp===undefined){$this.removeAttr('style');}else{$this.attr('style',_tmp);}});};}
fix();var actual=/(outer)/.test(method)?$target[method](configs.includeMargin):$target[method]();restore();return actual;}});})(_$);})(window,'uLiB.');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$,$=_$;(function($){$.fn.getStyleObject=function(){var dom=this.get(0);var style;var returns={};if(window.getComputedStyle){var camelize=function(a,b){return b.toUpperCase();};style=window.getComputedStyle(dom,null);for(var i=0,l=style.length;i<l;i++){var prop=style[i];var camel=prop.replace(/\-([a-z])/g,camelize);var val=style.getPropertyValue(prop);returns[camel]=val;};return returns;};if(style=dom.currentStyle){for(var prop in style){returns[prop]=style[prop];};return returns;};return this.css();}})($);$.fn.copyCss=function(source){var styles=$(source).getStyleObject();this.css(styles);}})(window,'uLiB.');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$;(function($){var $win=$(window);var $doc=$(document.documentElement);var noop=$.noop||function(){};$.fn.dragon=function(opts){initDragonEls(this,opts||{});return this;};$.fn.dragonDisable=function(){this.data('isDragonEnabled',false);return this;};$.fn.dragonEnable=function(){this.data('isDragonEnabled',true);return this;};$.extend($.fn.dragon,{'AXIS_X':'x','AXIS_Y':'y'});var ZERO_OUT_RIGHT_AND_BOTTOM={right:'',bottom:''};function initDragonEls($els,opts){var cursorType='move';opts.axis=opts.axis||{};$els.addClass('dragon');$els.attr('draggable','true');$els.on('dragstart',preventDefault);if(!opts.noCursor){if(opts.axis==='x'){cursorType='ew-resize';}else if(opts.axis==='y'){cursorType='ns-resize';}
if(opts.handle){$els.find(opts.handle).css('cursor',cursorType);}else{$els.css('cursor',cursorType);}}
$els.each(function(i,el){var $el=$(el);var position=$el.position();var top=position.top;var left=position.left;$el.data('isDragonEnabled',true);$el.css({'top':top,'left':left}).data('dragon',{}).data('dragon-opts',opts);$el.on('touchend',$.proxy(onTouchEnd,$el));$el.on('touchmove',$.proxy(onTouchMove,$el));var handle=opts.handle;if(handle){var $handle=typeof handle==='string'?$el.find(handle):handle;$handle.on('mousedown',$.proxy(onMouseDown,$el));$handle.on('touchstart',$.proxy(onTouchStart,$el));}else{$el.on('mousedown',$.proxy(onMouseDown,$el));$el.on('touchstart',$.proxy(onTouchStart,$el));}});}
function onMouseDown(evt){var data=this.data('dragon');if(data.isDragging||!this.data('isDragonEnabled')){return;}
var onMouseUpInstance=$.proxy(onMouseUp,this);var onMouseMoveInstance=$.proxy(onMouseMove,this);var initialOffset=this.offset();this.data('dragon',{'onMouseUp':onMouseUpInstance,'onMouseMove':onMouseMoveInstance,'isDragging':true,'left':initialOffset.left,'top':initialOffset.top,'grabPointX':initialOffset.left-evt.pageX,'grabPointY':initialOffset.top-evt.pageY});$doc.on('mouseup',onMouseUpInstance).on('blur',onMouseUpInstance).on('mousemove',onMouseMoveInstance);$win.on('blur',onMouseUpInstance);$doc.on('selectstart',preventSelect);fire('dragStart',this,evt);}
function onTouchStart(evt){evt.preventDefault();var data=this.data('dragon');if(data.isDragging||!this.data('isDragonEnabled')){return;}
var onTouchEndInstance=$.proxy(onTouchEnd,this);var onTouchMoveInstance=$.proxy(onTouchMove,this);var initialOffset=this.offset();this.data('dragon',{'onTouchEnd':onTouchEndInstance,'onTouchMove':onTouchMoveInstance,'isDragging':true,'left':initialOffset.left,'top':initialOffset.top,'grabPointX':initialOffset.left-evt.originalEvent.pageX,'grabPointY':initialOffset.top-evt.originalEvent.pageY});$doc.on('touchend',onTouchEndInstance).on('blur',onTouchEndInstance).on('touchmove',onTouchMoveInstance);$win.on('blur',onTouchEndInstance);$doc.on('selectstart',preventSelect);fire('dragStart',this,evt);}
function onMouseUp(evt){onDragEnd(this,evt,false);}
function onTouchEnd(evt){evt.preventDefault();onDragEnd(this,evt,true);}
function onDragEnd($el,evt,isTouch){var data=$el.data('dragon');data.isDragging=false;if(isTouch){$doc.off('touchend',data.onTouchEnd).off('blur',data.onTouchEnd).off('touchmove',data.onTouchMove).off('selectstart',preventSelect);$win.off('blur',data.onTouchEnd);delete data.onTouchEnd;delete data.onTouchMove;}else{$doc.off('mouseup',data.onMouseUp).off('blur',data.onMouseUp).off('mousemove',data.onMouseMove).off('selectstart',preventSelect);$win.off('blur',data.onMouseUp);delete data.onMouseUp;delete data.onMouseMove;}
fire('dragEnd',$el,evt);}
function onMouseMove(evt){onMove(this,evt,evt.pageX,evt.pageY);}
function onTouchMove(evt){evt.preventDefault();onMove(this,evt,evt.originalEvent.pageX,evt.originalEvent.pageY);}
function onMove($el,evt,pageX,pageY){var data=$el.data('dragon');var opts=$el.data('dragon-opts');var newCoords={};if(opts.axis!==$.fn.dragon.AXIS_X){newCoords.top=Math.round(pageY+data.grabPointY);}
if(opts.axis!==$.fn.dragon.AXIS_Y){newCoords.left=Math.round(pageX+data.grabPointX);}
if(opts.within){ensureWithin($el,newCoords);}
$el.css(ZERO_OUT_RIGHT_AND_BOTTOM).offset(newCoords);fire('drag',$el,evt);}
function preventSelect(evt){evt.preventDefault();if(window.getSelection){window.getSelection().removeAllRanges();}else if(document.selection){document.selection.clear();}}
function preventDefault(evt){evt.preventDefault();}
function fire(event,$el,evt){var handler=$el.data('dragon-opts')[event];evt.target=$el[0];if(handler){handler.call($el,evt);}
$el.trigger(event);}
function ensureWithin($el,newCoords){newCoords=newCoords||{};var data=$el.data('dragon');var opts=$el.data('dragon-opts');var $container=opts.within;var isWindow=$container===window;var containerOffset=isWindow?{left:0,top:0}:$container.offset();var paddingH=opts.withinPaddingH||0;var paddingV=opts.withinPaddingV||0;var minLeft=containerOffset.left+
(isWindow?0:parseInt($container.css('padding-left'),10))+
(isWindow?0:parseInt($container.css('border-left-width'),10))+
paddingH;var minTop=containerOffset.top+
(isWindow?0:parseInt($container.css('padding-top'),10))+
(isWindow?0:parseInt($container.css('border-top-width'),10))+
paddingV;var maxLeft=containerOffset.left
+(isWindow?$container.innerWidth:$container.outerWidth())
-(isWindow?0:parseInt($container.css('border-right-width'),10))
-(isWindow?0:parseInt($container.css('padding-right'),10))
+(isWindow?0:parseInt($el.css('margin-left'),10))
+(isWindow?0:parseInt($el.css('margin-right'),10))
-$el.outerWidth(true)
-paddingH;var maxTop=containerOffset.top
+(isWindow?$container.innerHeight:$container.outerHeight())
-(isWindow?0:parseInt($container.css('border-bottom-width'),10))
-(isWindow?0:parseInt($container.css('padding-bottom'),10))
+(isWindow?0:parseInt($el.css('margin-top'),10))
+(isWindow?0:parseInt($el.css('margin-bottom'),10))
-$el.outerHeight(true)
-paddingV;newCoords.top=Math.min(newCoords.top,maxTop);newCoords.top=Math.max(newCoords.top,minTop);newCoords.left=Math.min(newCoords.left,maxLeft);newCoords.left=Math.max(newCoords.left,minLeft);return newCoords;}})(_$);})(window,'uLiB.');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$;(function($){var caretTimeoutId,ua=navigator.userAgent,iPhone=/iphone/i.test(ua),chrome=/chrome/i.test(ua),android=/android/i.test(ua);$.mask={definitions:{"9":"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"},$.fn.extend({caret:function(begin,end){var range;if(0!==this.length&&!this.is(":hidden"))return"number"==typeof begin?(end="number"==typeof end?end:begin,this.each(function(){this.setSelectionRange?this.setSelectionRange(begin,end):this.createTextRange&&(range=this.createTextRange(),range.collapse(!0),range.moveEnd("character",end),range.moveStart("character",begin),range.select());})):(this[0].setSelectionRange?(begin=this[0].selectionStart,end=this[0].selectionEnd):document.selection&&document.selection.createRange&&(range=document.selection.createRange(),begin=0-range.duplicate().moveStart("character",-1e5),end=begin+range.text.length),{begin:begin,end:end});},unmask:function(){return this.trigger("unmask");},mask:function(mask,settings){var input,defs,tests,partialPosition,firstNonMaskPos,lastRequiredNonMaskPos,len,oldVal;if(!mask&&this.length>0){input=$(this[0]);var fn=input.data($.mask.dataName);return fn?fn():void 0;}
return settings=$.extend({autoclear:$.mask.autoclear,placeholder:$.mask.placeholder,completed:null},settings),defs=$.mask.definitions,tests=[],partialPosition=len=mask.length,firstNonMaskPos=null,$.each(mask.split(""),function(i,c){"?"==c?(len--,partialPosition=i):defs[c]?(tests.push(new RegExp(defs[c])),null===firstNonMaskPos&&(firstNonMaskPos=tests.length-1),partialPosition>i&&(lastRequiredNonMaskPos=tests.length-1)):tests.push(null);}),this.trigger("unmask").each(function(){function tryFireCompleted(){if(settings.completed){for(var i=firstNonMaskPos;lastRequiredNonMaskPos>=i;i++)if(tests[i]&&buffer[i]===getPlaceholder(i))return;settings.completed.call(input);}}
function getPlaceholder(i){return settings.placeholder.charAt(i<settings.placeholder.length?i:0);}
function seekNext(pos){for(;++pos<len&&!tests[pos];);return pos;}
function seekPrev(pos){for(;--pos>=0&&!tests[pos];);return pos;}
function shiftL(begin,end){var i,j;if(!(0>begin)){for(i=begin,j=seekNext(end);len>i;i++)if(tests[i]){if(!(len>j&&tests[i].test(buffer[j])))break;buffer[i]=buffer[j],buffer[j]=getPlaceholder(j),j=seekNext(j);}
writeBuffer(),input.caret(Math.max(firstNonMaskPos,begin));}}
function shiftR(pos){var i,c,j,t;for(i=pos,c=getPlaceholder(pos);len>i;i++)if(tests[i]){if(j=seekNext(i),t=buffer[i],buffer[i]=c,!(len>j&&tests[j].test(t)))break;c=t;}}
function androidInputEvent(){var curVal=input.val(),pos=input.caret();if(oldVal&&oldVal.length&&oldVal.length>curVal.length){for(checkVal(!0);pos.begin>0&&!tests[pos.begin-1];)pos.begin--;if(0===pos.begin)for(;pos.begin<firstNonMaskPos&&!tests[pos.begin];)pos.begin++;input.caret(pos.begin,pos.begin);}else{for(checkVal(!0);pos.begin<len&&!tests[pos.begin];)pos.begin++;input.caret(pos.begin,pos.begin);}
tryFireCompleted();}
function blurEvent(){checkVal(),input.val()!=focusText&&input.change();}
function keydownEvent(e){if(!input.prop("readonly")){var pos,begin,end,k=e.which||e.keyCode;oldVal=input.val(),8===k||46===k||iPhone&&127===k?(pos=input.caret(),begin=pos.begin,end=pos.end,end-begin===0&&(begin=46!==k?seekPrev(begin):end=seekNext(begin-1),end=46===k?seekNext(end):end),clearBuffer(begin,end),shiftL(begin,end-1),e.preventDefault()):13===k?blurEvent.call(this,e):27===k&&(input.val(focusText),input.caret(0,checkVal()),e.preventDefault());}}
function keypressEvent(e){if(!input.prop("readonly")){var p,c,next,k=e.which||e.keyCode,pos=input.caret();if(!(e.ctrlKey||e.altKey||e.metaKey||32>k)&&k&&13!==k){if(pos.end-pos.begin!==0&&(clearBuffer(pos.begin,pos.end),shiftL(pos.begin,pos.end-1)),p=seekNext(pos.begin-1),len>p&&(c=String.fromCharCode(k),tests[p].test(c))){if(shiftR(p),buffer[p]=c,writeBuffer(),next=seekNext(p),android){var proxy=function(){$.proxy($.fn.caret,input,next)();};setTimeout(proxy,0);}else input.caret(next);pos.begin<=lastRequiredNonMaskPos&&tryFireCompleted();}
e.preventDefault();}}}
function clearBuffer(start,end){var i;for(i=start;end>i&&len>i;i++)tests[i]&&(buffer[i]=getPlaceholder(i));}
function writeBuffer(){input.val(buffer.join(""));}
function checkVal(allow){var i,c,pos,test=input.val(),lastMatch=-1;for(i=0,pos=0;len>i;i++)if(tests[i]){for(buffer[i]=getPlaceholder(i);pos++<test.length;)if(c=test.charAt(pos-1),tests[i].test(c)){buffer[i]=c,lastMatch=i;break;}
if(pos>test.length){clearBuffer(i+1,len);break;}}else buffer[i]===test.charAt(pos)&&pos++,partialPosition>i&&(lastMatch=i);return allow?writeBuffer():partialPosition>lastMatch+1?settings.autoclear||buffer.join("")===defaultBuffer?(input.val()&&input.val(""),clearBuffer(0,len)):writeBuffer():(writeBuffer(),input.val(input.val().substring(0,lastMatch+1))),partialPosition?i:firstNonMaskPos;}
var input=$(this),buffer=$.map(mask.split(""),function(c,i){return"?"!=c?defs[c]?getPlaceholder(i):c:void 0;}),defaultBuffer=buffer.join(""),focusText=input.val();input.data($.mask.dataName,function(){return $.map(buffer,function(c,i){return tests[i]&&c!=getPlaceholder(i)?c:null;}).join("");}),input.one("unmask",function(){input.off(".mask").removeData($.mask.dataName);}).on("focus.mask",function(){if(!input.prop("readonly")){clearTimeout(caretTimeoutId);var pos;focusText=input.val(),pos=checkVal(),caretTimeoutId=setTimeout(function(){input.get(0)===document.activeElement&&(writeBuffer(),pos==mask.replace("?","").length?input.caret(0,pos):input.caret(pos));},10);}}).on("blur.mask",blurEvent).on("keydown.mask",keydownEvent).on("keypress.mask",keypressEvent).on("input.mask paste.mask",function(){input.prop("readonly")||setTimeout(function(){var pos=checkVal(!0);input.caret(pos),tryFireCompleted();},0);}),chrome&&android&&input.off("input.mask").on("input.mask",androidInputEvent),checkVal();});}});})(_$);})(window,'uLiB.jplugin');(function(g,ns){var u=g.uLiB.util,_$=u._$;if(_$.ionSound){return;}
var settings={},soundsNum,canMp3,url,i,sounds={},playing=false,VERSION='1.3.0';var supportAudio=function(){return typeof Audio==='function'||typeof Audio==='object';};var createSound=function(soundInfo){var name,volume;if(soundInfo.indexOf(':')!==-1){name=soundInfo.split(':')[0];volume=soundInfo.split(':')[1];}else{name=soundInfo;}
sounds[name]=new Audio();canMp3=sounds[name].canPlayType('audio/mp3');if(canMp3==='probably'||canMp3==='maybe'){url=settings.path+name+'.mp3';}else{url=settings.path+name+'.ogg';}
_$(sounds[name]).prop('src',url);sounds[name].load();sounds[name].preload='auto';sounds[name].volume=volume||settings.volume;};var playSound=function(info){var $sound,name,volume,playing_int;if(info.indexOf(':')!==-1){name=info.split(':')[0];volume=info.split(':')[1];}else{name=info;}
$sound=sounds[name];if(typeof $sound!=='object'||$sound===null){return;}
if(volume){$sound.volume=volume;}
if(!settings.multiPlay&&!playing){$sound.play();playing=true;playing_int=setInterval(function(){if($sound.ended){clearInterval(playing_int);playing=false;}},250);}else if(settings.multiPlay){if($sound.ended){$sound.play();}else{try{$sound.currentTime=0;}catch(e){}
$sound.play();}}};var stopSound=function(name){var $sound=sounds[name];if(typeof $sound!=='object'||$sound===null){return;}
$sound.pause();try{$sound.currentTime=0;}catch(e){}};var killSound=function(name){var $sound=sounds[name];if(typeof $sound!=='object'||$sound===null){return;}
try{sounds[name].src='';}catch(e){}
sounds[name]=null;};_$.ionSound=function(options){settings=_$.extend({sounds:['water_droplet'],path:'static/sounds/',multiPlay:true,volume:'0.5'},options);soundsNum=settings.sounds.length;if(supportAudio()){for(i=0;i<soundsNum;i+=1){createSound(settings.sounds[i]);}}
_$.ionSound.play=function(name){playSound(name);};_$.ionSound.stop=function(name){stopSound(name);};_$.ionSound.kill=function(name){killSound(name);};};_$.ionSound.destroy=function(){for(i=0;i<soundsNum;i+=1){sounds[settings.sounds[i]]=null;}
soundsNum=0;_$.ionSound.play=function(){};_$.ionSound.stop=function(){};_$.ionSound.kill=function(){};};u.apply(u.ns(ns),{supportAudio:supportAudio,initSound:function(opts){if(opts.disableMultipleWindowsSounds){this.disableMultipleWindowsSounds=!!opts.disableMultipleWindowsSounds;}
_$.ionSound(opts);},playSound:function(soundId){var me=this,fn=function(){if(!me.isSoundPlaying(soundId)){_$.ionSound.play(soundId);me.setLastSoundInfo(soundId);}};if(this.disableMultipleWindowsSounds){g.setTimeout(fn,Math.floor(Math.random()*100));}else{_$.ionSound.play(soundId);}},getStorageInfoKey:function(soundId){return'sound_player_lock-'+soundId;},getLastSoundInfo:function(soundId){return this.storageGet(this.getStorageInfoKey(soundId));},setLastSoundInfo:function(soundId){this.storageSet(this.getStorageInfoKey(soundId),this.dnow());},getSoundDuration:function(soundId){return sounds[soundId].duration*1000;},isSoundPlaying:function(soundId){return this.dnow()-this.getLastSoundInfo(soundId)-this.getSoundDuration(soundId)<0;}});}(window,'uLiB.util'));(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$;function Stateful(o){}
u.ensureFunctionName(Stateful);Stateful.prototype.globalStateId='global-state';Stateful.prototype.initStateful=function(state){this.restoreState(state);this.changeState();};Stateful.prototype.saveState=function(){if(!this.stateId){return;}
u.storageSet(this.stateId,this.state);this.hasGlobalState&&u.storageSet(this.globalStateId,this.globalState);};Stateful.prototype.restoreState=function(state){if(this.stateId){state=u.storageGet(this.stateId);}
this.state=state||this.state||this.states[0];if(this.hasGlobalState){this.globalState=u.storageGet(this.globalStateId)||{};}};Stateful.prototype.changeState=function(){this.saveState();};u.apply(u.ns(ns),{Stateful:Stateful});})(window,'uLiB.util');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$;var EASING='easeInCubic',DURATION_IN=300,DURATION_OUT=200,DURATION_INNER_FADE=80,SELECTOR_INNER_COMMON_FORM_PANEL='common-form-panel-container > *',DIRECTION_OPPOSITE={'left':'right','right':'left','up':'down','down':'up'},ZZZZZ;function _getRenderTo(cmp){if(cmp.component){cmp=cmp.component;}
if(cmp.parentCmp){cmp=cmp.parentCmp;}
return cmp.renderTo||'body';}
function _getOptions(o,effect,el,duration,easing){var options;if(u._$.type(effect)==='object'){options=effect;}else{options={effect:effect,el:el};}
if(duration==='show'){duration=DURATION_IN;}
if(duration==='hide'){duration=DURATION_OUT;}
u.applyIf(options,{duration:duration===undefined?DURATION_IN:duration,easing:easing===undefined?EASING:easing});options['complete']=function(){u.maybeCall(o.callback);u.maybeCall(options.callback);};return options;}
function _show(so,effect,el,duration,easing){if(duration===undefined){duration='show';}
var options=_getOptions(so,effect,el,duration,easing);u.maybeCall(so.beforeCallback);el=u.opop(options,'el');if(!el){el=so.component.getEl();}
el.show(options);}
function _hide(ho,effect,el,duration,easing){if(duration===undefined){duration='hide';}
var options=_getOptions(ho,effect,el,duration,easing);u.maybeCall(ho.beforeCallback);el=u.opop(options,'el');if(!el){el=ho.component.getEl();}
el.hide(options);}
function _innerFadeIn(o,selector,immediately,callback){if(u._$.type(selector)!=='string'){immediately=selector;selector=undefined;}
if(u._$.type(immediately)!=='boolean'){callback=immediately;}
selector=selector?u.getCssSelector(selector,true,true):'> *';o.component.getEl().find(selector).animate({opacity:1},{easing:EASING,duration:immediately?0:DURATION_INNER_FADE,complete:callback});}
function _innerFadeOut(o,selector,immediately,callback){if(u._$.type(selector)!=='string'){immediately=selector;selector=undefined;}
if(u._$.type(immediately)!=='boolean'){callback=immediately;}
selector=selector?u.getCssSelector(selector,true,true):'> *';o.component.getEl().find(selector).animate({opacity:0},{easing:EASING,duration:immediately?0:DURATION_INNER_FADE,complete:callback});}
function _getSlideDirection(cmp,opposite){var dir;cmp=cmp.component?cmp.component:cmp;if(cmp.respectBannerPlace||cmp.parentCmp&&cmp.parentCmp.respectBannerPlace||cmp.ownerComponent&&cmp.ownerComponent.respectBannerPlace){var bp=cmp['banner_place']||cmp.parentCmp&&cmp.parentCmp['banner_place'];bp=bp.split('_');if(bp[0]==='middle'){dir=bp[1];}else{dir={'bottom':'down','top':'up'}[bp[0]];}
if(!opposite){dir=DIRECTION_OPPOSITE[dir];}}
return dir;}
function _getElDimensions(el,selector,includePosition){var heightDelta=0;if(el&&el.component){el=el.component;}
if(u.isinstance(el,uLiB.cmp.Component)){var cmp=el,bp=cmp['banner_place']||cmp.parentCmp&&cmp.parentCmp['banner_place'];bp=bp.split('_');if(bp[0]==='middle'){includePosition=true;}
if(!selector&&u.isinstance(el,uLiB.banner.form.CommonFormPanel)){selector='common-form-panel-container';}
el=el.getEl();}
if(u._$.type(selector)==='boolean'){includePosition=selector;selector=undefined;}
if(selector){el=el.find(u.getCssSelector(selector,true,true));}
var ret={width:el.actual('outerWidth'),height:el.actual('outerHeight')+heightDelta};if(includePosition){u.apply(ret,{top:el.actual('offset').top});}
return ret;}
function _buildProxyEl(o){var cmp=o.component.parentCmp||o.component,el=cmp.getEl(),proxyId=el.attr('id')+'-proxy',proxy=el.clone();proxy.height(el.height());u.addCls(proxy,'proxy');proxy.css({maxHeight:'inherit',minHeight:'inherit',maxWidth:'inherit',minWidth:'inherit'});proxy.attr('id',proxyId);return proxy;}
function _buildCommonFormPanelProxy(o){var proxy=_buildProxyEl(o);proxy.find('>*').empty();return proxy.appendTo(_getRenderTo(o));}
function _buildSliderProxy(o){var proxy=_buildProxyEl(o),el=o.component.getEl();u.jfind(proxy,'expanded').height(u.jfind(el,'expanded').height());u.jfind(proxy,'label').remove();u.jfind(proxy,'collapsed').remove();u.jfind(proxy,'expanded').empty();return proxy.appendTo(_getRenderTo(o));}
function _buildBannerProxy(o){var proxy=_buildProxyEl(o),el=o.component.getEl();proxy.css({overflow:'hidden',width:el.width()});proxy.empty();return proxy.appendTo(_getRenderTo(o));}
function _buildLabelProxy(o){var proxy=_buildProxyEl(o),el=o.component.getEl();proxy.css({width:el.width()});proxy.empty();return proxy.appendTo(_getRenderTo(o));}
function _fadeIn(el,callback){el.css({opacity:0});el.animate({opacity:1},{easing:EASING,duration:DURATION_INNER_FADE,complete:callback});}
function _fadeOut(el,callback){el.css({opacity:1});el.animate({opacity:0},{easing:EASING,duration:DURATION_INNER_FADE,complete:callback});}
function bannerFadeIn(undef,so){_show(so,'fade');}
function sliderSlideIn(undef,so){if(u.jhasClass(so.component.getEl(),'single-way-common')){_show(so,{effect:'fade'});}else{so.component.getEl().show();so.component.getInnerEl('collapsed').hide();_show(so,{effect:u.C.IS_IE_LT_10?'fade':'slide',direction:_getSlideDirection(so.component,true),el:so.component.getInnerEl('collapsed')});}}
function buttonsSlideIn(undef,so){so.component.getEl().show();so.component.getInnerEl('expanded').hide();_show(so,{effect:'slide',direction:_getSlideDirection(so.component,true),el:so.component.getInnerEl('expanded')});}
function sliderExpand(ho,so){var hel=ho.component.getEl(),sel=so.component.getEl(),whel=hel.width(),wsel=sel.width(),dir=_getSlideDirection(so.component,true),expandedCmpHeight=so.component.getEl().height(),startCorrection=ho.component.parentCmp.banner_skin!=='touch'?8:74,start=dir==='right'||dir==='down'?expandedCmpHeight-startCorrection:startCorrection-expandedCmpHeight,hideShow=function(){_hide(ho,{effect:'fade',duration:0,el:ho.component.getEl()});_show(so,{effect:'slide',start:start,direction:dir,el:so.component.getEl(),callback:function(){_innerFadeIn(so,'way-item');}});};_innerFadeOut(so,'way-item',true);if(whel>wsel){hel.origWidth=whel;hel.animate({width:wsel},{easing:EASING,duration:100,complete:hideShow});}else{hideShow();}}
function sliderCollapse(ho,so){_innerFadeOut(ho,'way-item');_hide(ho,{effect:'slide',direction:_getSlideDirection(ho.component,true),el:ho.component.getEl(),distance:100,callback:function(){_show(so,'',so.component.getEl(),0);if(so.component.getEl().origWidth){so.component.getEl().animate({width:so.component.getEl().origWidth},{easing:EASING,duration:100});}}});}
function cmpToCmp(ho,so){var proxy=ho.proxy;_fadeIn(proxy,function(){_hide(ho,{effect:'',duration:0,callback:function(){var dim=_getElDimensions(so);proxy.animate(dim,{duration:DURATION_IN,complete:function(){_show(so,{effect:'',duration:0});_fadeOut(proxy,function(){proxy.remove();})}});}});});}
function bannerCollapse(ho,so){cmpToCmp(u.apply({proxy:_buildBannerProxy(ho)},ho),so)}
function bannerExpand(ho,so){cmpToCmp(u.apply({proxy:_buildLabelProxy(ho)},ho),so)}
function bannerToCommonFormPanel(ho,so){var innersSelector=SELECTOR_INNER_COMMON_FORM_PANEL;_hide(ho,{effect:'fade',callback:function(){_innerFadeOut(so,innersSelector,true);_show(so,{effect:'slide',direction:_getSlideDirection(so.component,true),callback:function(){_innerFadeIn(so,innersSelector);}});}});}
function commonFormPanelToBanner(ho,so){_hide(ho,{effect:'slide',direction:_getSlideDirection(ho.component,true),callback:function(){_show(so,'fade');}});}
function sliderToCommonFormPanel(ho,so){var innersSelector=SELECTOR_INNER_COMMON_FORM_PANEL,afterHide=function(){_innerFadeOut(so,innersSelector,true);_show(so,{effect:'slide',direction:_getSlideDirection(so.component,true),callback:function(){_innerFadeIn(so,innersSelector);}});};if(u.jhasClass(ho.component.getEl(),'single-way-common')){_hide(ho,{effect:'fade',callback:afterHide});}else{_hide(ho,{effect:'slide',direction:_getSlideDirection(ho.component,true),callback:afterHide});}}
function commonFormPanelToSlider(ho,so){var innersSelector=SELECTOR_INNER_COMMON_FORM_PANEL;_innerFadeOut(ho,innersSelector);_hide(ho,{effect:'slide',direction:_getSlideDirection(ho.component,true),callback:function(){ho.el&&_innerFadeIn(ho,innersSelector,true);if(u.jhasClass(so.component.getEl(),'single-way-common')){_show(so,{effect:'fade'});}else{_show(so,{effect:'slide',direction:_getSlideDirection(ho.component,true)});}}});}
function buttonsToCommonFormPanel(ho,so){_innerFadeOut(ho,'way-item > *');_hide(ho,{effect:'slide',direction:_getSlideDirection(ho,true),callback:function(){_innerFadeOut(so,SELECTOR_INNER_COMMON_FORM_PANEL,true);_show(so,{effect:'slide',direction:_getSlideDirection(so,true),callback:function(){_innerFadeIn(so,SELECTOR_INNER_COMMON_FORM_PANEL);_innerFadeIn(ho,'way-item > *',true);}})}});}
function commonFormPanelToButtons(ho,so){_innerFadeOut(so,SELECTOR_INNER_COMMON_FORM_PANEL);_hide(ho,{effect:'slide',direction:_getSlideDirection(so,true),callback:function(){_innerFadeOut(ho,'way-item > *');_show(so,{effect:'slide',direction:_getSlideDirection(so,true),callback:function(){_innerFadeIn(ho,'way-item > *');_innerFadeIn(so,SELECTOR_INNER_COMMON_FORM_PANEL,true);}});}});}
function showPopupMessagePanel(undef,so){_innerFadeOut(so,true);so.component.ownerComponent.showToolButtons(false);_show(so,{effect:'slide',direction:_getSlideDirection(so,true),duration:100});_innerFadeIn(so);}
function hidePopupMesagePanel(ho,undef){_hide(ho,{effect:'slide',direction:_getSlideDirection(ho,true),duration:50});_innerFadeOut(ho);}
function consultantPanelToSitePhone(ho,so){_innerFadeOut(ho,SELECTOR_INNER_COMMON_FORM_PANEL);_hide(ho,{effect:'slide',direction:_getSlideDirection(ho,true),callback:function(){_innerFadeIn(ho,SELECTOR_INNER_COMMON_FORM_PANEL,true);_innerFadeOut(so,SELECTOR_INNER_COMMON_FORM_PANEL,true);_show(so,{effect:'slide',direction:_getSlideDirection(ho,true),callback:function(){_innerFadeIn(so,SELECTOR_INNER_COMMON_FORM_PANEL)}})}});}
function mainInputCmpToMainEmailChatCmp(ho,so){var hcmp=ho.component,hel=hcmp.getEl(),sel=so.component.getEl(),delta=sel.height()-hel.height(),consultantPanelCmp=hcmp.parentCmp;consultantPanelCmp.logCmp.getEl().animate({height:'-='+delta},{queue:false,duration:DURATION_INNER_FADE});_hide(ho,{effect:'fade',duration:DURATION_INNER_FADE,callback:function(){_innerFadeOut(so,true);_innerFadeIn(so);_show(so,{effect:'slide',direction:'up',duration:DURATION_INNER_FADE});}});}
function mainEmailChatCmpToMainInputCmp(ho,so){var hcmp=ho.component,hel=hcmp.getEl(),sel=so.component.getEl(),delta=hel.height()-sel.height(),consultantPanelCmp=hcmp.parentCmp;_hide(ho,{effect:'fade',duration:DURATION_INNER_FADE,callback:function(){_innerFadeOut(so,true);_innerFadeIn(so);_show(so,{effect:'slide',direction:'up',duration:DURATION_INNER_FADE});}});consultantPanelCmp.logCmp.getEl().animate({height:'+='+delta},{queue:false,duration:DURATION_INNER_FADE});}
function simpleInputCmpToSimpleEmailChatCmp(ho,so){_hide(ho,{effect:'fade',duration:DURATION_INNER_FADE});_show(so,{effect:'fade',duration:DURATION_INNER_FADE});}
function simpleEmailChatCmpToSimpleInputCmp(ho,so){simpleInputCmpToSimpleEmailChatCmp(ho,so);}
var ANIMATIONS={'undefined:Banner':bannerFadeIn,'undefined:Slider':sliderSlideIn,'undefined:Buttons':buttonsSlideIn,'slider-expanded:slider-collapsed':sliderCollapse,'slider-collapsed:slider-expanded':sliderExpand,'Banner:CommonFormPanel':bannerToCommonFormPanel,'CommonFormPanel:Banner':commonFormPanelToBanner,'Slider:CommonFormPanel':sliderToCommonFormPanel,'CommonFormPanel:Slider':commonFormPanelToSlider,'Buttons:CommonFormPanel':buttonsToCommonFormPanel,'CommonFormPanel:Buttons':commonFormPanelToButtons,'undefined:PopupMessagePanel':showPopupMessagePanel,'PopupMessagePanel:undefined':hidePopupMesagePanel,'CommonFormPanel:CommonFormPanel':consultantPanelToSitePhone,'main-input-cmp:main-email-chat-cmp':mainInputCmpToMainEmailChatCmp,'main-email-chat-cmp:main-input-cmp':mainEmailChatCmpToMainInputCmp,'simple-input-cmp:simple-email-chat-cmp':simpleInputCmpToSimpleEmailChatCmp,'simple-email-chat-cmp:simple-input-cmp':simpleEmailChatCmpToSimpleInputCmp};function AnimationManager(){this.currentAnimation={};this.actionTimeoutId=null;this.easing=EASING;this.durationInnerFade=DURATION_INNER_FADE;this.durationIn=DURATION_IN;this.durationOut=DURATION_OUT;}
AnimationManager.prototype.waitForAction=20;AnimationManager.prototype.push=function(component,show,callback,beforeCallback){var action=show?'show':'hide';this.currentAnimation[action]={component:component,callback:callback,beforeCallback:beforeCallback};if(this.actionTimeoutId!==null){g.clearTimeout(this.actionTimeoutId);}
this.actionTimeoutId=g.setTimeout(u.bind(this.doActions,this),this.waitForAction);};AnimationManager.prototype.doActions=function(){this.actionTimeoutId=null;this.doAnimation();};AnimationManager.prototype.doAnimation=function(){var ca=this.currentAnimation,hide=ca['hide'],show=ca['show'],animationFn=this.getAnimationFn(hide,show);this.clearCurrentAnimation();if(animationFn){animationFn(hide,show);}else{if(hide){u.maybeCall(hide.beforeCallback);hide.component.getEl()&&hide.component.getEl().hide();u.maybeCall(hide.callback);}
if(show){u.maybeCall(show.beforeCallback);show.component.getEl().show();u.maybeCall(show.callback);}}};AnimationManager.prototype.clearCurrentAnimation=function(){this.currentAnimation={};};AnimationManager.prototype.getAnimationKey=function(hide,show){return u.sformat('{0}:{1}',this.getComponentAnimaitonKey(hide),this.getComponentAnimaitonKey(show));};AnimationManager.prototype.getAnimationFn=function(hide,show){u.log(this.getAnimationKey(hide,show),hide,show);return ANIMATIONS[this.getAnimationKey(hide,show)];};AnimationManager.prototype.getComponentAnimaitonKey=function(o){return o&&o.component.animationKey||o&&o.component.constructor.name;};var am=new AnimationManager();am.getSlideDirection=_getSlideDirection;u.apply(u.ns(ns),{AnimationManager:am});})(window,'uLiB.util');(function(g,ns){var u=g.uLiB.util,_$=u._$;function Element(o){if(_$.type(o)=='string'){return _$(o);}
var tag=o.tag||this.tag,renderTo=o.renderTo||this.renderTo,text=o.text||this.text,children=o.children||this.children,cls=o.cls||this.cls,defaults=o.defaults||this.defaults,unselectable=o.unselectable||this.unselectable,ctype=o.ctype||this.ctype;var elConfig={};for(var k in o){if(o.hasOwnProperty(k)&&u.inArray(k,u.C.ATTRS_SPECIAL)==-1){elConfig[k]=o[k];}}
if(cls){elConfig['class']=u.getCssSelector(cls,true);}
if(ctype){elConfig[u.C.ATTR_COMAGIC_CTYPE]=ctype;}
if(unselectable==='on'){u.appendCssSelector(elConfig,u.C.CSS_UNSELECTABLE);}
var el=_$(u.sformat('<{0}/>',tag),elConfig);if(text!==undefined){el.text(text);}
if(children){for(var i=0,c;(c=children[i]);i++){if(c.__eventNormalizer&&c._idPrefix){el.append(c.getEl());}else if(c.jquery){el.append(c);}else if(_$.isPlainObject(c)&&c.length===undefined){new Element(u.apply(c,{renderTo:el},defaults));}else{el.append(c);}}}
if(renderTo){u.isInstance(renderTo,'uLiB.cmp.Component')?el.appendTo(renderTo.getEl()):el.appendTo(renderTo);}
return el;}
u.apply(u.ns(ns),{Element:Element});})(window,'uLiB.el');(function(g,ns){var u=g.uLiB.util;function Div(o){o.tag='div';return Div.superclass.constructor.call(this,o);}
u.extend(Div,'uLiB.el.Element');function FooterEl(o){o.cls='footer';FooterEl.superclass.constructor.apply(this,arguments);}
u.extend(FooterEl,Div);function TestDiv(o){o.cls='test-div';this.renderTo='body';TestDiv.superclass.constructor.apply(this,arguments);}
u.extend(TestDiv,Div);u.apply(u.ns(ns),{Div:Div,Footer:FooterEl,TestDiv:TestDiv});})(window,'uLiB.el');(function(g,ns){var ul=g.uLiB,u=ul.util,Element=ul.el.Element,_$=u._$;function Label(o){this.tag='label';Label.superclass.constructor.apply(this,arguments);}
u.extend(Label,Element);function TestLabel(o){this.cls='test-label';this.renderTo='body';TestLabel.superclass.constructor.apply(this,arguments);}
u.extend(TestLabel,Label);u.apply(u.ns(ns),{Label:Label,TestLabel:TestLabel});})(window,'uLiB.el');(function(g,ns){var ul=g.uLiB,u=ul.util,Element=ul.el.Element,_$=u._$;function Table(o){this.tag='table';Table.superclass.constructor.apply(this,arguments);}
u.extend(Table,Element);function TestTable(o){this.cls='test-table';this.children=[{tag:'tr',children:[{tag:'td',id:'f'},{tag:'td',id:'s'},{tag:'td',id:'t'}]}];this.renderTo='body';TestTable.superclass.constructor.apply(this,arguments);}
u.extend(TestTable,Table);u.apply(u.ns(ns),{Table:Table,TestTable:TestTable});})(window,'uLiB.el');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$;function Form(o){}
u.ensureFunctionName(Form);Form.prototype.clearOnSubmit=true;Form.prototype.clearValues=function(){var fs=this.getFields();for(var i=0,f;(f=fs[i]);i++){!f.dontClear&&f.setValue(g.uLiB.field.Field.prototype.emptyValue);}};Form.prototype.clearInvalid=function(){var fs=this.getFields();for(var i=0,f;(f=fs[i]);i++){f.setError();}};Form.prototype.getField=function(name){var fs=this.getFields();for(var i=0,f;(f=fs[i]);i++){if(f.name==name){return f;}}
return null;};Form.prototype.getFields=function(asObject){asObject=!!asObject;var ret=asObject?{}:[];for(var i=0,it;(it=this.items[i]);i++){if(u.isInstance(it,'uLiB.field.Field')){asObject?(ret[it.name]=it):ret.push(it);}}
return ret;};Form.prototype.isValid=function(){var fs=this.getFields(),fl=true;for(var i=0,f;(f=fs[i]);i++){fl=f.isValid()&&fl;}
return fl;};Form.prototype.getValues=function(){var fs=this.getFields(),ret={},val;for(var i=0,f;(f=fs[i]);i++){val=f.getValue();_$.isPlainObject(val)?u.apply(ret,val):(ret[f.name]=f.getValue());}
return ret;};Form.prototype.setValues=function(o){var fs=this.getFields(true);for(var k in o){if(!o.hasOwnProperty(k)){continue;}
fs[k]&&fs[k].setValue(o[k]);}};Form.prototype.hasChanges=function(){return true;};u.apply(u.ns(ns),{Form:Form});})(window,'uLiB.form');(function(g,ns){var ul=g.uLiB,u=ul.util,Element=ul.el.Element,Stateful=u.Stateful,_$=u._$,ATTR_COMAGIC_CTYPE=u.C.ATTR_COMAGIC_CTYPE,CMP_EVENTS_TO_LISTEN_TO=['click','mouseover','mouseout'],CTYPE_DELIMITER=u.C.CTYPE_DELIMITER,ComponentManager=new(function(){var components={},ctypes={};this.register=function(cmp){components[cmp.id]=cmp;};this.registerCType=function(__class){var ctype=__class.prototype.ctype;ctype&&(ctypes[ctype]=__class);};this.get=function(cmpId){return components[cmpId];};this.create=function(config,opts){var __class=config['__class'];if(!__class){__class=ctypes[config['ctype']];}
delete config['__class'];return new __class(config,opts);};this.getBy=function(ctypeOrCtor){var cmp;for(var k in components){if(components.hasOwnProperty(k)){cmp=components[k];if(u._$.type(ctypeOrCtor)==='function'&&u.isinstance(cmp,ctypeOrCtor)){return cmp;}
if(u._$.type(ctypeOrCtor)==='string'&&cmp.ctype===ctypeOrCtor){return cmp;}}}
return null;}})();function Component(o){var me=this;o=u.apply({},o);this.id=this.genId();if(o.cls){this.addCls(o.cls);delete o.cls;}
if(o._onClick&&this._onClick){this.__onClick=o._onClick;delete o._onClick;}
this.addCls('component');if(u.C.IS_IE_LT_10){this.addCls(u.C.CSS_IE_LT_10);}
if(u.C.IS_IE_LT_9){this.addCls(u.C.CSS_IE_LT_9);}
if(u.C.IS_IE_LT_8){this.addCls(u.C.CSS_IE_LT_8);}
u.apply(this,o);this.o=o;if(this.respectBannerPlace&&this['banner_place']){this.addCls(this['banner_place'].replace('_',' '));if(this['banner_place'].indexOf('middle')!=-1){this.onShow=u.bind(function(show){if(show){if(!this.state||!this.state.css||!this.state.css.top){this.getEl().center(this['is_preview']?this.getEl().parent('body'):window,'v',true);}}},this);}}
if(this.monitorResize){_$(g).resize(u.bind(me._onResize,me));}
if(o.stateful||this.stateful){this.initStateful(o.state);}
if(o.floating||this.floating){this.zIndex=this.zIndex||11;}
this.initComponent();if(o.floating||this.floating){this.getEl().css({position:'absolute'});}
if(this.monitorZoom){setInterval(function(){me.getEl()&&u.zoomElement(me.getEl());},100);}
ComponentManager.register(this);}
u.mixIn(Component,Stateful);Component.prototype.ctype='component';Component.prototype.destroyOnHide=false;Component.prototype.respectBannerPlace=false;Component.prototype.trackOwnEvents=false;Component.prototype.animationEnabled=false;Component.prototype._idPrefix='comagic-cmp-';Component.prototype._namePrefix='cmg-';Component.prototype._typeAttr=ATTR_COMAGIC_CTYPE;Component.prototype._typePrefix='';Component.prototype._idCounter=0;Component.prototype.__eventNormalizer=function(event){var deepCType=u.getCTypeOf(event.target),parts=deepCType.split(CTYPE_DELIMITER),ctype=parts.pop();if(!deepCType||(deepCType==ctype&&!this.trackOwnEvents)){return false;}
return[this,deepCType,ctype,event,event.target,deepCType==ctype];};Component.prototype.genId=function(){return this._idPrefix+(Component.prototype._idCounter++);};Component.prototype.getCType=function(){return this.ctype&&(Component.prototype._typePrefix+this.ctype);};Component.prototype.getHtml=function(){return this.html;};Component.prototype.getCls=function(){return this.cls;};Component.prototype.hasCls=function(cls){return this.getCls().indexOf(u.getCssSelector(cls,true))!==-1;};Component.prototype.destroy=function(){this.onDestroy&&this.onDestroy();if(this.el){this.el.remove();this.el=null;}};Component.prototype.reRender=function(config){this.destroy();if(config){u.apply(this,config);}
this.beforeRender();this.render();this.afterRender();};Component.prototype.buildEl=function(){return new Element(this.autoEl||this.getHtml());};Component.prototype.initComponent=function(){this.beforeRender();this.render();this.afterRender();};Component.prototype.render=function(){var ctype=this.getCType();this.el=this.buildEl();if(this.renderHidden){this.el.hide();}
this.el.attr('id',this.id);this.name&&this.el.attr('name',this._namePrefix+this.name);if(this.getCls()){this._setElClass(u.getCssSelector(this.getCls(),true));}
if(ctype){this.el.attr(Component.prototype._typeAttr,ctype);}
if(this.style){for(var k in this.style){if(!this.style.hasOwnProperty(k)){continue;}
this.el.css(k,this.style[k]);}}
if(this.zIndex!==undefined){this.el.css('z-index',u.getZIndexStr(this.zIndex));}
if(this.width!==undefined){this.getEl().width(this.width);}
if(this.height!==undefined){this.getEl().height(this.height);}
if(this.disabled!==undefined){this.setDisabled(this.disabled);}
if(this.renderTo){this.getEl().appendTo(this.renderTo instanceof Component?this.renderTo.getEl():this.renderTo);}};Component.prototype.beforeRender=function(){if(this['banner_skin']){this.addCls('skin-'+this['banner_skin']);}
if(this.html){this.html=u.sformat(this.html,this);}};Component.prototype.renderItems=function(items){items=items||this.items;var el=this._getBodyEl(),item;for(var i=0,ii;(ii=items[i]);i++){item=this.buildItem(ii);items[i]=item;el.append(item.getEl());}
this.items=items;return this;};Component.prototype.getEventsEl=function(){return this.getEl();};Component.prototype.afterRender=function(){if(this.tooltip){this.setTooltip(this.tooltip);}
this.initEvents&&this.initEvents();this.monitorResize===true&&g.setTimeout(u.bind(this._adjustPosition,this),50);};Component.prototype.initEvents=function(){var events=CMP_EVENTS_TO_LISTEN_TO;if(this.trackClick&&this._onClick){this.getEl().on('click',u.wrapEvent(this.__eventNormalizer,this._onClick,this));}
if(this.trackClick&&this.__onClick){this.getEl().on('click',u.wrapEvent(this.__eventNormalizer,this.__onClick,this));}
if(this._onKeyup){this.getEl().on('keyup',u.wrapEvent(this.__eventNormalizer,this._onKeyup,this));}
if(this._onKeydown){this.getEl().on('keydown',u.wrapEvent(this.__eventNormalizer,this._onKeydown,this));}
for(var i=0,e,handler;(e=events[i]);i++){handler=this['on'+u.camelize(e)];if(_$.type(handler)=='function'){this.getEventsEl().on(e,u.wrapEvent(this.__eventNormalizer,handler,this));}}};Component.prototype.calculateTooltipGravity=function(el){if(this.tooltipGravity){return this.tooltipGravity;}
el=el||this._getTooltipEl();var elOffset=el.offset();return elOffset.left<200?'w':'e';};Component.prototype._setTooltip=function(tooltipText){var attr={'title':u.C.ATTR_COMAGIC_TOOLTIP,'rich':u.C.ATTR_COMAGIC_TOOLTIP_RICH}[this.tooltipType]||u.C.ATTR_COMAGIC_TOOLTIP,text=tooltipText||this.tooltip,el=this._getTooltipEl();if(!el){return;}
el.attr(attr,text);if(this.tooltipType==='rich'){this._setRichTooltip(text,el);}};Component.prototype._setRichTooltip=function(tooltipText,el){el.tipsy(u.apply({gravity:u.bind(this.calculateTooltipGravity,this),trigger:'manual'},this.tooltipOptions));el.tipsy(tooltipText?'show':'hide');};Component.prototype.setTooltip=function(tooltip){this.tooltip=this.tooltip||tooltip;this._setTooltip();};Component.prototype._getClsParts=function(cls){cls=cls||this.cls;if(!cls){return[];}
return cls.split(/\s+/);};Component.prototype._setElClass=function(cls){this.el&&this.el.attr('class',(this.cls=cls));};Component.prototype._onResize=function(){this._adjustPosition();};Component.prototype._adjustPosition=function(){var me=this,cmpMargin=8,cmpMarginStr=u.sformat('{0}px',cmpMargin),ww=u.elementWidth(),wh=u.elementHeight(),cmpEl=me.getEl(),cmpw=u.elementWidth(cmpEl),cmph=u.elementHeight(cmpEl);if(!cmpEl){return;}
if((cmpw+cmpMargin*2)>ww||(cmph+cmpMargin*2)>wh){cmpEl.css('position','absolute').css('left',cmpMarginStr).css('right','auto').css('top',cmpMarginStr).css('bottom','auto');}else{cmpEl.css('position','').css('right','').css('bottom','').css(u.arrayIsContain((this.o.banner_place||'').split('_'),['bottom','top'])?'top':'left','')}
this.state=this.globalState||this.state;if(this.state&&this.state.css){if(u.arrayIsContain((this.o.banner_place||'').split('_'),['bottom','top'])){if(u.elementWidth()-this.state.css.left-cmpEl.width()<30){cmpEl.css('left',u.elementWidth()-cmpEl.width()-30);this.savePosition();}}else{if(u.elementHeight()-this.state.css.top-cmpEl.height()<10){cmpEl.css('top',u.elementHeight()-cmpEl.height()-10);this.savePosition();}}}};Component.prototype.savePosition=function(){if(this.isVisible()){var railAxis=u.arrayIsContain((this.o.banner_place||'').split('_'),['bottom','top'])?'x':'y';this.state=this.state||{};this.state.css=this.state.css||{};if(this.respectBannerPlace){if(railAxis==='x'){this.state.css.left=this.getEl().offset().left;}else{this.state.css.top=this.getEl().offset().top;}}
this.globalState={};this.globalState.css=this.state.css;this.saveState();}};Component.prototype.restorePosition=function(){this.restoreState();if(this.hasGlobalState){this.state.css=this.globalState.css;}
if(!this.o.is_preview&&this.getEl()&&this.state.css){var railAxis=u.arrayIsContain((this.o.banner_place||'').split('_'),['bottom','top'])?'x':'y';railAxis==='x'&&this.getEl().css('left',u.elementWidth()>=this.state.css.left?this.state.css.left:u.elementWidth()/2);railAxis==='x'&&this.state.css.left&&this.hasCls('right')&&this.removeCls('right');railAxis==='y'&&this.getEl().css('top',u.elementHeight()>=this.state.css.top?this.state.css.top:20);}};Component.prototype.addCls=function(cls){cls=u.getCssSelector(cls,true);var parts=this._getClsParts();if(u.inArray(cls,parts)!=-1){return;}
parts.push(cls);this._setElClass(this.cls=parts.join(' '));};Component.prototype.removeCls=function(cls,isMask){cls=u.getCssSelector(cls,true);var parts=this._getClsParts();if(isMask){var tmp=[];for(var i=0,p;(p=parts[i]);i++){if(p.indexOf(cls)!==0){tmp.push(p);}}
if(parts.length===tmp.length){return;}
parts=tmp;}else{var index=u.inArray(cls,parts);if(index==-1){return;}
parts.splice(index,1);}
this._setElClass(this.cls=parts.join(' '));};Component.prototype.isVisible=function(){if(this.showing||this.hiding){return this.showing;}
return this.getEl().is(':visible');};Component.prototype.show=function(show,options){var forceAnimation=options===true;if(u.isMsSkin(this)&&this.animationEnabled||forceAnimation){var isVisible=this.isVisible();if(!(show^isVisible)){return;}
show&&(this.showing=show);!show&&(this.hiding=!show);uLiB.util.AnimationManager.push(this,show,u.bind(function(){this.showing=false;this.hiding=false;u.maybeCall(options,'callback',this);u.maybeCall(options,'afterCallback',this);show&&this.initDraggable();if(!show&&this.destroyOnHide){this.destroy();}},this),u.bind(function(){u.maybeCall(options,'beforeCallback',this);},this));this.onShow&&this.onShow(show,options);}else{if(options&&options.callback){options.complete=options.callback;}
this.getEl()[show?'show':'hide'](options);this.onShow&&this.onShow(show,options);show&&this.initDraggable();}};Component.prototype.getEl=function(){return this.el;};Component.prototype._getTooltipEl=function(){return this.el;};Component.prototype._getBodyEl=function(){return this.bodyEl||this.el;};Component.prototype.add=function(cmpOrEl){this._getBodyEl().append(cmpOrEl instanceof Component?cmpOrEl.getEl():cmpOrEl);return cmpOrEl;};Component.prototype.setDisabled=function(disabled){this[disabled?'addCls':'removeCls']('component-disabled');this.disabled=disabled;};Component.prototype.isDisabled=function(){return this.disabled;};Component.prototype.getInnerEl=function(elSelector){return this.getEl().find(u.getCssSelector(elSelector,true,true));};Component.prototype.changeState=function(){};Component.prototype.initDraggable=function(){if(!this.getEl().dragon||this.isDraggableInited||!this.draggable){return;}
this.getEl().dragon(this.getDraggableOpts());this.isDraggableInited=true;};Component.prototype.getDraggableOpts=function(){return{};};u.apply(u.ns(ns),{ComponentManager:ComponentManager,Component:Component});})(window,'uLiB.cmp');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$;function Button(o){this.addCls('button');var action=this.action||o.action,icon=o.icon||this.icon;if(action){this.ctype=[this.ctype,action].join('-');}
if(icon){var iconAnchor=icon.anchor||'left',iconTpl=icon.tpl||this[u.sformat('iconTpl{0}',u.camelize(iconAnchor))],iconHtml;iconHtml=u.sformat(iconTpl,u.apply({},icon,{src:this.defaultIconSrc}));this.html=u.sformat(this.html,{text:iconHtml});this.addCls('button-icon');this.addCls('button-icon-'+(iconAnchor));}
this.html=u.sformat(this.html,{text:this.textTpl});if(o.menu||this.menu){this.stateful=true;this.state=this.states[1];}
if(this.enableToggle||o.enableToggle){this.pressed=!!(this.pressed||o.pressed);}
Button.superclass.constructor.apply(this,arguments);if(this.menu){this.initMenu();}}
u.extend(Button,'uLiB.cmp.Component');Button.prototype.trackClick=true;Button.prototype.ctype='button';Button.prototype.text='&nbsp;';Button.prototype.html='<div><a tabindex="0" unselectable="on">{text}</a></div>';Button.prototype.textTpl='{text}';Button.prototype.iconTplLeft='<img src="{src}">{text}';Button.prototype.defaultIconSrc=u.C.SRC_IMG_BLANK;Button.prototype.states=['on','off'];Button.prototype.stateClsPrefix='button-state-';Button.prototype.enableToggle=false;Button.prototype.initMenu=function(){this.trackOwnEvents=true;this.menu=new ul.cmp.Menu(this.menu);this.menu.button=this;};Button.prototype.changeState=function(newState){if(this.disabled){return;}
var currState=this.state,doChange=newState===undefined||(newState!==currState&&u.arrayIsContain(this.states,newState));this.state=newState||currState;if(!doChange||this._onBeforeStateChange(this.state,currState)===false){return;}
this.removeCls(this.stateClsPrefix+currState);this.addCls(this.stateClsPrefix+this.state);this.mixins.Stateful.changeState.apply(this,arguments);this.setStateText();this._onStateChange(newState,currState);};Button.prototype._onBeforeStateChange=function(newState,currState){return this.onBeforeStateChange(newState,currState);};Button.prototype.onBeforeStateChange=function(newState,currState){};Button.prototype._onStateChange=function(newState,oldState){this.onStateChange(newState,oldState);};Button.prototype.onStateChange=function(newState,oldState){};Button.prototype.setStateText=function(){var stateTextPropName=u.sformat('textState{0}',u.camelize(this.state)),text=this[stateTextPropName];if(text!==undefined){this.setText(text);}};Button.prototype._onClick=function(_this,deepCType,ctype,event){if(this.disabled){event.stopPropagation();return;}
if(this.stateful){var currStateIndex=u.arrayIndexOf(this.states,this.state),len=this.states.length,newStateIndex=(currStateIndex+1)%len;this.changeState(this.states[newStateIndex]);this.showMenu(this.state==='on');}
if(this.enableToggle){this.getEl().toggleClass(u.getCssSelector('active',true),(this.pressed=!this.pressed))}};Button.prototype.showMenu=function(show){if(this.disabled||!this.menu){return;}
if(show){this.menu.showAt(this.getEl(),'tl-bl');}else{this.menu.show(false);}};Button.prototype.setText=function(text){this.text=text;var tel=this.getTextEl();tel&&tel.text(text);};Button.prototype.getTextEl=function(){var el=this.getEl();return el&&el.find('span');};function StandardButton(o){this.addCls('standard-button');this.addCls('standard-button');StandardButton.superclass.constructor.apply(this,arguments);}
u.extend(StandardButton,Button);StandardButton.prototype.ctype='standard-button';function SmallButton(o){this.addCls('small-button');SmallButton.superclass.constructor.apply(this,arguments);}
u.extend(SmallButton,Button);SmallButton.prototype.ctype='small-button';function ToolButton(o){this.addCls('tool-button');ToolButton.superclass.constructor.apply(this,arguments);}
u.extend(ToolButton,Button);ToolButton.prototype.ctype='tool-button';function ToolButtonClose(o){this.addCls('tool-button-close');this.action='close';ToolButtonClose.superclass.constructor.apply(this,arguments);}
u.extend(ToolButtonClose,ToolButton);function ToolButtonUnpin(o){this.addCls('tool-button-unpin');this.action='unpin';ToolButtonUnpin.superclass.constructor.apply(this,arguments);}
u.extend(ToolButtonUnpin,ToolButton);function ToolButtonPin(o){this.addCls('tool-button-pin');this.action='pin';ToolButtonPin.superclass.constructor.apply(this,arguments);}
u.extend(ToolButtonPin,ToolButton);function ToolButtonMinimize(o){this.addCls('tool-button-minimize');this.action='minimize';ToolButtonMinimize.superclass.constructor.apply(this,arguments);}
function MsButton(o){this.addCls('ms-button');this.addCls('unselectable');MsButton.superclass.constructor.apply(this,arguments);}
u.extend(MsButton,Button);MsButton.prototype.ctype='ms-button';MsButton.prototype.iconTplLeft='<img src="{src}">{text}';MsButton.prototype.iconTplRight='{text}<img src="{src}">';MsButton.prototype.title='';MsButton.prototype.textTpl='<span>{text}</span>';MsButton.prototype.html='<a tabindex="0" unselectable="on">{text}</a>';function CommonButton(o){this.addCls('common-button');CommonButton.superclass.constructor.apply(this,arguments);}
u.extend(CommonButton,MsButton);CommonButton.prototype.ctype='common-button';function PanelToolButton(o){this.addCls(u.sformat('panel-tool-button panel-tool-button-{0}',o.action));this.icon={};PanelToolButton.superclass.constructor.apply(this,arguments);}
u.extend(PanelToolButton,MsButton);PanelToolButton.prototype.ctype='tool-button';function CallButton(o){this.addCls('call-button');this.icon={};CallButton.superclass.constructor.apply(this,arguments);}
u.extend(CallButton,MsButton);CallButton.prototype.ctype='call-button';function RatingButton(o){this.addCls('rating-button');this.icon={};RatingButton.superclass.constructor.apply(this,arguments);}
u.extend(RatingButton,MsButton);RatingButton.prototype.ctype='rating-button';function LinklikeButton(o){this.addCls('text-button');LinklikeButton.superclass.constructor.apply(this,arguments);}
u.extend(LinklikeButton,MsButton);LinklikeButton.prototype.ctype='text-button';function ChatSendButton(o){this.addCls('chat-send-button');ChatSendButton.superclass.constructor.apply(this,arguments);}
u.extend(ChatSendButton,CommonButton);ChatSendButton.prototype.ctype='chat-send-button';function FunctionalButton(o){var ctype='functional-button-'+o.type;this.addCls('functional-button');this.addCls(ctype);this.ctype=ctype;this.icon={};FunctionalButton.superclass.constructor.apply(this,arguments);}
u.extend(FunctionalButton,MsButton);FunctionalButton.prototype.ctype='functional-button';FunctionalButton.prototype.trackOwnEvents=true;function RetentionMainButton(o){this.addCls('retention-main-button');RetentionMainButton.superclass.constructor.apply(this,arguments);}
u.extend(RetentionMainButton,CommonButton);RetentionMainButton.prototype.ctype='common-button-send';u.apply(u.ns(ns),{Button:Button,StandardButton:StandardButton,SmallButton:SmallButton,ToolButton:ToolButton,ToolButtonClose:ToolButtonClose,ToolButtonUnpin:ToolButtonUnpin,ToolButtonPin:ToolButtonPin,ToolButtonMinimize:ToolButtonMinimize,MsButton:MsButton,CommonButton:CommonButton,PanelToolButton:PanelToolButton,CallButton:CallButton,RatingButton:RatingButton,LinklikeButton:LinklikeButton,ChatSendButton:ChatSendButton,FunctionalButton:FunctionalButton,RetentionMainButton:RetentionMainButton});})(window,'uLiB.cmp');(function(g,ns){var ul=g.uLiB,u=ul.util,Component=ul.cmp.Component,msButtonClass=ul.cmp.MsButton,buttonClass=ul.cmp.Button,_$=u._$;function Menu(o){this.addCls('menu');this.autoEl={tag:'div'};this.zIndex=3;this.renderTo=o.o&&o.o['renderTo']?o.o['renderTo']:'body';this.trackClick=true;this.trackOwnEvents=true;Menu.superclass.constructor.apply(this,arguments);this.show(false);this.renderItems();}
u.extend(Menu,Component);Menu.prototype.ctype='menu';Menu.prototype.menuItemCls='menu-item';Menu.prototype.buildItem=function(config){if(u.isinstance(config,buttonClass)){config.addCls(this.menuItemCls);return config;}
return new msButtonClass(u.apply({cls:this.menuItemCls,onClick:u.bind(this._onItemClick,this)},config));};Menu.prototype.showAt=function(target,anchor){this.getEl().anchor(target,anchor,true);this.show(true);};Menu.prototype._onClick=function(cmp,deepCType,ctype,event,target,isOwnEvent){this.show(false);this.button.changeState('off');};Menu.prototype._onItemClick=function(item){this.onItemClick(item,item.action);};Menu.prototype.onItemClick=function(item,action){};Menu.prototype.getItem=function(action){var items=this.items;for(var i=0,it;(it=items[i]);i++){if(it.action===action){return it;}}
return null;};u.apply(u.ns(ns),{Menu:Menu});})(window,'uLiB.cmp');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$,Div=ul.el.Div;function Panel(o){this.addCls('panel');this.addCls(this.ctype);Panel.superclass.constructor.apply(this,arguments);}
u.extend(Panel,'uLiB.cmp.Component');Panel.prototype.ctype='panel';Panel.prototype.respectBannerPlace=true;Panel.prototype.titleCls='panel-title';Panel.prototype.titleIconCls='panel-title-icon';Panel.prototype.toolsCls='panel-tools';Panel.prototype.headerCls='panel-title';Panel.prototype.bodyCls='panel-body';Panel.prototype.buttonsCls='panel-buttons';Panel.prototype.html='<div/>';Panel.prototype.title=null;Panel.prototype.tools=null;Panel.prototype.subtitle=null;Panel.prototype.items=null;Panel.prototype.buttons=null;Panel.prototype.footer=null;Panel.prototype.afterRender=function(){Panel.superclass.afterRender.apply(this,arguments);if(this.title){this.titleEl=new Div({cls:this.titleCls,text:this.title,renderTo:this.getEl()});if(this.titleIconCls!=Panel.prototype.titleIconCls){this.titleIconCls=[Panel.prototype.titleIconCls,this.titleIconCls].join(' ');}
this.titleEl.prepend(new Div({cls:this.titleIconCls}));}
this.subtitleEl=this._renderElement('subtitle');this._renderContainer(['tools','items','buttons']);this.footerEl=this._renderElement('footer');};Panel.prototype._renderElement=function(name){var el;if(_$.isPlainObject(this[name])){el=new Div(this[name]);}else if(this[name]instanceof _$){el=this[name];}else if(_$.type(this[name])=='string'){el=_$(this[name]);}
if(el){el.addClass(u.getCssSelector('panel-'+name,true));this.getEl().append(el);}};Panel.prototype._renderContainer=function(name,opts){if(_$.type(name)=='array'){for(var i=0,co;(co=name[i]);i++){_$.type(co)=='string'?this._renderContainer(co):this._renderContainer(co.name,co.opts);}
return;}
var items=this[name],container={tools:'tools',items:'body',buttons:'buttons'}[name],containerElName=container+'El',tmpItems=[];if(!items){return;}
this.initialItems=this.initialItems||{};this.initialItems[name]=items;if(!this[containerElName]){this[containerElName]=new Div({cls:this[container+'Cls']});}
for(var i=0,it;(it=items[i]);i++){if(_$.type(it)=='string'){tmpItems.push(_$(it).appendTo(this[containerElName]));}else if(_$.type(it)=='object'&&it.__class){tmpItems.push(new it.__class(u.apply({renderTo:this[containerElName]},it)));}else if(u.isInstance(it,'uLiB.cmp.Component')){tmpItems.push(it);this[containerElName].append(it.getEl());}else if(_$.type(it)=='function'){tmpItems.push(new it(u.apply({renderTo:this[containerElName]},opts||{})));}else{tmpItems.push(it);this[containerElName].append(it);}}
this[name]=tmpItems;this[containerElName].appendTo(this.getEl());};u.apply(u.ns(ns),{Panel:Panel});})(window,'uLiB.cmp');(function(g,ns){var ul=g.uLiB,u=ul.util,Button=ul.cmp.Button,_$=u._$;function FileUpload(o){this.addCls('file-upload');FileUpload.superclass.constructor.apply(this,arguments);var fileInput=this.getEl().find('input[type=file]');if(this.validExtensions){fileInput.attr('accept','.'+this.validExtensions.join(',.'));}else{fileInput.removeAttr('accept');}
fileInput.fileupload({action:this.action||'/upload/',onSubmit:this.onSubmit,onReceive:this.onReceive,onUnsupportedFileExtension:this.onUnsupportedFileExtension,validExtensions:this.validExtensions});this.getEl().mousemove(function(e){var off=_$(this).offset(),offT=off.top,input=_$(this).find('input'),width=input.width();input.css({left:e.pageX-(width-30),top:e.pageY-offT-10})});}
u.extend(FileUpload,Button);FileUpload.prototype.ctype='file-upload';FileUpload.prototype.html='<a tabindex="0">{text}<input type="file" name="{id}" id="{id}-file-upload"/></a>';FileUpload.prototype.onSubmit=function(fileName){console.log('onSubmit',arguments)};FileUpload.prototype.onReceive=function(response){var resp=JSON.stringify(response);console.log('onReceive',resp,arguments)};FileUpload.prototype.onUnsupportedFileExtension=function(currentExtension,validExtensions){console.log('onUnsupportedFileExtension',arguments)};FileUpload.prototype.validExtensions=null;FileUpload.prototype.setUploadUrl=function(url){this.getEl().find('form').attr('action',url);};u.apply(u.ns(ns),{FileUpload:FileUpload});})(window,'uLiB.cmp');(function(g,ns){var u=g.uLiB.util,Form=g.uLiB.form.Form,_$=u._$;function FormPanel(o){this.addCls('form-panel');FormPanel.superclass.constructor.apply(this,arguments);}
u.extend(FormPanel,'uLiB.cmp.Panel');u.mixIn(FormPanel,Form);u.apply(u.ns(ns),{FormPanel:FormPanel});})(window,'uLiB.cmp');(function(g,ns){var ul=g.uLiB,u=ul.util,FormPanel=ul.cmp.FormPanel,ToolButtonClose=ul.cmp.ToolButtonClose,_$=u._$;function ModalPanel(o){var targetEl=this.targetEl||(u.isInstance(o.target,'uLiB.cmp.Component')?o.target.getEl():o.target);targetEl=u.ensure$(targetEl);this.renderTo='body';this.trackClick=true;ModalPanel.superclass.constructor.apply(this,arguments);var maskEl=u.maskElement(targetEl,this.isMaskPositionFixed);this.show(false);g.setTimeout(u.bind(function(){this.show(true);if(this.isElPositionFixed){this.addCls('form-panel-fixed');}
this.getEl().center(targetEl.is('body')?undefined:targetEl,'hv',true).css('z-index',u.comagicTopZIndex()+1);},this),100);}
u.extend(ModalPanel,FormPanel);ModalPanel.prototype.respectBannerPlace=false;ModalPanel.prototype.ctype='modal-panel';ModalPanel.prototype.tools=[ToolButtonClose];ModalPanel.prototype.onDestroy=function(){ModalPanel.superclass.onDestroy&&ModalPanel.superclass.onDestroy.apply(this,arguments);u.unmaskElement(this.targetEl);};u.apply(u.ns(ns),{ModalPanel:ModalPanel});})(window,'uLiB.cmp');(function(g,ns){var ul=g.uLiB,u=ul.util,Panel=ul.cmp.Panel,_$=u._$;function PopupMessagePanel(o){this.renderTo='body';if(o['banner_skin']=='flat'){this.addCls({info:'popup-message-panel-info',error:'popup-message-panel-error'}[o['type']]);}
this.ttl=2000;this.hidingDuration=400;PopupMessagePanel.superclass.constructor.call(this,o);!o.doNotHide&&g.setTimeout(u.bind(this.onTtlExpired,this),this.ttl);this.getEl().css('z-index',u.comagicTopZIndex()+1);}
u.extend(PopupMessagePanel,Panel);PopupMessagePanel.prototype.ctype='popup-message';PopupMessagePanel.prototype.respectBannerPlace=true;PopupMessagePanel.prototype.onTtlExpired=function(){this.getEl().hide(this.hidingDuration,u.bind(function(){this.afterClose&&this.afterClose(this);this.destroy();},this));};u.apply(u.ns(ns),{PopupMessagePanel:PopupMessagePanel});})(window,'uLiB.cmp');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$;function FieldValidator(o){}
FieldValidator.prototype.errorMessage='';FieldValidator.prototype.isValid=function(val,field){return true;};FieldValidator.prototype.validate=function(field){if(field.allowBlank&&field.getValue()===g.uLiB.field.Field.prototype.emptyValue){return true;}
var isValid=this.isValid(field.getValidationValue(),field);field.markInvalid&&field.setError(isValid?null:this.errorMessage,this.name,this);return isValid;};function NotEmptyFieldValidator(){NotEmptyFieldValidator.superclass.constructor.apply(this,arguments);this.name='notempty';this.errorMessage='Необходимо заполнить';}
u.extend(NotEmptyFieldValidator,FieldValidator);NotEmptyFieldValidator.prototype.isValid=function(val,field){return val!==g.uLiB.field.Field.prototype.emptyValue;};function RegexpFieldValidator(o){u.apply(this,o);NotEmptyFieldValidator.superclass.constructor.apply(this,arguments);this.errorMessage='Поле содержит недопустимые символы';}
u.extend(RegexpFieldValidator,FieldValidator);RegexpFieldValidator.prototype.isValid=function(val,field){return this.regexp.test(val);};function NumberFieldValidator(){NumberFieldValidator.superclass.constructor.apply(this,arguments);this.name='number';this.regexp=/^\d+$/;this.errorMessage='Поле должно содержать только цифры';}
u.extend(NumberFieldValidator,RegexpFieldValidator);function EmailFieldValidator(){EmailFieldValidator.superclass.constructor.apply(this,arguments);this.name='email';this.noErrorMessage=!u.C.IS_TOUCH_DEVICE;this.regexp=u.C.RE_EMAIL;this.errorMessage='Пожалуйста, введите адрес электронной почты';}
u.extend(EmailFieldValidator,RegexpFieldValidator);function PhoneFieldValidator(){PhoneFieldValidator.superclass.constructor.apply(this,arguments);this.name='phone';this.noErrorMessage=!u.C.IS_TOUCH_DEVICE;this.regexp=/^\d{11}$/;this.errorMessage='Поле должно содержать 11 цифр';}
u.extend(PhoneFieldValidator,RegexpFieldValidator);function MaxLengthFieldValidator(o){this.name='maxlength';}
u.extend(MaxLengthFieldValidator,FieldValidator);MaxLengthFieldValidator.prototype.isValid=function(val,field){return val.length<=field.maxLength;};MaxLengthFieldValidator.prototype.errorMessage=function(val,field){return u.sformat('Максимальная длина: {0}',field.maxLength);};u.apply(u.ns(ns),{NotEmptyFieldValidator:NotEmptyFieldValidator,RegexpFieldValidator:RegexpFieldValidator,NumberFieldValidator:NumberFieldValidator,EmailFieldValidator:EmailFieldValidator,PhoneFieldValidator:PhoneFieldValidator,MaxLengthFieldValidator:MaxLengthFieldValidator});})(window,'uLiB.field');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$,Element=ul.el.Element,Component=ul.cmp.Component,NotEmptyFieldValidator=ul.field.NotEmptyFieldValidator,NumberFieldValidator=ul.field.NumberFieldValidator,EmailFieldValidator=ul.field.EmailFieldValidator,PhoneFieldValidator=ul.field.PhoneFieldValidator,MaxLengthFieldValidator=ul.field.MaxLengthFieldValidator;function Field(o){o=o||{};this.addCls('field');this._validators=[];if(o.validators){this._validators=this._validators.concat(o.validators);}
this.fieldContainerCls='field-container';this.fieldWrapperCls='field-wrapper';this.fieldInnerErrorCls='field-inner-error';this.fieldErrorNoMessageCls='field-error-no-message';this.errorIconCls='error-icon';this.value=o.value||'';Field.superclass.constructor.apply(this,arguments);if(this.extraFieldWrapperCls){u.addCls(this.wrapperEl,this.extraFieldWrapperCls);}}
u.extend(Field,Component);Field.prototype.ctype='field';Field.prototype.extraFieldWrapperCls=null;Field.prototype.labelSeparator='';Field.prototype.mandatoryMarkSymbol='';Field.prototype.labelWidth=105;Field.prototype.valueFilterCharsRegexp=null;Field.prototype.stripCharsRegexp=null;Field.prototype.allowBlank=true;Field.prototype.markInvalid=true;Field.prototype.emptyValue='';Field.prototype.tooltipType='title';Field.prototype.blankImgSrc=u.C.SRC_IMG_BLANK;Field.prototype.__validators={notempty:new NotEmptyFieldValidator(),number:new NumberFieldValidator(),email:new EmailFieldValidator(),phone:new PhoneFieldValidator(),maxlength:new MaxLengthFieldValidator()};Field.prototype.initComponent=function(){Field.superclass.initComponent.apply(this,arguments);if(!this.allowBlank){this.addValidator('notempty',0);}
if(this.maxLength!==undefined){this.addValidator('maxlength');}};Field.prototype.addValidator=function(validatorName,pos){pos!==undefined?this._validators.splice(pos,0,validatorName):this._validators.push(validatorName);};Field.prototype._getTooltipEl=function(){return this.getInputEl();};Field.prototype.beforeRender=function(){Field.superclass.beforeRender.apply(this,arguments);this.mandatoryMark=this.allowBlank?'':Field.prototype.mandatoryMarkSymbol;};Field.prototype.render=function(){var renderTo=this.renderTo,width=this.width,style=this.style;delete this.renderTo;delete this.width;delete this.style;Field.superclass.render.apply(this,arguments);var container=_$(u.sformat('<div class="{fieldContainerCls}">'+
(this.label?'<label for="{id}">{label}{mandatoryMark}{labelSeparator}</label>':'')+'<div class="{fieldWrapperCls}"><img class="{errorIconCls}" src="{blankImgSrc}"></div>'+'</div>',this));renderTo&&container.appendTo(renderTo);this.inputEl=this.getEl();this.wrapperEl=container.find('.'+u.getCssSelector(this.fieldWrapperCls,true));this.wrapperEl.append(this.inputEl);this.el=container;if(width!==undefined){this.el.width(width);}
if(style!==undefined){this.el.css(style);}
if(this.value){this.setValue(this.value);}
if(this.placeholder){this.getInputEl().watermark(this.placeholder,{className:u.getCssSelector('watermark',true)});}};Field.prototype.initEvents=function(){Field.superclass.initEvents.apply(this,arguments);var me=this,inputEl=this.getInputEl();if(!inputEl){return;}
inputEl.on('keyup',u.bind(this._doProcessValue,this));inputEl.on('blur',u.bind(this._doProcessValue,this));if(this.tooltipType==='rich'){inputEl.on('focus',u.bind(this._onInputFocus,this));}};Field.prototype._onInputFocus=function(event){this.setError(false);};Field.prototype._doProcessValue=function(event){var me=this,inputEl=this.getInputEl(),fn=function(){var val=inputEl.val();if(me.lastErrorMessage===val){return;}
me.value=val;if(me.stripCharsRegexp){me.value=inputEl.val(inputEl.val().replace(me.stripCharsRegexp,''));}};window.setTimeout(fn,100);};Field.prototype.getInputEl=function(){return this.inputEl||this.getEl();};Field.prototype._setRawValue=function(val){this.getInputEl().val(val);};Field.prototype._setValue=function(){this._setRawValue(this.value);};Field.prototype.setValue=function(val){this.value=val;if(this.getInputEl()){this._setValue();}};Field.prototype.getValue=function(){var value=this.value;if(this.valueFilterCharsRegexp){value=value.replace(this.valueFilterCharsRegexp,'');}
return value;};Field.prototype.getValidationValue=function(){return this.getValue();};Field.prototype.isValid=function(){for(var i=0,v;(v=this._validators[i]);i++){if(!Field.prototype.__validators[v].validate(this)){return false;}}
return true;};Field.prototype.setError=function(message,errorType,validator){var errorTypeTxt=this[errorType+'Text'];if(message&&errorTypeTxt){message=errorTypeTxt;}
if(message&&u._$.type(message)==='function'){message=message.call(this,this.getValidationValue(),this);}
if(message&&validator&&!validator.noErrorMessage){this.lastErrorMessage=message;this._setTooltip(message||null);}
var el=this.getEl(),inputEl=this.getInputEl();if(message){validator.noErrorMessage&&inputEl.addClass(u.getCssSelector(this.fieldErrorNoMessageCls,true));inputEl.addClass(u.getCssSelector(u.C.CSS_FIELD_ERROR,true));el.addClass(u.getCssSelector(u.C.CSS_FIELD_CONTAINER_ERROR,true));}else{this._setTooltip();inputEl.addClass(this.fieldErrorNoMessageCls);inputEl.removeClass(u.getCssSelector(u.C.CSS_FIELD_ERROR,true));el.removeClass(u.getCssSelector(u.C.CSS_FIELD_CONTAINER_ERROR,true));}};Field.prototype._setRichTooltip=function(tooltipText,el){if(this.renderTooltipInside){var inputEl=this.getInputEl(),cls=u.getCssSelector(this.fieldInnerErrorCls,true);if(tooltipText){this._setRawValue(tooltipText);inputEl.addClass(cls);}else{this._setRawValue(this.value);inputEl.removeClass(cls);}}else{Field.superclass._setRichTooltip.apply(this,arguments);}};function TextField(o){this.autoEl={tag:'input'};TextField.superclass.constructor.apply(this,arguments);}
u.extend(TextField,Field);function NumberField(o){NumberField.superclass.constructor.apply(this,arguments);this.addValidator('number');}
u.extend(NumberField,TextField);function PhoneField(o){this.mask='+7 (999) 999-99-99';this.valueFilterCharsRegexp=/[^\d]/g;PhoneField.superclass.constructor.apply(this,arguments);this.addValidator('phone');if(_$.type(_$.fn.mask)=='function'){this.getInputEl().mask(this.mask);}
this.getInputEl().attr('type','tel');}
u.extend(PhoneField,NumberField);_$.mask&&(_$.mask.autoclear=false);function CaptchaField(o){var me=this;this._captchaUrlProp='url';this._captchaKeyProp='key';this.allowBlank=false;this.addCls('captcha-field');this.tooltipGravity='nw';this.tooltipOptions={offsetH:-41};CaptchaField.superclass.constructor.apply(this,arguments);}
u.extend(CaptchaField,TextField);CaptchaField.prototype.autoRefresh=false;CaptchaField.prototype.imagePosition='top';CaptchaField.prototype.extraFieldWrapperCls='captcha-field-wrapper';CaptchaField.prototype.render=function(){CaptchaField.superclass.render.apply(this,arguments);this.imgEl=new Element({tag:'img',cls:'captcha-field-image'});this.wrapperEl[this.imagePosition==='top'?'prepend':'append'](this.imgEl);this.autoRefresh&&this.refreshCaptcha();};CaptchaField.prototype.getCaptchaProvider=function(){var me=this;return this['is_preview']?{get_captcha:function(callback){var ret={};ret[me._captchaUrlProp]='http://ksv.dev.ulab.ru/captcha.jpg';ret[me._captchaKeyProp]='SDAFdf3f2fqw3fw3efdsAFSDAf23';callback(ret);}}:window.Comagic.Captcha;};CaptchaField.prototype.refreshCaptcha=function(){this.setValue(Field.prototype.emptyValue);this.getCaptchaProvider().get_captcha(u.bind(this._onCaptcha,this));};CaptchaField.prototype._onCaptcha=function(resp){this._setCaptchaUrl(resp[this._captchaUrlProp]);this.captchaKey=resp[this._captchaKeyProp];};CaptchaField.prototype._setCaptchaUrl=function(url){this.imgEl.attr('src',url);};CaptchaField.prototype.getValidationValue=function(){return CaptchaField.superclass.getValue.apply(this);};CaptchaField.prototype.getValue=function(){return{captcha_key:this.captchaKey,captcha_val:CaptchaField.superclass.getValue.apply(this)}};function TextAreaField(o){this.autoEl={tag:'textarea'};TextAreaField.superclass.constructor.apply(this,arguments);}
u.extend(TextAreaField,Field);TextAreaField.prototype.applySlimScroll=function(height,force){if(u._$.type(height)==='boolean'){force=height;}
if(!this.slimscrollApplied||force){this.getInputEl().slimscroll({height:height||'auto'});this.slimscrollApplied=true;}};u.apply(u.ns(ns),{Field:Field,TextField:TextField,NumberField:NumberField,PhoneField:PhoneField,CaptchaField:CaptchaField,TextAreaField:TextAreaField});})(window,'uLiB.field');(function(g,ns){var ul=g.uLiB,u=ul.util,Div=ul.el.Div,Component=ul.cmp.Component,_$=u._$;function WayItem(o){this.cls='way-item';this.ctype=o.ctype;this.text=o.title;WayItem.superclass.constructor.apply(this,arguments);this.addCls(this.ctype);}
u.extend(WayItem,Component);WayItem.prototype.html='<div></div>';WayItem.prototype.getTextEl=function(){return this.getEl();};WayItem.prototype.setText=function(text){var textEl=this.getTextEl();textEl&&textEl.text(text);this.setTooltip(text);};WayItem.prototype.afterRender=function(){WayItem.superclass.afterRender.apply(this,arguments);this.setText(this.text);};function BannerWayItem(o){BannerWayItem.superclass.constructor.apply(this,arguments);}
u.extend(BannerWayItem,WayItem);BannerWayItem.prototype.render=function(){this.html=this.isPrimary?WayItem.prototype.html:'<div/>';BannerWayItem.superclass.render.apply(this,arguments);if(this.isPrimary){this.iconEl=new Div({cls:'icon',renderTo:this,children:[{tag:'img',src:u.C.SRC_IMG_BLANK}]});this.textEl=new Div({cls:'text',renderTo:this,unselectable:'on'});this.labelEl=new Div({cls:'way-label',renderTo:this,text:this.bannerLabel,unselectable:'on'});}};BannerWayItem.prototype.getTextEl=function(){return this.isPrimary?this.textEl:null;};function SliderWayItem(){this.autoEl={tag:'div',defaults:{unselectable:'on'},children:[{tag:'div',cls:'slider-way-item-icon',unselectable:'on'},{tag:'div',cls:'slider-way-item-text',unselectable:'on'}]};SliderWayItem.superclass.constructor.apply(this,arguments);}
u.extend(SliderWayItem,WayItem);SliderWayItem.prototype.getTextEl=function(){return this.getEl().find(u.getCssSelector('.slider-way-item-text'));};function ButtonsWayItem(){this.autoEl={tag:'div',children:[{tag:'div',cls:'buttons-way-item-inner'}]};ButtonsWayItem.superclass.constructor.apply(this,arguments);}
u.extend(ButtonsWayItem,WayItem);ButtonsWayItem.prototype.getTextEl=function(){return null;};u.apply(u.ns(ns),{WayItem:WayItem,BannerWayItem:BannerWayItem,SliderWayItem:SliderWayItem,ButtonsWayItem:ButtonsWayItem});})(window,'uLiB.banner.label');(function(g,ns){var ul=g.uLiB,u=ul.util,Component=ul.cmp.Component,_$=u._$;function AbstractLabel(o){if(!this.ctype||!this.connectWayItemClass){u.error('Properties "ctype" and "connectWayItemClass" must be specified');}
this.trackClick=true;this.html='<div/>';this.connectWays=[];this.active=null;var isConsultantEnabled=this.hasConsultantWayEnabled(o);this.doActivate=isConsultantEnabled&&o['available_connect_ways'].length>1;this.isConsultantSingleWay=isConsultantEnabled&&o['available_connect_ways'].length==1;AbstractLabel.superclass.constructor.apply(this,arguments);this.addCls('abstract-label');this.updateSingleWayItem();this['is_preview']&&this.show(true);}
u.extend(AbstractLabel,Component);AbstractLabel.prototype.ctype='label';AbstractLabel.prototype.renderHidden=true;AbstractLabel.prototype.connectWayItemClass=null;AbstractLabel.prototype.singleWayClsTpl='single-way-{0}';AbstractLabel.prototype.respectBannerPlace=true;AbstractLabel.prototype.monitorResize=true;AbstractLabel.prototype.monitorZoom=false;AbstractLabel.prototype.respectIsBannerDefaultMinimize=true;AbstractLabel.prototype.animationEnabled=true;AbstractLabel.prototype.stateful=true;AbstractLabel.prototype.stateId='label';AbstractLabel.prototype.states=[{}];AbstractLabel.prototype.hasGlobalState=true;AbstractLabel.prototype.initComponent=function(){AbstractLabel.superclass.initComponent.apply(this,arguments);this.buildInnerElements();};AbstractLabel.prototype.buildInnerElements=function(){};AbstractLabel.prototype.hasConsultantWayEnabled=function(o){return u.hasConnectWayEnabled(o||this.o,u.C.CW_CONSULTANT);};AbstractLabel.prototype.getSingleWayCType=function(){return(this.active!==false&&this.hasConsultantWayEnabled()?this._getConsultantItem():this._getFirstNonConsultantItem())['ctype'];};AbstractLabel.prototype._getActiveWaysCount=function(){var len=this['available_connect_ways'].length;return this.active||!this.hasConsultantWayEnabled()?len:(len-1);};AbstractLabel.prototype._hasSingleActiveWayCount=function(){return this._getActiveWaysCount()===1;};AbstractLabel.prototype.getSingleWayCls=function(){if(this._getActiveWaysCount()!==1){return'';}
return u.sformat(this.singleWayClsTpl,this.getSingleWayCType());};AbstractLabel.prototype.updateSingleWayItem=function(){this.removeCls(u.sformat(this.singleWayClsTpl,''),true);var cls=this.getSingleWayCls();this.addCls(cls);if(cls){this.addCls(u.sformat(this.singleWayClsTpl,'common'));var el=this.labelCmp.getEl?this.labelCmp.getEl():this.labelCmp;el.attr(u.C.ATTR_COMAGIC_CTYPE,this.getSingleWayCType());}};AbstractLabel.prototype.processConnectWays=function(){var ws=this['available_connect_ways'];for(var i=0,w;(w=ws[i]);i++){this.addConnectWay(w);}};AbstractLabel.prototype.addConnectWay=function(wayMnemonic){var title=this['cw_'+wayMnemonic+'_title'];this.connectWays.push(new this.connectWayItemClass({ctype:wayMnemonic,title:title,isPrimary:wayMnemonic===this['preferred_connect_way'],renderTo:this._getWayItemsContainer(wayMnemonic),bannerLabel:this['banner_label']}));};AbstractLabel.prototype._getConnectWayItem=function(mnemonic){var ws=this.connectWays;for(var i=0,w;(w=ws[i]);i++){if(_$.type(mnemonic)==='string'&&w.ctype===mnemonic){return w;}
if(_$.type(mnemonic)==='function'&&mnemonic(w.ctype)){return w;}}
return null;};AbstractLabel.prototype._getConsultantItem=function(){return this._getConnectWayItem(u.C.CW_CONSULTANT);};AbstractLabel.prototype._getFirstNonConsultantItem=function(){return this._getConnectWayItem(function(ctype){return ctype!=u.C.CW_CONSULTANT;});};AbstractLabel.prototype._onActivate=function(){this[this.active?'_onGettingActive':'_onGettingInactive']();};AbstractLabel.prototype._onGettingInactive=function(){this._getConsultantItem().getEl().remove();};AbstractLabel.prototype._onGettingActive=function(){var ci=this._getConsultantItem();ci.reRender({renderTo:this._getWayItemsContainer(ci)});};AbstractLabel.prototype._getWayItemsContainer=function(item){return null;};AbstractLabel.prototype.activate=function(active){if(active===this.active){return;}
var isFirstActivation=(this.active===null);this.active=active;this.updateSingleWayItem();if(this['is_not_showing_unactive_banner']||this.isConsultantSingleWay){this.show(this.active);return;}else if(isFirstActivation){this.show(true);}
if(!this.doActivate){return;}
this._onActivate();};AbstractLabel.prototype.show=function(){AbstractLabel.superclass.show.apply(this,arguments);this.hasGlobalState&&this.restorePosition();};u.apply(u.ns(ns),{AbstractLabel:AbstractLabel});})(window,'uLiB.banner.label');(function(g,ns){var ul=g.uLiB,u=ul.util,b=ul.banner,Element=ul.el.Element,Div=ul.el.Div,BannerWayItem=b.label.BannerWayItem,Component=ul.cmp.Component,AbstractLabel=b.label.AbstractLabel,_$=u._$;function Banner(o){Banner.superclass.constructor.apply(this,arguments);}
u.extend(Banner,AbstractLabel);Banner.prototype.cls='banner-container';Banner.prototype.connectWayItemClass=BannerWayItem;Banner.prototype.expanderClsTpl='expander-{0}';Banner.prototype.animationKey='Banner';Banner.prototype.buildInnerElements=function(){this.buildLabelEl();this.buildExpandedEl();};Banner.prototype.buildLabelEl=function(){this.labelCmp=new Component({html:'<div>'+'<img unselectable src="{imgSrc}">'+'<span unselectable>{bannerLabel}</span>'+'</div>',cls:'label',parentCmp:this,imgSrc:u.C.SRC_IMG_BLANK,bannerLabel:this['banner_label']||''});this.add(this.labelCmp);};Banner.prototype.buildExpandedEl=function(){var secondariesCls='secondaries';this.expandedCmp=new Component({cls:'expanded',html:'<div/>',parentCmp:this});this.expandedCmp.add(new Element({cls:secondariesCls,tag:'div'}));if(this.respectIsBannerDefaultMinimize){this['is_banner_default_minimize']&&this.expandedCmp.getEl().hide();}else{this.expandedCmp.getEl().hide();}
this.secondariesEl=this.expandedCmp.getEl().find('div');this.setSecondariesCls(this['available_connect_ways'].length-1);this.add(this.expandedCmp);this.expandedCmp.add(new Component({cls:'collapser',html:'<div>×</div>',ctype:'collapser',zIndex:1}));this.processConnectWays();};Banner.prototype.getWaysCount=function(){var count=this['available_connect_ways'].length;if(this.active===false){count-=1;}
return count;};Banner.prototype.setSecondariesCls=function(count){if(!this.secondariesEl){return;}
if(count===undefined&&this.doActivate){count=this['available_connect_ways'].length-(this.active?1:2);}else if(count===undefined&&!this.doActivate){count=this['available_connect_ways'].length-1;}
var clses=['secondaries-none','secondaries-single','secondaries-couple'];for(var i=0,cls;(cls=clses[i]);i++){this.expandedCmp.getEl().removeClass(u.getCssSelector(cls,true));}
this.expandedCmp.getEl().addClass(u.getCssSelector(clses[count],true));};Banner.prototype._onActivate=function(){this.setSecondariesCls();Banner.superclass._onActivate.apply(this,arguments);};Banner.prototype._onGettingInactive=function(){Banner.superclass._onGettingInactive.apply(this,arguments);if(this['preferred_connect_way']==u.C.CW_CONSULTANT){var nci=this._getFirstNonConsultantItem();nci.getEl().remove();nci.reRender({isPrimary:true,renderTo:this.expandedCmp});}};Banner.prototype._onGettingActive=function(){Banner.superclass._onGettingActive.apply(this,arguments);if(this['preferred_connect_way']==u.C.CW_CONSULTANT){var count=this.getWaysCount();var nci=this._getFirstNonConsultantItem();nci.getEl().remove();nci.reRender({isPrimary:false,renderTo:this.secondariesEl});}};Banner.prototype._getWayItemsContainer=function(item){var isPrimary=u._$.type(item)==='string'?item===this['preferred_connect_way']:item.isPrimary;return isPrimary?this.expandedCmp:this.secondariesEl;};Banner.prototype.expand=function(expand){var me=this,expanderCls=this._getExpanderCls();if(expand){this.labelCmp.getEl().hide({effect:'fade',duration:uLiB.util.AnimationManager.durationOut,complete:function(){me.expandedCmp.getEl().show({effect:'fade',duration:uLiB.util.AnimationManager.durationIn});me.removeCls(expanderCls);}});}else{this.expandedCmp.getEl().hide({effect:'fade',duration:uLiB.util.AnimationManager.durationOut,complete:function(){me.labelCmp.getEl().show({effect:'fade',duration:uLiB.util.AnimationManager.durationIn});!me._hasSingleActiveWayCount()&&me.labelCmp.getEl().attr(u.C.ATTR_COMAGIC_CTYPE,'expander');me.addCls(expanderCls);}});}
this.onExpand&&this.onExpand(expand);};Banner.prototype._getPrimaryWayMnemonic=function(){return this['preferred_connect_way'];};Banner.prototype._getExpanderCls=function(){return u.sformat(this.expanderClsTpl,this._getPrimaryWayMnemonic());};Banner.prototype.show=function(show){this.expand(!this['is_banner_default_minimize']);Banner.superclass.show.apply(this,arguments);if(show&&this['is_banner_default_minimize']&&!this.isFirstShow){this.isFirstShow=true;}};u.apply(u.ns(ns),{Banner:Banner});})(window,'uLiB.banner.label');(function(g,ns){var ul=g.uLiB,u=ul.util,Component=ul.cmp.Component,AbstractLabel=ul.banner.label.AbstractLabel,ButtonsWayItem=ul.banner.label.ButtonsWayItem,_$=u._$;function Buttons(o){this.addCls('buttons');Buttons.superclass.constructor.apply(this,arguments);}
u.extend(Buttons,AbstractLabel);Buttons.prototype.cls='buttons-container';Buttons.prototype.expandedCls='expanded';Buttons.prototype.connectWayItemClass=ButtonsWayItem;Buttons.prototype.animationKey='Buttons';Buttons.prototype.buildInnerElements=function(){this.buildExpandedEl();};Buttons.prototype.buildExpandedEl=function(){this.wayItemsEl=this.expandedCmp=new Component({cls:this.expandedCls,html:'<div/>'});this.add(this.expandedCmp);this.processConnectWays();this.expandedCmp.add(new uLiB.el.Div({cls:'clearer'}));};Buttons.prototype._getWayItemsContainer=function(){return this.wayItemsEl;};Buttons.prototype.buildCollapsedEl=function(){};Buttons.prototype.expand=function(){};Buttons.prototype.updateSingleWayItem=function(){};Buttons.prototype._onActivate=function(){this.expandedCmp.getInnerEl('clearer').remove();Buttons.superclass._onActivate.apply(this,arguments);this.expandedCmp.add(new uLiB.el.Div({cls:'clearer'}));};u.apply(u.ns(ns),{Buttons:Buttons});})(window,'uLiB.banner.label');(function(g,ns){var ul=g.uLiB,u=ul.util,Div=ul.el.Div,Element=ul.el.Element,Component=ul.cmp.Component,AbstractLabel=ul.banner.label.AbstractLabel,Banner=ul.banner.label.Banner,SliderWayItem=ul.banner.label.SliderWayItem,_$=u._$;function Slider(o){if(o.banner_skin=='touch'){o.monitorResize=false;o.monitorZoom=true;}
Slider.superclass.constructor.apply(this,arguments);}
u.extend(Slider,AbstractLabel);Slider.prototype.cls='slider-container';Slider.prototype.expandedCls='expanded';Slider.prototype.arrowWrapperCls='img-wrapper';Slider.prototype.animationKey='Slider';Slider.prototype.connectWayItemClass=SliderWayItem;Slider.prototype.buildInnerElements=function(){this.buildLabelEl();this.buildExpandedEl();this.buildCollapsedEl();};Slider.prototype.buildLabelEl=function(){this.labelCmp=new Div({cls:'label',defaults:{unselectable:'on'},children:[{tag:'img',src:u.C.SRC_IMG_BLANK},{tag:'span',text:this['banner_label']}]});this.add(this.labelCmp);};Slider.prototype.buildExpandedEl=function(){this.expandedCmp=new Component({cls:this.expandedCls,html:'<div/>',animationKey:'slider-expanded',parentCmp:this});this.expandedCmp.add(new Div({cls:'slider-expanded-label-container',ctype:'collapser',defaults:{unselectable:'on'},children:[{tag:'span',text:this['banner_label']},{tag:'div',cls:this.arrowWrapperCls,children:[{tag:'img',src:u.C.SRC_IMG_BLANK}]}]}));this.wayItemsEl=new Div({cls:'connect-way-items'});this.expandedCmp.add(this.wayItemsEl);this.expandedCmp.show(false);this.add(this.expandedCmp);this.processConnectWays();};Slider.prototype.buildCollapsedEl=function(){this.collapsedCmp=new Component({ctype:'expander',cls:'collapsed',html:'<div/>',animationKey:'slider-collapsed',parentCmp:this});this.collapsedCmp.add(new Element({tag:'span',text:this['banner_label'],cls:'slider-collapsed-label',unselectable:'on'}));this.collapsedCmp.add(new Element({tag:'div',cls:this.arrowWrapperCls,children:[{tag:'img',src:u.C.SRC_IMG_BLANK}]}));this.collapsedCmp.show(true);this.add(this.collapsedCmp);};Slider.prototype.expand=function(expand){if(expand){this.expandedCmp.show(true,true);this.collapsedCmp.show(false,true);}else{this.expandedCmp.show(false,true);this.collapsedCmp.show(true,true);}
this.onExpand&&this.onExpand(expand);};Slider.prototype.addConnectWay=function(wayMnemonic){this.connectWays.push(new this.connectWayItemClass({ctype:wayMnemonic,renderTo:this.wayItemsEl,title:this['cw_'+wayMnemonic+'_title']}));};Slider.prototype._getWayItemsContainer=function(isPrimary){return this.wayItemsEl;};u.apply(u.ns(ns),{Slider:Slider});})(window,'uLiB.banner.label');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$;function PopupMessagePanel(o){g.setTimeout(u.bind(this.onTtlExpired,this),this.ttl);this.addCls('popup-message-panel');var code=o.code,textObj=u.apply({},this.codeToText[code]),codeType=code.charAt(0);u.apply(this,textObj);this.processCode(code);if(textObj.tpl){textObj.text=this.processTpl();}
this.text=textObj.text||'';this.zIndex=11;this.addCls(this.codeTypeToCls[codeType]);this.respectBannerPlace=false;PopupMessagePanel.superclass.constructor.apply(this,arguments);this.show(true);}
u.extend(PopupMessagePanel,'uLiB.cmp.Component');PopupMessagePanel.prototype.ctype='popup-message-panel';PopupMessagePanel.prototype.renderHidden=true;PopupMessagePanel.prototype.ownerComponentPadding=10;PopupMessagePanel.prototype.animationEnabled=true;PopupMessagePanel.prototype.animationKey='PopupMessagePanel';PopupMessagePanel.prototype.html=''+'<div>'+'<div><h1>{title}</h1><p>{text}</p></div>'+'</div>';PopupMessagePanel.prototype.ttl=2000;PopupMessagePanel.prototype.codeTypeToCls={'0':'popup-message-panel-success','1':'popup-message-panel-failure','9':'popup-message-panel-system'};PopupMessagePanel.prototype.codeToText={'010':{title:'Чат отправлен',tpl:'на почту {email}'},'110':{title:'Отправка не удалась'},'020':{title:'Ожидайте звонка',text:'Мы позвоним в течение минуты'},'121':{title:'Неверно введен код'},'122':{title:'Система не отвечает',text:'В данный момент звонок невозможен'},'124':{title:'Система не отвечает',text:'Повторите попытку через минуту'},'030':{title:'Заявка принята',text:'Спасибо за обращение'}};PopupMessagePanel.prototype.respectBannerPlace=true;PopupMessagePanel.prototype.onTtlExpired=function(){var me=this;this.show(false,{callback:function(){me.ownerComponent.showToolButtons(true);me.afterClose&&me.afterClose(me);me.destroy();}});};PopupMessagePanel.prototype.processTpl=function(){return(this.text=u.sformat(this.tpl,this));};PopupMessagePanel.prototype.processCode=function(code){if(code==='010'){this.email=ul.cmp.ComponentManager.getBy(ul.banner.form.MainConsultantPanel).getEmailToSendChatTo();}};PopupMessagePanel.prototype.show=function(show){this.calculateShowStrategy();if(this.showStrategy==='in-replace'){this.ownerComponent.show(false);}else{this.getEl().css({position:'absolute'});u.removeCls(this.getEl(),['top','bottom','left','right']);var ocp=this.ownerComponentPadding;this.getEl().anchor(this.ownerComponent.getEl(),this.showStrategy==='above'?'tl-bl':'bl-tl',{y:this.showStrategy==='above'?15:ocp});}
PopupMessagePanel.superclass.show.apply(this,arguments);};PopupMessagePanel.prototype.calculateShowStrategy=function(){var windowHeight=u._$(window).height(),thisHeight=this.getEl().height(),ownerComponentHeight=this.ownerComponent&&this.ownerComponent.getEl().outerHeight(true),ownerComponentPadding=this.ownerComponentPadding,freeSpaceHeight=windowHeight-ownerComponentHeight,bannerPlace=this['banner_place'];if(bannerPlace.indexOf('middle')!=-1){freeSpaceHeight=freeSpaceHeight/2;}
if(freeSpaceHeight<(thisHeight+ownerComponentPadding)){this.showStrategy='in-replace';return;}
this.showStrategy=bannerPlace.indexOf('top')!=-1?'below':'above';};u.apply(u.ns(ns),{PopupMessagePanel:PopupMessagePanel});})(window,'uLiB.banner.cmp');(function(g,ns){var ul=g.uLiB,u=ul.util,Element=ul.el.Element,Component=ul.cmp.Component,Form=ul.form.Form,PanelToolButton=ul.cmp.PanelToolButton,CommonButton=ul.cmp.CommonButton,_$=u._$;function CommonFormPanel(o){this.addCls('common-form-panel');this.zIndex=1;CommonFormPanel.superclass.constructor.apply(this,arguments);}
u.extend(CommonFormPanel,Component);u.mixIn(CommonFormPanel,Form);CommonFormPanel.prototype.ctype=null;CommonFormPanel.prototype.renderHidden=true;CommonFormPanel.prototype.trackClick=true;CommonFormPanel.prototype.respectBannerPlace=true;CommonFormPanel.prototype.disableSendBtnOnSubmit=true;CommonFormPanel.prototype.toolsCls='common-form-panel-tools';CommonFormPanel.prototype.headerCls='common-form-panel-header';CommonFormPanel.prototype.containerCls='common-form-panel-container';CommonFormPanel.prototype.itemsCls='common-form-panel-items';CommonFormPanel.prototype.buttonsCls='common-form-panel-buttons';CommonFormPanel.prototype.footerCls='common-form-panel-footer';CommonFormPanel.prototype.resizableCls='common-form-panel-resizable';CommonFormPanel.prototype.blankImgSrc=u.C.SRC_IMG_BLANK;CommonFormPanel.prototype.animationEnabled=true;CommonFormPanel.prototype.html='<div>'+'<div class="{toolsCls}"></div>'+'<div class="{containerCls}">'+'<div class="{headerCls}">'+'<img src="{blankImgSrc}">'+'<div>{title}</div>'+'</div>'+'<div class="{itemsCls}"></div>'+'<div class="{buttonsCls}"></div>'+'<div class="{footerCls}"></div>'+'</div>'+'</div>';CommonFormPanel.prototype.animationKey='CommonFormPanel';CommonFormPanel.prototype.ftype=null;CommonFormPanel.prototype.defaultTooltipType='rich';CommonFormPanel.prototype.elementsToRender=['tools','header','items','buttons','footer'];CommonFormPanel.prototype.tools=[];CommonFormPanel.prototype.states=[{}];CommonFormPanel.prototype.isResize=false;CommonFormPanel.prototype.minFormPanelHeight=250;CommonFormPanel.prototype.resizedFormMargin=40;CommonFormPanel.prototype.afterRender=function(){this.addCls(this.ftype);CommonFormPanel.superclass.afterRender.apply(this,arguments);this.renderPanelElement(this.elementsToRender);};CommonFormPanel.prototype.getChildEl=function(selector){selector=selector.indexOf('.')!=0&&selector.indexOf('#')!=0?('.'+selector):selector;return this.getEl().find(u.getCssSelector(selector));};CommonFormPanel.prototype.renderPanelElement=function(elName){if(arguments.length>1){elName=Array.prototype.slice.call(arguments);}
if(u._$.type(elName)==='array'){for(var i=0,e;(e=elName[i]);i++){this.renderPanelElement(e);}}else{var ct=this[elName+'Ct']=this.getChildEl(this[elName+'Cls']),method=this['render'+u.camelize(elName)];if(ct&&method){method.apply(this);}}};CommonFormPanel.prototype.renderTools=function(){var tools=[],defaultTitles={close:'Закрыть',minimize:'Свернуть',unpin:'Открыть в новом окне'};for(var i=0,t,o;(t=this.tools[i]);i++){if(typeof t==='string'){o={action:t,title:defaultTitles[t]||''}}else{o=t;}
tools.push(new PanelToolButton({action:o.action,title:o.title||defaultTitles[o.action]||'',renderTo:this.toolsCt}));}
this.tools=tools;};CommonFormPanel.prototype.getToolBtn=function(action){var tools=this.tools;for(var i=0,t;(t=tools[i]);i++){if(t.action===action){return t;}}
return null;};CommonFormPanel.prototype.renderHeader=function(){};CommonFormPanel.prototype.renderItems=function(){var items=[],item;if(this.items.length<4){u.addCls(this.itemsCt,'common-form-panel-items-few');}
for(var i=0,ii;(ii=this.items[i]);i++){if(_$.type(ii)=='string'){item=_$(ii).appendTo(this.itemsCt);}else if(_$.type(ii)=='object'&&ii.__class){item=new ii.__class(u.apply({renderTo:this.itemsCt,tooltipType:this.defaultTooltipType},ii));}else if(u.isInstance(ii,'uLiB.cmp.Component')){this.itemsCt.append((item=ii.getEl()));}else{this.itemsCt.append((item=ii));}
items.push(item);}
this.items=items;};CommonFormPanel.prototype.getItem=function(what){if(u._$.type(what)==='string'){what=u.getObjByName(what);}
for(var i=0,ii;(ii=this.items[i]);i++){if(u._$.type(what)==='function'&&ii instanceof what){return ii;}}
return null;};CommonFormPanel.prototype.renderButtons=function(){this.sendBtn=new CommonButton({text:this.buttonText,action:'send',renderTo:this.buttonsCt});};CommonFormPanel.prototype.renderFooter=function(){if(this.o.banner_branding_text&&this.o.banner_branding_url&&!u.C.IS_TOUCH_DEVICE){new Element({tag:'a',href:this.o.banner_branding_url,renderTo:this.footerCt,target:'_blank',text:this.o.banner_branding_text});}};CommonFormPanel.prototype.show=function(show){CommonFormPanel.superclass.show.apply(this,arguments);if(!show){u._$(u.getCssSelector('tipsy',true,true)).remove();this.clearInvalid&&this.clearInvalid();}else{var items=this.items;for(var i=0,item;(item=items[i]);i++){if(item.applySlimScroll){item.applySlimScroll();}}
this.hasGlobalState&&this.restorePosition();}};CommonFormPanel.prototype.__onClick=function(){u.log('CommonFormPanel.prototype.__onClick',arguments);};CommonFormPanel.prototype.setSendBtnDisabled=function(disabled){this.sendBtn&&this.sendBtn.setDisabled(disabled);};CommonFormPanel.prototype.showToolButtons=function(show,viaDisplay){this.getInnerEl('common-form-panel-tools').css({opacity:show?1:0},{duration:0});};CommonFormPanel.prototype.getDraggableOpts=function(){var ret={within:window,handle:u.getCssSelector('common-form-panel-header',true,true),dragEnd:u.bind(this.onDragEnd,this)};if(this.respectBannerPlace){var railAxis=u.arrayIsContain((this.o.banner_place||'').split('_'),['bottom','top'])?'x':'y';ret.axis=railAxis;if(railAxis==='x'){ret.withinPaddingH=30;}else{ret.withinPaddingV=20;}}
return ret;};CommonFormPanel.prototype.saveState=function(){var railAxis=u.arrayIsContain((this.o.banner_place||'').split('_'),['bottom','top'])?'x':'y';this.state=this.state||{};this.state.css=this.state.css||{};if(this.respectBannerPlace){if(railAxis==='x'){this.state.css.left=this.getEl().offset().left;}else{this.state.css.top=this.getEl().offset().top;}}
this.globalState={};this.globalState.css=this.state.css;this.globalState.isAlreadyRated=this.state.isAlreadyRated;CommonFormPanel.superclass.saveState.apply(this,arguments);};CommonFormPanel.prototype.restoreState=function(){CommonFormPanel.superclass.restoreState.apply(this,arguments);if(this.hasGlobalState){this.state.css=this.globalState.css;this.state.isAlreadyRated=this.globalState.isAlreadyRated;}
if(this['banner_skin']!=='touch'&&this.getEl()&&this.state.css){var railAxis=u.arrayIsContain((this.o.banner_place||'').split('_'),['bottom','top'])?'x':'y';railAxis==='x'&&this.getEl().css('left',u.elementWidth()>=this.state.css.left?this.state.css.left:u.elementWidth()/2);railAxis==='x'&&this.state.css.left&&this.hasCls('right')&&this.removeCls('right');railAxis==='y'&&this.getEl().css('top',u.elementHeight()>=this.state.css.top?this.state.css.top:20);}};CommonFormPanel.prototype.onDragEnd=function(){this.savePosition();};CommonFormPanel.prototype._onResize=function(){if(this.ctype==='consultant'&&u.elementHeight()<=this.getEl().height()){this.setHeight(u.elementHeight()-20);}
this._adjustPosition();};CommonFormPanel.prototype.setHeight=function(height){if(height<=this.minFormPanelHeight){return;}
var delta=this.getEl().height()-this.getChildEl(this.containerCls).height();if(u.elementHeight()-height-delta<this.resizedFormMargin){return;}
this.getEl().height(height+delta);this.getChildEl(this.containerCls).height(height);this._adjustPosition();this.adjustLogHeight();};CommonFormPanel.prototype.onResizeStart=function(){this.isResize=true;document.body.style.cursor='s-resize';};CommonFormPanel.prototype.onResizeEnd=function(){if(this.isResize){this.isResize=false;this.startHeight=null;this.startCurY=null;document.body.style.cursor='default';}};CommonFormPanel.prototype.onResizeMove=function(event){if(this.isResize){var newHeight;this.startHeight=this.startHeight||this.getChildEl(this.containerCls).height();this.startCurY=this.startCurY||event.clientY;if(this.banner_place.split('_')[0]!=='bottom'){newHeight=this.startHeight+(event.clientY-this.startCurY);}else{newHeight=this.startHeight-(event.clientY-this.startCurY);}
if(u.elementHeight()-event.clientY>this.resizedFormMargin){this.setHeight(newHeight+1);}}};u.apply(u.ns(ns),{CommonFormPanel:CommonFormPanel});})(window,'uLiB.banner.form');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$;function Consultant(o){}
u.ensureFunctionName(Consultant);Consultant.prototype.operatorAvatarCls='operator-avatar';Consultant.prototype.operatorAvatarWrapperCls='operator-avatar-wrapper';Consultant.prototype.operatorNameCls='operator-name';Consultant.prototype.operatorPositionCls='operator-position';Consultant.prototype.noAvatarCls='no-avatar';Consultant.prototype.fileTransferDisabledMessage='Отправка файлов данному оператору невозможна';Consultant.prototype.inputFieldSelector=u.C.CSS_CONSULTANT_INPUT;Consultant.prototype.callBtnSelector='call-btn';Consultant.prototype.ctype=u.C.CW_CONSULTANT;Consultant.prototype.eventSounds=['incoming_message'];Consultant.prototype.pollingStartTime=0;Consultant.prototype.uploadUrlPollingInterval=1000*19*60;Consultant.prototype.initConsultant=function(){this.trackClick=true;this.consultantLogCmp=this.getConsultantLogCmp();this.initChatWatcher();this.initSound();};Consultant.prototype.initChatWatcher=function(){var me=this,fn=function(){var val=me.getInnerEl(me.inputFieldSelector).val();if(me.oldInputFieldVal!==val){me.oldInputFieldVal=val;me._onTextAreaChange(val);}
me.initChatWatcherTimeoutId=g.setTimeout(fn,1000);};me.chatWatcherEnabled=true;fn();};Consultant.prototype.initSound=function(){this.supportAudio=u.supportAudio();if(!this.supportAudio){return;}
u.initSound({disableMultipleWindowsSounds:true,sounds:this.eventSounds,path:this['comagic_web_url']+'static/banner/audio/',multiPlay:true,volume:'0.5'});this.isSoundOn=true;};Consultant.prototype.playSound=function(params){if(!this.supportAudio||!this.isSoundOn){return;}
var soundName;if(params.source==='Оператор'){soundName='incoming_message'}
soundName&&u.playSound(soundName);};Consultant.prototype.turnSoundOn=function(on){this.isSoundOn=!!on;};Consultant.prototype.notify=function(eventType){this.playSound(eventType);};Consultant.prototype.addLogRecord=function(o){this.consultantLogCmp.addRecord(o,false,!!this.socket);};Consultant.prototype.setOperator=function(name,url,position,is_file_transfer_enabled){this.setOperatorName(name,position);this.setOperatorPic(url);this.setFileTransferEnable(is_file_transfer_enabled);};Consultant.prototype.setFileTransferEnable=function(is_enabled){var fileUpload=this.getFileUploadCmp(),fileInput=fileUpload.getEl().find('input[type=file]');fileUpload.setDisabled(!is_enabled);fileInput[is_enabled?'removeAttr':'attr']('disabled','disabled');fileUpload.setTooltip(is_enabled?'':this.fileTransferDisabledMessage);fileInput.attr('title',is_enabled?'':this.fileTransferDisabledMessage);};Consultant.prototype.setOperatorName=function(name,position){name=name||'';position=position||(name?'Консультант':'');var nameEl=this.getInnerEl(this.operatorNameCls),poritionEl=this.getInnerEl(this.operatorPositionCls);nameEl.text(name).attr('title',name);poritionEl.text(position).attr('title',position);};Consultant.prototype.setOperatorPic=function(url){var headerEl=this.getInnerEl(ul.banner.form.CommonFormPanel.prototype.headerCls),avatarEl=this.getInnerEl(this.operatorAvatarCls),src,method;if(u.arrayIndexOf(['main','touch'],this['banner_skin'])!=-1){method=!u.hasConnectWayEnabled(u.C.CW_SITE_PHONE)&&url!==null?'removeCls':'addCls';}else if(this['banner_skin']==='simple'){method=url&&url!=='default'?'removeCls':'addCls';}
src=url&&url!=='default'?url:u.C.SRC_IMG_BLANK;avatarEl.attr('src',src);if(url&&url!=='default'){avatarEl.resizecrop({wrapperCreated:true,width:this.operatorPicSize,height:this.operatorPicSize});}else{avatarEl.width('100%').height('100%');}
u[method](headerEl,this.noAvatarCls);};Consultant.prototype.operatorPicSize=50;Consultant.prototype.setTypeNotifier=function(isTyping){this.consultantLogCmp.setTypeNotifier(isTyping);};Consultant.prototype.loadHistory=function(messages,doNotFilter){var tmp=[];if(!doNotFilter){for(var i=0,m;(m=messages[i]);i++){if(m['from']){tmp.push(m);}}}
this.consultantLogCmp.innerAnimationEnabled=false;this.consultantLogCmp.addRecord(doNotFilter?messages:tmp);this.consultantLogCmp.innerAnimationEnabled=true;};Consultant.prototype.setOperatorRating=function(){var ratingCmp=this.getItem&&this.getItem('uLiB.banner.consultant.OperatorRatingCmp');ratingCmp&&ratingCmp.show(false);this.adjustLogHeight&&this.adjustLogHeight();};Consultant.prototype.onRateOperatorFieldRate=function(rating){};Consultant.prototype.onTextAreaChange=function(text){};Consultant.prototype._onTextAreaChange=function(text){this.chatWatcherEnabled&&this.onTextAreaChange(text);};Consultant.prototype._onRateOperatorFieldRate=function(rating){this.onRateOperatorFieldRate(rating);};Consultant.prototype._printChatLog=function(){var printPage=window.open(),css=u.buildUrl.call(this,'/static/comagic/banner/resources/css/print.css'),html=this.getLogHtml();printPage.document.title=document.title;printPage.document.write(u.sformat('<!DOCTYPE html"><html><head>'+'<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />'+'<link rel="stylesheet" type="text/css" href="{0}"/>'+'</head>'+'<body onload="window.print();">'+'<div class="comagic-consultant-log-inner">{1}</div>'+'<br/>Сервис предоставлен <a href="http://www.comagic.ru" target="_blank">www.comagic.ru</a>'+'</body></html>',css,html));printPage.document.close();};Consultant.prototype.getInputField=function(){return this.getInnerEl(this.inputFieldSelector);};Consultant.prototype.getInputMessage=function(){return this.getInputField().val().replace(/[\n\r]$/,'');};Consultant.prototype.getValues=function(){return{message:this.getInputMessage()};};Consultant.prototype.isValid=function(){return!!u.strim(this.getInputMessage());};Consultant.prototype.onClick=function(cmp,deepCType,ctype){if(u.arrayIsContain(['common-button-send','standard-button-send'],ctype)){g.setTimeout(u.bind(function(){this.getInputField().focus();},this),100);}};Consultant.prototype.isUploadUrlPollingIntervalExspired=function(){var me=this,now=(new Date()).getTime();return now-me.pollingStartTime>me.uploadUrlPollingInterval;};Consultant.prototype.onDestroy=function(){this.initChatWatcherTimeoutId&&g.clearTimeout(this.initChatWatcherTimeoutId);};u.apply(u.ns(ns),{Consultant:Consultant});})(window,'uLiB.banner.consultant');(function(g,ns){var ul=g.uLiB,u=ul.util,Component=ul.cmp.Component,FileUpload=ul.cmp.FileUpload,MsButton=ul.cmp.MsButton,_$=u._$;function MainInputCmp(o){this.addCls('main-input-cmp');MainInputCmp.superclass.constructor.apply(this,arguments);}
u.extend(MainInputCmp,Component);MainInputCmp.prototype.ctype='main-input-cmp';MainInputCmp.prototype.leftContainerCls='left-container';MainInputCmp.prototype.textareaPlaceholderText='Введите сообщение сюда';MainInputCmp.prototype.sendMessageBtnPlaceholderCls='send-message-btn-placeholder';MainInputCmp.prototype.sendFileBtnPlaceholderCls='send-file-btn-placeholder';MainInputCmp.prototype.inputFieldCls=u.C.CSS_CONSULTANT_INPUT;MainInputCmp.prototype.renderFileSendingButton=true;MainInputCmp.prototype.html='<div>'+'<div class="{leftContainerCls}">'+'<textarea placeholder="{textareaPlaceholderText}" class="{inputFieldCls}"></textarea>'+'<div class="{sendFileBtnPlaceholderCls}"/>'+'</div>'+'<div class="{sendMessageBtnPlaceholderCls}"/>'+'</div>';MainInputCmp.prototype.afterRender=function(){var me=this;MainInputCmp.superclass.afterRender.apply(this,arguments);var el=this.getEl();el.find('textarea').val('');this.renderFileSendingButton&&el.find(u.getCssSelector(this.sendFileBtnPlaceholderCls,true,true)).replaceWith((this.fileUploadCmp=new FileUpload({icon:{},onReceive:this.onFileReceive,validExtensions:u.C.VALID_FILE_EXTENSIONS})).getEl());el.find(u.getCssSelector(this.sendMessageBtnPlaceholderCls,true,true)).replaceWith(new MsButton({icon:{},cls:'button-send',ctype:'common-button-send'}).getEl());};MainInputCmp.prototype._onTextareaHeightSet=function(height,delta,animation){this.onTextareaHeightSet(height,delta,animation);};MainInputCmp.prototype.onTextareaHeightSet=function(height,delta,animation){};MainInputCmp.prototype.onFileReceive=function(){};MainInputCmp.prototype.getValue=function(){return this.textarea.val();};MainInputCmp.prototype.applyAutogrow=function(){if(this.autogrowApplyed){return;}
this.autogrowApplyed=true;this.getEl().find('textarea').autogrow({maxHeight:74,animation:false,onHeightSet:u.bind(this._onTextareaHeightSet,this)});};u.apply(u.ns(ns),{MainInputCmp:MainInputCmp});})(window,'uLiB.banner.consultant');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$;function SimpleSoundButton(o){this.addCls('simple-sound-button');this.icon={anchor:'right'};this.action='toggle-sound';this.stateful=true;SimpleSoundButton.superclass.constructor.apply(this,arguments);}
u.extend(SimpleSoundButton,'uLiB.cmp.MsButton');SimpleSoundButton.prototype.ctype='simple-sound-button';SimpleSoundButton.prototype.trackOwnEvents=true;SimpleSoundButton.prototype.textStateOn='Отключить звуки';SimpleSoundButton.prototype.textStateOff='Включить звуки';u.apply(u.ns(ns),{SimpleSoundButton:SimpleSoundButton});})(window,'uLiB.banner.consultant');(function(g,ns){var ul=g.uLiB,u=ul.util,_$=u._$;function SimpleInputCmp(o){this.addCls('simple-input-cmp');SimpleInputCmp.superclass.constructor.apply(this,arguments);}
u.extend(SimpleInputCmp,'uLiB.banner.consultant.MainInputCmp');SimpleInputCmp.prototype.ctype='simple-input-cmp';SimpleInputCmp.prototype.hintText='Отправка Enter';SimpleInputCmp.prototype.hintTextCls='hint-text';SimpleInputCmp.prototype.renderFileSendingButton=false;SimpleInputCmp.prototype.html='<div>'+'<div class="{leftContainerCls}">'+'<textarea placeholder="{textareaPlaceholderText}" class="{inputFieldCls}"/>'+'<div class="{hintTextCls}">{hintText}</div>'+'</div>'+'<div class="{sendMessageBtnPlaceholderCls}"/>'+'</div>';SimpleInputCmp.prototype.textareaPlaceholderText='';u.apply(u.ns(ns),{SimpleInputCmp:SimpleInputCmp});})(window,'uLiB.banner.consultant');(function(g,ns){var ul=g.uLiB,u=ul.util,Component=ul.cmp.Component,Element=ul.el.Element,_$=u._$;function Log(o){this.autoEl={tag:'div',children:[{tag:'div',cls:this.innerCls}]};this.addCls('consultant-log');this.innerAnimationEnabled=true;Log.superclass.constructor.apply(this,arguments);this.logEl=this.getEl().find(u.getCssSelector(this.innerCls,true,true));var timeDelta=u.dGetTimeDelta();if(timeDelta!==undefined){this.timeDelta=timeDelta;}}
u.extend(Log,Component);Log.prototype.ctype='consultant-log';Log.prototype.innerCls='consultant-log-inner';Log.prototype.typingNotificationCls='consultant-log-message-box-typing-notification';Log.prototype.logRecordTpl=''+'<div class="{messageBoxCls} {sourceCls}">'+'<div class="{sourceTextCls}">{source}</div>'+'<div class="{messageCls}">{message}</div>'+'<div class="{timeCls}">{time}</div>'+'<div class="{tailCls}"><div class="{tailInner1Cls}"/><div class="{tailInner2Cls}"/></div>'+'<div class="{clearerCls}"/>'+'</div>';Log.prototype.logRecordSystemTpl=''+'<div class="{messageBoxCls} {sourceCls}">'+'<div class="{messageCls}">{message}</div>'+'<div class="{timeCls}">{time}</div>'+'</div>';Log.prototype.logRecordFileLinkSubTpl=''+'<a href="{fileLink}" target="_blank"><img src="{imgSrc}" class="{clipCls}"><span class="{fileNameCls}">{fileName}</span></a> <span class="{fileSizeCls}">{fileSize}</span>';Log.prototype.logRecordTypingNotificationTpl=''+'<div class="{messageBoxCls} {sourceCls} {typingNotificationCls}">'+'<div class="{sourceTextCls}">{source}</div>'+'<div class="{messageCls}"><img src="{imgSrc}"></div>'+'<div class="{tailCls}"><div class="{tailInner1Cls}"/><div class="{tailInner2Cls}"/></div>'+'<div class="{clearerCls}"/>'+'</div>';Log.prototype.logRecordButtonPhoneTpl=''+'<div class="{messageBoxCls} {sourceCls}">'+'<a class="comagic-common-button comagic-button">'+'<span class="chat-retention open-site-phone">Заказать звонок</span>'+'</a>'+'</div>';Log.prototype.logRecordButtonRequestTpl=''+'<div class="{messageBoxCls} {sourceCls}">'+'<a class="comagic-common-button comagic-button">'+'<span class="chat-retention open-site-request">Оставить заявку</span>'+'</a>'+'</div>';Log.prototype.processMessage=function(msg,isChatStandalone){msg=u.textLinksToHtml(u.crLfToBr(msg));if(isChatStandalone){msg=msg.replace(/<a[^>]+/g,'$& target="_blank"');}
return msg;};Log.prototype.formatFileSize=function(fileSize){if(fileSize<100){fileSize+=' B';}else if(fileSize<100*1024){fileSize=(fileSize/1024).toFixed(2)+' KB';}else{fileSize=(fileSize/1024/1024).toFixed(2)+' MB';}
return fileSize;};Log.prototype.composeRecord=function(o,isChatStandalone){var sourceCls,isSystem=!o.from,isTypingNotification=o.isTypingNotification,isOperator=o.source=='Оператор',tpl=this.logRecordTpl;if(isSystem){sourceCls='consultant-log-message-box-system';tpl=this.logRecordSystemTpl;}else if(isTypingNotification){sourceCls='consultant-log-message-box-operator';tpl=this.logRecordTypingNotificationTpl;}else if(o.communication_way==='site_request'){sourceCls='consultant-log-message-box-button';tpl=this.logRecordButtonRequestTpl;}else if(o.communication_way==='site_phone'){sourceCls='consultant-log-message-box-button';tpl=this.logRecordButtonPhoneTpl;}else{sourceCls=isOperator?'consultant-log-message-box-operator':'consultant-log-message-box-visitor';}
var message,date=o.date;if(o.fx_link){message=u.sformat(this.logRecordFileLinkSubTpl,{fileLink:isOperator?o.fx_link:'javascript:void(0);',imgSrc:u.C.SRC_IMG_BLANK,clipCls:'consultant-log-message-box-clip',fileNameCls:'consultant-log-message-box-filename',fileSizeCls:'consultant-log-message-box-filesize',fileName:o.fx_name,fileSize:this.formatFileSize(o.fx_size)});}else{message=this.processMessage(o.message||'',isChatStandalone);}
var timeDelta=this.timeDelta===undefined?g.__cs.getTimeDelta():this.timeDelta;if(date){date=u.dApplyTimeDelta(date,timeDelta);}
return u.sformat(tpl,{messageBoxCls:'consultant-log-message-box',sourceCls:sourceCls,sourceTextCls:'consultant-log-message-source',messageCls:'consultant-log-message',timeCls:'consultant-log-time',tailCls:'consultant-log-tail',tailInner1Cls:'tail-inner-1',tailInner2Cls:'tail-inner-2',clearerCls:'clearer',message:message.replace(/[\n]+$/,'').replace(/[\n\r]/g,'<br>'),time:u.tformat(date),source:this.getSourceText(o.source),imgSrc:u.C.SRC_IMG_BLANK,typingNotificationCls:this.typingNotificationCls});};Log.prototype.getLogEl=function(){return this.logEl;};Log.prototype.addRecord=function(o,replace,isChatStandalone){if(replace===true){this.getLogEl().empty();}
if(_$.isArray(o)){for(var i=0,mo;(mo=o[i]);i++){this.addRecord(mo);}}else{var el=_$(this.composeRecord(o,isChatStandalone)).css({opacity:0});this.getLogEl().append(el);this.scrollTop();el.animate({opacity:1,easing:'easeInOutQuint',duration:50});}};Log.prototype.scrollTop=function(){this.getLogEl().slimScroll({'scrollTo':10000});};Log.prototype.setTypeNotifier=function(isTyping){if(isTyping!==undefined){var notifierMessageEl=this.getInnerEl(this.typingNotificationCls);if(isTyping){if(!notifierMessageEl.length){this.addRecord({source:'Оператор',from:'Оператор',isTypingNotification:true});this.scrollTop();}}else{notifierMessageEl.remove();}}else{this.setTypeNotifier(true);if(this.typeTimeoutId){clearTimeout(this.typeTimeoutId);this.typeTimeoutId=null;}
this.typeTimeoutId=g.setTimeout(u.bind(function(){this.typeTimeoutId=null;this.setTypeNotifier(false);},this),20000);}};Log.prototype.isEmpty=function(){return!this.getLogEl().text().replace(/\s+/g,'');};Log.prototype.getLogHtml=function(){return this.getLogEl().html();};Log.prototype.applySlimScroll=function(height){this.logEl.slimscroll({height:height||this.height||'auto'});};Log.prototype.getSourceText=function(text){return{'Посетитель':'Я:','Оператор':'Оператор:'}[text];};Log.prototype.setHeight=function(height,delta){if(height===undefined){height=this.el.height()+delta;}
this.logEl.height(height);this.el.height(height);this.el.find('.slimScrollDiv').height(height);};Log.prototype.hideSystemMessages=function(){this.getInnerEl('consultant-log-message-box-system').hide();this.hideAlternateCommunicationButtons();};Log.prototype.showChatRetentionAction=function(communicaton_way){this.addRecord({communication_way:communicaton_way,from:'system'});};Log.prototype.hideAlternateCommunicationButtons=function(){this.getInnerEl('consultant-log-message-box-button').hide();};u.apply(u.ns(ns),{Log:Log});})(window,'uLiB.banner.consultant');(function(g,ns){var ul=g.uLiB,u=ul.util,Label=ul.el.Label,Component=ul.cmp.Component,FunctionalButton=uLiB.cmp.FunctionalButton,_$=u._$;function OperatorRatingCmp(o){this.addCls('operator-rating-cmp');OperatorRatingCmp.superclass.constructor.apply(this,arguments);}
u.extend(OperatorRatingCmp,Component);OperatorRatingCmp.prototype.ctype='operator-rating-cmp';OperatorRatingCmp.prototype.html='<div/>';OperatorRatingCmp.prototype.afterRender=function(){OperatorRatingCmp.superclass.afterRender.apply(this,arguments);var el=this.getEl();new Label({text:'Оценка консультации:',renderTo:el});new FunctionalButton({type:'thumb-up',renderTo:el});new FunctionalButton({type:'thumb-down',renderTo:el});};u.apply(u.ns(ns),{OperatorRatingCmp:OperatorRatingCmp});})(window,'uLiB.banner.consultant');(function(g,ns){var ul=g.uLiB,u=ul.util,Component=ul.cmp.Component,Element=ul.el.Element,FunctionalButton=uLiB.cmp.FunctionalButton,_$=u._$;function FunctionalToolbar(o){this.addCls('functional-toolbar');FunctionalToolbar.superclass.constructor.apply(this,arguments);}
u.extend(FunctionalToolbar,Component);FunctionalToolbar.prototype.ctype='functional-toolbar';FunctionalToolbar.prototype.html='<div/>';FunctionalToolbar.prototype.renderBrandingLink=function(text,url){var el=this.getEl();new Element({tag:'a',href:url,target:'_blank',cls:'branding-link',text:text,renderTo:el});};FunctionalToolbar.prototype.afterRender=function(){FunctionalToolbar.superclass.afterRender.apply(this,arguments);var el=this.getEl();this.emailBtn=new FunctionalButton({type:'email',renderTo:el,enableToggle:true});new FunctionalButton({type:'print',renderTo:el});if(u.supportAudio()){this.soundBtn=new FunctionalButton({type:'sound',stateful:true,stateId:'consultant-functional-toolbar-sound-btn',renderTo:el});}};u.apply(u.ns(ns),{FunctionalToolbar:FunctionalToolbar});})(window,'uLiB.banner.consultant');(function(g,ns){var ul=g.uLiB,u=ul.util,Div=ul.el.Div,TextField=ul.field.TextField,Component=ul.cmp.Component,LinklikeButton=ul.cmp.LinklikeButton,CommonButton=ul.cmp.CommonButton,_$=u._$;function EmailChatCmp(o){this.addCls('email-chat-cmp');EmailChatCmp.superclass.constructor.apply(this,arguments);}
u.extend(EmailChatCmp,Component);EmailChatCmp.prototype.html='<div/>';EmailChatCmp.prototype.ctype='email-chat-cmp';EmailChatCmp.prototype.afterRender=function(){EmailChatCmp.superclass.afterRender.apply(this,arguments);var el=this.getEl();this.emailField=new TextField({plaseholder:'Email',tooltipType:'rich',label:'Отправить чат на электронную почту:',validators:['email'],maxLength:100,renderTooltipInside:true,notemptyText:'Укажите email',allowBlank:false,renderTo:el});new Div({cls:'buttons-wrapper',renderTo:el,children:[new CommonButton({text:'Отправить',action:'send-chat-by-email'}),new LinklikeButton({text:'Отмена',action:'cancel'}),new Div({cls:'clearer'})]});};EmailChatCmp.prototype.renderButtons=function(){EmailChatCmp.superclass.renderButtons.apply(this,arguments);};EmailChatCmp.prototype.isValid=function(){return this.emailField.isValid();};EmailChatCmp.prototype.getValues=function(){return{email:this.emailField.getValue()};};u.apply(u.ns(ns),{EmailChatCmp:EmailChatCmp});})(window,'uLiB.banner.consultant');(function(g,ns){var ul=g.uLiB,u=ul.util,CommonFormPanel=ul.banner.form.CommonFormPanel,_$=u._$;function PreviewPanel(o,s){this.s=s;o.monitorResize=false;o.monitorZoom=true;PreviewPanel.superclass.constructor.apply(this,arguments);}
u.extend(PreviewPanel,CommonFormPanel);PreviewPanel.prototype.destroyOnHide=true;PreviewPanel.prototype.ftype='preview';PreviewPanel.prototype.elementsToRender=['tools','header','buttons'];PreviewPanel.prototype.tools=['close'];PreviewPanel.prototype.items=[];PreviewPanel.prototype.html='<div>'+'<div class="{containerCls}">'+'<div class="{headerCls}">'+'<img src="{blankImgSrc}">'+'<div>{title}</div>'+'</div>'+'<div class="{buttonsCls}"></div>'+'<div class="{toolsCls}"></div>'+'</div>'+'</div>';u.apply(u.ns(ns),{PreviewPanel:PreviewPanel});})(window,'uLiB.banner.form');(function(g,ns){var ul=g.uLiB,u=ul.util,PreviewPanel=ul.banner.form.PreviewPanel,Consultant=ul.banner.consultant.Consultant,_$=u._$;function ConsultantPreviewPanel(o,s){this.addCls('consultant-preview');o.title=s.message;this.buttonText='Начать чат';ConsultantPreviewPanel.superclass.constructor.apply(this,arguments);this.operatorAvatarEl=this.getInnerEl(this.operatorAvatarCls);Consultant.prototype.setOperatorPic.call(this,s.file_link);}
u.extend(ConsultantPreviewPanel,PreviewPanel);ConsultantPreviewPanel.prototype.operatorAvatarCls='operator-avatar';ConsultantPreviewPanel.prototype.operatorPicSize=71;ConsultantPreviewPanel.prototype.noAvatarCls='no-avatar';ConsultantPreviewPanel.prototype.operatorAvatarWrapperCls='operator-avatar-wrapper';ConsultantPreviewPanel.prototype.ctype=u.C.CW_CONSULTANT_PREVIEW;u.apply(u.ns(ns),{ConsultantPreviewPanel:ConsultantPreviewPanel});ConsultantPreviewPanel.prototype.html='<div>'+'<div class="{containerCls}">'+'<div class="{headerCls}">'+'<span class="{operatorAvatarWrapperCls}">'+'<img src="{blankImgSrc}" class="{operatorAvatarCls}">'+'</span>'+'<div>{title}<br><br></div>'+'</div>'+'<div class="{buttonsCls}"></div>'+'<div class="{toolsCls}"></div>'+'</div>'+'</div>';})(window,'uLiB.banner.form');(function(g,ns){var ul=g.uLiB,u=ul.util,PreviewPanel=ul.banner.form.PreviewPanel,_$=u._$;function LeadRequestPreviewPanel(o,s){this.addCls('lead-request-preview');this.title=s.message;this.buttonText='Оставить контакты';LeadRequestPreviewPanel.superclass.constructor.apply(this,arguments);}
u.extend(LeadRequestPreviewPanel,PreviewPanel);LeadRequestPreviewPanel.prototype.ctype=u.C.CW_LEAD_REQUEST_PREVIEW;u.apply(u.ns(ns),{LeadRequestPreviewPanel:LeadRequestPreviewPanel});})(window,'uLiB.banner.form');(function(g,ns){var ul=g.uLiB,u=ul.util,TextField=ul.field.TextField,TextAreaField=ul.field.TextAreaField,PhoneField=ul.field.PhoneField,CommonFormPanel=ul.banner.form.CommonFormPanel,_$=u._$;function DynamicFormPanel(o,s){this.s=this.s||s;this.s.message=this.s.message.replace(/\n/g,'<br />');this.title=this.s.message;this.ftype=this.ctype;DynamicFormPanel.superclass.constructor.apply(this,arguments);}
u.extend(DynamicFormPanel,CommonFormPanel);DynamicFormPanel.prototype.ctype=null;DynamicFormPanel.prototype.tools=['close'];DynamicFormPanel.prototype.fieldsMap={'name':{__class:TextField,placeholder:'Как вас зовут',notemptyText:'Укажите имя',renderTooltipInside:true,maxLength:100},'phone':{__class:PhoneField,placeholder:'Телефон для связи',renderTooltipInside:true,notemptyText:'Укажите телефон'},'email':{__class:TextField,placeholder:'E-mail для ответа',validators:['email'],renderTooltipInside:true,notemptyText:'Укажите ваш email',maxLength:100},'message':{__class:TextAreaField,placeholder:'Ваш вопрос',renderTooltipInside:true,maxLength:1000}};DynamicFormPanel.prototype.renderItems=function(){this.items=this.items||[];for(var name in this.fieldsMap){if(this.fieldsMap.hasOwnProperty(name)&&this.isItemRequired(name)){this.items.push(u.apply({name:name,allowBlank:this.getItemRequirement(name)!='required'},this.fieldsMap[name]));}}
DynamicFormPanel.superclass.renderItems.apply(this,arguments);};DynamicFormPanel.prototype.isItemRequired=function(name){var requirement=this.getItemRequirement(name);return requirement&&requirement!=='unused';};DynamicFormPanel.prototype.getItemRequirement=function(name){var ret=this.s['require_'+name]||this.s['consultant_require_'+name];if(ret===undefined){ret=this['require_'+name]||this['consultant_require_'+name];}
return ret;};u.apply(u.ns(ns),{DynamicFormPanel:DynamicFormPanel});})(window,'uLiB.banner.form');(function(g,ns){var ul=g.uLiB,u=ul.util,DynamicFormPanel=ul.banner.form.DynamicFormPanel,_$=u._$;function LeadRequestPanel(o,s){this.addCls('lead-request');this.buttonText='Отправить';this.disableSendBtnOnSubmit=true;this.clearOnSubmit=false;LeadRequestPanel.superclass.constructor.apply(this,arguments);}
u.extend(LeadRequestPanel,DynamicFormPanel);LeadRequestPanel.prototype.destroyOnHide=true;LeadRequestPanel.prototype.ctype=u.C.CW_LEAD_REQUEST;LeadRequestPanel.prototype.draggable=true;LeadRequestPanel.prototype.stateful=true;LeadRequestPanel.prototype.stateId='lead-request';u.apply(u.ns(ns),{LeadRequestPanel:LeadRequestPanel});})(window,'uLiB.banner.form');(function(g,ns){var ul=g.uLiB,u=ul.util,DynamicFormPanel=ul.banner.form.DynamicFormPanel,_$=u._$;function SiteRequestPanel(o,s){this.addCls('site-request');this.buttonText='Отправить';this.clearOnSubmit=false;this.deferredClearOnSubmit=true;this.disableSendBtnOnSubmit=true;SiteRequestPanel.superclass.constructor.call(this,o,{message:'Заявка с сайта',require_name:'required',require_email:'required',require_phone:'optional',require_message:'required'});}
u.extend(SiteRequestPanel,DynamicFormPanel);SiteRequestPanel.prototype.ctype=u.C.CW_SITE_REQUEST;SiteRequestPanel.prototype.draggable=true;SiteRequestPanel.prototype.stateful=true;SiteRequestPanel.prototype.stateId='site-request';SiteRequestPanel.prototype.hasGlobalState=true;u.apply(u.ns(ns),{SiteRequestPanel:SiteRequestPanel});})(window,'uLiB.banner.form');(function(g,ns){var ul=g.uLiB,u=ul.util,CommonFormPanel=ul.banner.form.CommonFormPanel,PhoneField=ul.field.PhoneField,CaptchaField=ul.field.CaptchaField,LinklikeButton=ul.cmp.LinklikeButton,_$=u._$;function SitePhonePanel(o){this.addCls('site-phone');this.tools=['close'];this.title='Заказ звонка';this.buttonText='Перезвоните мне';this.items=[{__class:PhoneField,name:'phone',placeholder:'Ваш телефон',renderTooltipInside:true,dontClear:true,notemptyText:'Укажите телефон',allowBlank:false}];o['is_captcha_enabled']&&this.items.push({__class:CaptchaField,name:'captcha_val',label:'Введите код с изображения',allowBlank:false,is_preview:o['is_preview']},{__class:LinklikeButton,action:'refresh-captcha',text:'Обновить код'});SitePhonePanel.superclass.constructor.apply(this,arguments);this.captchaField=o['is_captcha_enabled']?this.getItem(CaptchaField):null;}
u.extend(SitePhonePanel,CommonFormPanel);SitePhonePanel.prototype.ctype=u.C.CW_SITE_PHONE;SitePhonePanel.prototype.ftype='site-phone';SitePhonePanel.prototype.nonCaptchaCls='non-captcha';SitePhonePanel.prototype.clearOnSubmit=true;SitePhonePanel.prototype.draggable=true;SitePhonePanel.prototype.stateful=true;SitePhonePanel.prototype.stateId='site-phone';SitePhonePanel.prototype.hasGlobalState=true;SitePhonePanel.prototype.refreshCaptcha=function(){this.o.is_captcha_enabled&&this.captchaField.refreshCaptcha();};SitePhonePanel.prototype.show=function(show){this.getChildEl(this.containerCls)[this.o.is_captcha_enabled?'removeClass':'addClass'](this.nonCaptchaCls);show&&this.refreshCaptcha();SitePhonePanel.superclass.show.apply(this,arguments);};u.apply(u.ns(ns),{SitePhonePanel:SitePhonePanel});})(window,'uLiB.banner.form');(function(g,ns){var ul=g.uLiB,u=ul.util,CommonFormPanel=ul.banner.form.CommonFormPanel,Consultant=ul.banner.consultant.Consultant,CallButton=ul.cmp.CallButton,OperatorRatingCmp=ul.banner.consultant.OperatorRatingCmp,FunctionalToolbar=ul.banner.consultant.FunctionalToolbar,Log=ul.banner.consultant.Log,MainInputCmp=ul.banner.consultant.MainInputCmp,EmailChatCmp=ul.banner.consultant.EmailChatCmp,_$=u._$;function MainConsultantPanel(o){this.addCls('consultant-main');this.ftype=this.ctype;this.trackClick=true;if(o.banner_place){if(!(u.arrayIsContain(o.banner_place.split('_'),'bottom'))){this.resizeHandleElementBottom=u.sformat('<div class="{0}"/>',u.getCssSelector(this.resizableCls,true));this.addCls('resizable-bottom');}else{this.resizeHandleElementTop=u.sformat('<div class="{0}"/>',u.getCssSelector(this.resizableCls,true));this.addCls('resizable-top');}}
MainConsultantPanel.superclass.constructor.apply(this,arguments);this.resizableCt=this.getChildEl(this.resizableCls);if(this.resizableCt.length){this.resizableCt[0].onmousedown=u.bind(this.onResizeStart,this);document.onmouseup=u.bind(this.onResizeEnd,this);document.onmousemove=u.bind(this.onResizeMove,this);}
this.initConsultant();this.turnSoundOn(this.getSoundState()==='on');if(this.state.isAlreadyRated){this.getItem(OperatorRatingCmp)&&this.getItem(OperatorRatingCmp).getEl().hide();}}
u.extend(MainConsultantPanel,CommonFormPanel);u.mixIn(MainConsultantPanel,Consultant);MainConsultantPanel.prototype.callBtnPlaceholderCls='call-btn-placeholder';MainConsultantPanel.prototype.sendChatByEmailContainerCls='send-by-email-container';MainConsultantPanel.prototype.inputCmpPlaceholderCls='input-field-placeholder';MainConsultantPanel.prototype.operatorInfoCls='operator-info';MainConsultantPanel.prototype.emailChatCmpAnimationKey='main-email-chat-cmp';MainConsultantPanel.prototype.resizeHandleElementTop='';MainConsultantPanel.prototype.resizeHandleElementBottom='';MainConsultantPanel.prototype.initialLogHeight=232;MainConsultantPanel.prototype.tools=[{action:'close',title:'Закрыть чат'},'unpin',{action:'minimize',title:'Свернуть чат'}];MainConsultantPanel.prototype.html='<div style="height: 406px;">'+'<div class="{toolsCls}"></div>'+'<div class="{containerCls}">'+'{resizeHandleElementTop}'+'<div class="{headerCls}">'+'<span class="{operatorAvatarWrapperCls}">'+'<img src="{blankImgSrc}" class="{operatorAvatarCls}">'+'</span>'+'<div class="{operatorInfoCls}">'+'<div class="{operatorNameCls}"></div>'+'<div class="{operatorPositionCls}"></div>'+'</div>'+'<div class="{callBtnPlaceholderCls}"></div>'+'</div>'+'<div class="{itemsCls}"></div>'+'<div class="{sendChatByEmailContainerCls}"></div>'+'<div class="{inputCmpPlaceholderCls}"></div>'+'<div class="{footerCls}"/>'+'{resizeHandleElementBottom}'+'</div>'+'</div>';MainConsultantPanel.prototype.draggable=true;MainConsultantPanel.prototype.stateful=true;MainConsultantPanel.prototype.stateId='consultant-main';MainConsultantPanel.prototype.hasGlobalState=true;MainConsultantPanel.prototype.elementsToRender=['tools','header','items','sendChatByEmailContainer','inputCmpPlaceholder'];MainConsultantPanel.prototype.renderHeader=function(){if(u.hasConnectWayEnabled.call(this,u.C.CW_SITE_PHONE)){this.callBtn=new CallButton({action:'open-site-phone'});this.getInnerEl(this.callBtnPlaceholderCls).replaceWith(this.callBtn.getEl());}};MainConsultantPanel.prototype.renderItems=function(){var items=[{__class:Log,height:this.initialLogHeight},{__class:FunctionalToolbar}];if(this['is_consultant_operator_rating']&&!this['operator_rating']){items.unshift({__class:OperatorRatingCmp});}
this.items=items;MainConsultantPanel.superclass.renderItems.apply(this,arguments);this.logCmp=this.getItem(Log);if(this.o.banner_branding_text&&this.o.banner_branding_url){this.getItem(FunctionalToolbar).renderBrandingLink(this.o.banner_branding_text,this.o.banner_branding_url);}};MainConsultantPanel.prototype.renderSendChatByEmailContainer=function(){this.emailChatForm=new EmailChatCmp({renderHidden:true,animationKey:this.emailChatCmpAnimationKey,parentCmp:this});this.getInnerEl(this.sendChatByEmailContainerCls).replaceWith((this.emailChatForm).getEl());};MainConsultantPanel.prototype.renderInputCmpPlaceholder=function(){this.inputCmpPlaceholderCt.replaceWith((this.inputCmp=new MainInputCmp({onFileReceive:u.bind(this.onFileReceive,this),onTextareaHeightSet:u.bind(this.onMainInputTextareaHeightSet,this),animationKey:'main-input-cmp',parentCmp:this})).getEl());};MainConsultantPanel.prototype.onFileReceive=function(){this.pollForUploadUrl(false);this.pollForUploadUrl(true);};MainConsultantPanel.prototype.getConsultantLogCmp=function(){return this.getItem(Log);};MainConsultantPanel.prototype.getFunctionalToolbarCmp=function(){return this.getItem(FunctionalToolbar);};MainConsultantPanel.prototype.onMainInputTextareaHeightSet=function(height,delta,animation){if(delta&&!animation){this.adjustLogHeight();}else if(delta&&animation){var me=this,now=(new Date()).getTime(),intervalId;intervalId=g.setInterval(function(){me.adjustLogHeight();if((new Date()).getTime()>(now+u.C.DURATION_INPUT_CMP_ANIMATION)){g.clearInterval(intervalId);}},1);}};MainConsultantPanel.prototype._onClick=function(cmp,deepCType,ctype,event,target,isOwnEvent){var me=this;if(ctype==='functional-button-email'){this.toggleEmailChatFormVisibility();}else if(ctype==='functional-button-thumb-up'||ctype==='functional-button-thumb-down'){var rating=ctype==='functional-button-thumb-up'?5:1,ratingCmp=this.getItem(OperatorRatingCmp);this._onRateOperatorFieldRate(rating);this.state.isAlreadyRated=true;this.saveState();ratingCmp.getEl().hide({effect:'slide',direction:'up',duration:uLiB.util.AnimationManager.durationInnerFade,easing:uLiB.util.AnimationManager.easing,complete:function(){me.adjustLogHeight();}});}else if(ctype==='text-button-cancel'){this.getFunctionalToolbarCmp().emailBtn.getEl().click();}else if(ctype==='functional-button-sound'){this.turnSoundOn(this.getFunctionalToolbarCmp().soundBtn.state==='on');}else if(ctype==='common-button-send-chat-by-email'){if(this.emailChatForm.isValid()){this.getFunctionalToolbarCmp().emailBtn.getEl().click();}}};MainConsultantPanel.prototype.toggleEmailChatFormVisibility=function(visible){if(visible===undefined){visible=this.getFunctionalToolbarCmp().emailBtn.pressed;}
this.emailChatForm.show(visible,this.animationEnabled);this.inputCmp.show(!visible,this.animationEnabled);!this.animationEnabled&&this.adjustLogHeight();};MainConsultantPanel.prototype.adjustLogHeight=function(callback,noAnimation){if(u._$.type(callback)==='boolean'){noAnimation=callback;}
var ctEl=this.getInnerEl(this.containerCls),ctH=ctEl.height(),sumH=0;ctEl.find('>:visible').each(function(){var _this=u._$(this);if(u.arrayIndexOf(['fixed'],_this.css('position'))){sumH+=_this.outerHeight(true);}});this.logCmp.setHeight(undefined,(ctH-sumH),noAnimation);};MainConsultantPanel.prototype.show=function(show){var me=this;MainConsultantPanel.superclass.show.apply(this,[show,{callback:function(){if(show){me.inputCmp.applyAutogrow();me.adjustLogHeight(true);me.logCmp.applySlimScroll(me.initialLogHeight);me.logCmp.scrollTop();}else{me.logCmp.hideSystemMessages();}}}]);this.pollForUploadUrl(show);};MainConsultantPanel.prototype.isLogEmpty=function(){return this.logCmp.isEmpty();};MainConsultantPanel.prototype.clearValues=function(){this.getInputField().val(g.uLiB.field.Field.prototype.emptyValue).keyup();};MainConsultantPanel.prototype.getLogHtml=function(){return this.logCmp.getLogHtml();};MainConsultantPanel.prototype.getEmailToSendChatTo=function(){return this.emailChatForm.getValues()['email'];};MainConsultantPanel.prototype.getSoundState=function(){var btn=this.getFunctionalToolbarCmp().soundBtn;return btn?btn.state:'off';};MainConsultantPanel.prototype.getFileUploadCmp=function(){return this.inputCmp.fileUploadCmp;};MainConsultantPanel.prototype.setUploadUrl=function(url){this.getFileUploadCmp().setUploadUrl(url);};MainConsultantPanel.prototype.requestUploadUrl=function(url){var me=this;Comagic.getUploadUrl&&Comagic.getUploadUrl(function(data){(data&&data.success)&&me.setUploadUrl(data.result.upload_url);});};MainConsultantPanel.prototype.pollForUploadUrl=function(poll){var me=this,now=(new Date()).getTime();if(poll&&!me.pollingForUploadUrlIntervalId&&me.isUploadUrlPollingIntervalExspired()){me.pollingStartTime=now;var fn=function(){me.requestUploadUrl();};fn();me.pollingForUploadUrlIntervalId=g.setInterval(fn,me.uploadUrlPollingInterval);}else if(!poll){me.pollingStartTime=0;g.clearInterval(me.pollingForUploadUrlIntervalId);me.pollingForUploadUrlIntervalId=null;}};MainConsultantPanel.prototype.setIsMinimized=function(isMinimized){u.storageSet('isMinimized',isMinimized,false);};MainConsultantPanel.prototype.getIsMinimized=function(){return u.storageGet('isMinimized')};u.apply(u.ns(ns),{MainConsultantPanel:MainConsultantPanel});})(window,'uLiB.banner.form');(function(g,ns){var ul=g.uLiB,u=ul.util,Element=ul.el.Element,Div=ul.el.Div,CallButton=ul.cmp.CallButton,CommonFormPanel=ul.banner.form.CommonFormPanel,OperatorRatingCmp=ul.banner.consultant.OperatorRatingCmp,SimpleInputCmp=ul.banner.consultant.SimpleInputCmp,Log=ul.banner.consultant.Log,LinklikeButton=uLiB.cmp.LinklikeButton,FunctionalButton=uLiB.cmp.FunctionalButton,Consultant=ul.banner.consultant.Consultant,FileUpload=ul.cmp.FileUpload,SimpleSoundButton=ul.banner.consultant.SimpleSoundButton,_$=u._$;function SimpleConsultantPanel(o){this.addCls('consultant-simple');this.ftype=this.ctype;if(o.banner_place){if(!(u.arrayIsContain(o.banner_place.split('_'),'bottom'))){this.resizeHandleElementBottom=u.sformat('<div class="{0}"/>',u.getCssSelector(this.resizableCls,true));this.addCls('resizable-bottom');}else{this.resizeHandleElementTop=u.sformat('<div class="{0}"/>',u.getCssSelector(this.resizableCls,true));this.addCls('resizable-top');}}
SimpleConsultantPanel.superclass.constructor.apply(this,arguments);this.resizableCt=this.getChildEl(this.resizableCls);if(this.resizableCt.length){this.resizableCt[0].onmousedown=u.bind(this.onResizeStart,this);document.onmouseup=u.bind(this.onResizeEnd,this);document.onmousemove=u.bind(this.onResizeMove,this);}
this.headerCt[0].onmousedown=u.bind(this.closeSettingsMenuPanel,this);this.footerCt[0].onmousedown=u.bind(this.closeSettingsMenuPanel,this);if(this.state.isAlreadyRated){this.getItem(OperatorRatingCmp)&&this.getItem(OperatorRatingCmp).getEl().hide();}}
u.extend(SimpleConsultantPanel,'uLiB.banner.form.MainConsultantPanel');SimpleConsultantPanel.prototype.elementsToRender=['tools','header','items','sendChatByEmailContainer','inputCmpPlaceholder','footer'];SimpleConsultantPanel.prototype.html='<div style="height: 380px;">'+'<div class="{toolsCls}"/>'+'<div class="{containerCls}">'+'{resizeHandleElementTop}'+'<div class="{headerCls}">'+'<span class="{operatorAvatarWrapperCls}">'+'<img src="{blankImgSrc}" class="{operatorAvatarCls}">'+'</span>'+'<div class="{operatorInfoCls}">'+'<div class="{operatorNameCls}"/>'+'<div class="{operatorPositionCls}"/>'+'</div>'+'<div class="{callBtnPlaceholderCls}"/>'+'</div>'+'<div class="{itemsCls}"/>'+'<div class="{sendChatByEmailContainerCls}"/>'+'<div class="{inputCmpPlaceholderCls}"/>'+'<div class="{footerCls}"/>'+'</div>'+'{resizeHandleElementBottom}'+'</div>';SimpleConsultantPanel.prototype.emailChatCmpAnimationKey='simple-email-chat-cmp';SimpleConsultantPanel.prototype.draggable=true;SimpleConsultantPanel.prototype.stateful=true;SimpleConsultantPanel.prototype.stateId='consultant-simple';SimpleConsultantPanel.prototype.hasGlobalState=true;SimpleConsultantPanel.prototype.renderItems=function(){var items=[{__class:Log}];if(this['is_consultant_operator_rating']&&!this['operator_rating']){items.push({__class:OperatorRatingCmp});}
this.items=items;CommonFormPanel.prototype.renderItems.apply(this,arguments);this.logCmp=this.getItem(Log);};SimpleConsultantPanel.prototype.renderHeader=function(){if(u.hasConnectWayEnabled.call(this,u.C.CW_SITE_PHONE)){this.callBtn=new CallButton({action:'open-site-phone',text:'Позвонить'});this.getInnerEl(this.callBtnPlaceholderCls).replaceWith(this.callBtn.getEl());}};SimpleConsultantPanel.prototype.renderFooter=function(){this.footerCt.addClass('consultant-panel');var menuItems=[{text:'Распечатать чат...',action:'print',ctype:'functional-button-print'},{text:'Отправить чат на почту...',action:'email-chat',ctype:'functional-button-email'}];menuItems.unshift(this.fileUploadCmp=new FileUpload({text:'Прикрепить файл...',onReceive:u.bind(this.onFileReceive,this),validExtensions:u.C.VALID_FILE_EXTENSIONS}));if(u.supportAudio()){menuItems.push(new SimpleSoundButton({stateId:'consultant-simple-sound-btn',onClick:u.bind(this.onSimpleSoundButtonClick,this)}));}
this.settingsBtn=new LinklikeButton({text:'Настройки',cls:'settings-button',menu:{items:menuItems,o:this.o,cls:'simple-consultant-settings-menu',onItemClick:u.bind(this.onMenuItemClick,this)},renderTo:this.footerCt});if(this.o.banner_branding_text&&this.o.banner_branding_url){new Element({tag:'div',cls:'link-panel',children:[{tag:'a',href:this.o.banner_branding_url,target:'_blank',cls:'link',text:this.o.banner_branding_text}],renderTo:this.footerCt});}};SimpleConsultantPanel.prototype.closeSettingsMenuPanel=function(){if(this.settingsBtn.menu.isVisible()){this.settingsBtn.menu.show(false);this.settingsBtn.changeState('off');}};SimpleConsultantPanel.prototype.renderInputCmpPlaceholder=function(){this.inputCmpPlaceholderCt.replaceWith((this.inputCmp=new SimpleInputCmp({onTextareaHeightSet:u.bind(this.onMainInputTextareaHeightSet,this),animationKey:'simple-input-cmp',parentCmp:this})).getEl());};SimpleConsultantPanel.prototype._onClick=function(cmp,deepCType,ctype,event,target,isOwnEvent){var me=this;deepCType!=='consultant--text-button'&&this.closeSettingsMenuPanel();if(ctype==='functional-button-email'){this.toggleEmailChatFormVisibility();}else if(ctype==='functional-button-thumb-up'||ctype==='functional-button-thumb-down'){var rating=ctype==='functional-button-thumb-up'?5:1,ratingCmp=this.getItem(OperatorRatingCmp);this._onRateOperatorFieldRate(rating);this.state.isAlreadyRated=true;this.saveState();ratingCmp.getEl().hide({effect:'fade',duration:uLiB.util.AnimationManager.durationInnerFade,easing:uLiB.util.AnimationManager.easing,complete:function(){me.adjustLogHeight();}});}else if(ctype==='text-button-cancel'){this.toggleEmailChatFormVisibility(false);}else if(ctype==='common-button-send-chat-by-email'){if(this.emailChatForm.isValid()){this.toggleEmailChatFormVisibility(false);}}};SimpleConsultantPanel.prototype.toggleEmailChatFormVisibility=function(visible){if(visible===undefined){visible=true;}
this.emailChatForm.show(visible,this.animationEnabled);this.inputCmp.show(!visible,this.animationEnabled);this.itemsCt[!visible?'show':'hide']({effect:'fade',duration:50});this.footerCt[!visible?'show':'hide']({effect:'fade',duration:50});};SimpleConsultantPanel.prototype.getSoundState=function(){var btn=this.settingsBtn.menu.getItem('toggle-sound');return btn?btn.state:'off';};SimpleConsultantPanel.prototype.onMenuItemClick=function(item,action){var args=[this,'',item.ctype];this._onClick.apply(this,args);this.__onClick.apply(this,args);if(action==='toggle-sound'){this.turnSoundOn(this.getSoundState()==='on');}};SimpleConsultantPanel.prototype.show=function(show){SimpleConsultantPanel.superclass.show.apply(this,arguments);if(!show){this.settingsBtn.menu.show(false);}};SimpleConsultantPanel.prototype.onSimpleSoundButtonClick=function(cmp,deepCType,ctype,event,target,isOwnEvent){this.onMenuItemClick(cmp,cmp.action);};SimpleConsultantPanel.prototype.getFileUploadCmp=function(){return this.fileUploadCmp;};u.apply(u.ns(ns),{SimpleConsultantPanel:SimpleConsultantPanel});})(window,'uLiB.banner.form');(function(g,ns){var ul=g.uLiB,u=ul.util,DynamicFormPanel=ul.banner.form.DynamicFormPanel,_$=u._$;function VisitorInfoRequestPanel(o){this.addCls('visitor-info-request');this.buttonText='Начать чат';VisitorInfoRequestPanel.superclass.constructor.call(this,o,{message:'Операторы нашей компании готовы вам помочь'});VisitorInfoRequestPanel.prototype.draggable=true;VisitorInfoRequestPanel.prototype.stateful=true;VisitorInfoRequestPanel.prototype.stateId='visitor-info-request';VisitorInfoRequestPanel.prototype.hasGlobalState=true;}
u.extend(VisitorInfoRequestPanel,DynamicFormPanel);VisitorInfoRequestPanel.prototype.ctype=u.C.CW_VISITOR_INFO_REQUEST;u.apply(u.ns(ns),{VisitorInfoRequestPanel:VisitorInfoRequestPanel});})(window,'uLiB.banner.form');(function(g,ns){var ul=g.uLiB,u=ul.util,Element=ul.el.Element,ModalPanel=ul.cmp.ModalPanel,PhoneField=ul.field.PhoneField,RetentionMainButton=ul.cmp.RetentionMainButton,_$=u._$;function RetentionPanel(o,s){this.s=s;this.o=o;this.titleCls='retention-panel-title';this.messageCls='retention-panel-message';this.footerCls='retention-panel-footer';this.bodyCls='retention-panel-body';this.buttonText=s.button;this.titleText=u.crLfToBr(s.title);this.messageText=u.crLfToBr(s.message);this.targetEl=document.body;this.isMaskPositionFixed=true;this.isElPositionFixed=true;RetentionPanel.superclass.constructor.apply(this,arguments);}
u.extend(RetentionPanel,ModalPanel);RetentionPanel.prototype.ctype=u.C.CW_RETENTION;RetentionPanel.prototype.html='<div>'+'<div class="{titleCls}">{titleText}</div>'+'<div class="{bodyCls}"></div>'+'<div class="{messageCls}">{messageText}</div>'+'<div class="{footerCls}"></div>'+'</div>';RetentionPanel.prototype.afterRender=function(){RetentionPanel.superclass.afterRender.apply(this,arguments);this.renderBody();this.renderFooter();};RetentionPanel.prototype.renderBody=function(){var bodyEl=this.getInnerEl(this.bodyCls);this.phoneField=new PhoneField({renderTooltipInside:true,tooltipType:'rich',allowBlank:false,name:'phone',notemptyText:'Укажите телефон',renderTo:bodyEl});new RetentionMainButton({text:this.buttonText,renderTo:bodyEl});};RetentionPanel.prototype.renderFooter=function(){var footerEl=this.getInnerEl(this.footerCls);if(this.o.banner_branding_text&&this.o.banner_branding_url){new Element({tag:'a',href:this.o.banner_branding_url,target:'_blank',cls:'link',text:this.o.banner_branding_text,renderTo:footerEl});}};RetentionPanel.prototype.getFields=function(){return[this.phoneField];};u.apply(u.ns(ns),{RetentionPanel:RetentionPanel});})(window,'uLiB.banner.form');(function(){var ul=window.uLiB,g=window,u=ul.util,_$=u._$,_cs=g.__cs||g.Comagic,Element=ul.el.Element,Div=ul.el.Div,Component=ul.cmp.Component,FormPanel=ul.cmp.FormPanel,PopupMessagePanel=ul.cmp.PopupMessagePanel,ModalPanel=ul.cmp.ModalPanel,ComponentManager=ul.cmp.ComponentManager,LeadRequestPreviewPanel=ul.banner.form.LeadRequestPreviewPanel,ConsultantPreviewPanel=ul.banner.form.ConsultantPreviewPanel,MainConsultantPanel=ul.banner.form.MainConsultantPanel,LeadRequestPanel=ul.banner.form.LeadRequestPanel,RetentionPanel=ul.banner.form.RetentionPanel,Field=ul.field.Field,TextField=ul.field.TextField,TextAreaField=ul.field.TextAreaField,PhoneField=ul.field.PhoneField,ToolButtonClose=ul.cmp.ToolButtonClose,ToolButtonUnpin=ul.cmp.ToolButtonUnpin,ToolButtonPin=ul.cmp.ToolButtonPin,ToolButtonMinimize=ul.cmp.ToolButtonMinimize,SmallButton=ul.cmp.SmallButton,StandardButton=ul.cmp.StandardButton;var CW_CONSULTANT='consultant',CW_SITE_PHONE='site_phone',CW_SITE_REQUEST='site_request',URL_DEFAULT_OPERATOR='{0}static/comagic/banner/resources/images/legacy/empty_operator.png',ZZZ;function WayItem(o){this.cls='way-item';this.ctype=o.ctype;this.text=o.title;WayItem.superclass.constructor.apply(this,arguments);this.addCls(this.ctype);}
u.extend(WayItem,Component);WayItem.prototype.html='<div></div>';WayItem.prototype.getTextEl=function(){return this.getEl();};WayItem.prototype.setText=function(text){var textEl=this.getTextEl();textEl&&textEl.text(text);this.setTooltip(text);};WayItem.prototype.afterRender=function(){WayItem.superclass.afterRender.apply(this,arguments);this.setText(this.text);};function BannerWayItem(o){BannerWayItem.superclass.constructor.apply(this,arguments);}
u.extend(BannerWayItem,WayItem);BannerWayItem.prototype.render=function(){this.html=this.isPrimary?WayItem.prototype.html:'<div/>';BannerWayItem.superclass.render.apply(this,arguments);if(this.isPrimary){this.iconEl=new Div({cls:'icon',renderTo:this});this.textEl=new Div({cls:'text',renderTo:this});this.labelCmp=new Div({cls:'label',renderTo:this,text:this.bannerLabel});}};BannerWayItem.prototype.getTextEl=function(){return this.isPrimary?this.textEl:null;};function SliderWayItem(){this.autoEl={tag:'div',children:[{tag:'div',cls:'slider-way-item-icon'},{tag:'div',cls:'slider-way-item-text'}]};SliderWayItem.superclass.constructor.apply(this,arguments);}
u.extend(SliderWayItem,WayItem);SliderWayItem.prototype.getTextEl=function(){return this.getEl().find(u.getCssSelector('.slider-way-item-text'));};function ButtonsWayItem(){this.autoEl={tag:'div',children:[{tag:'div',cls:'buttons-way-item-inner'}]};ButtonsWayItem.superclass.constructor.apply(this,arguments);}
u.extend(ButtonsWayItem,WayItem);ButtonsWayItem.prototype.getTextEl=function(){return null;};function Banner(o){this.trackClick=true;this.html='<div/>';this.connectWays=[];this.active=null;this.doActivate=u.inArray(CW_CONSULTANT,o['available_connect_ways'])!=-1&&o['available_connect_ways'].length>1;this.isConsultantSingleWay=u.inArray(CW_CONSULTANT,o['available_connect_ways'])!=-1&&o['available_connect_ways'].length==1;Banner.superclass.constructor.apply(this,arguments);!this['is_preview']&&this.show(false);}
u.extend(Banner,Component);Banner.prototype.ctype='label';Banner.prototype.cls='banner-container';Banner.prototype.respectBannerPlace=true;Banner.prototype.monitorResize=true;Banner.prototype.respectIsBannerDefaultMinimize=true;Banner.prototype.connectWayItemClass=BannerWayItem;Banner.prototype.initComponent=function(){Banner.superclass.initComponent.apply(this,arguments);this.buildExpandedEl();this.buildCollapsedEl();};Banner.prototype.buildExpandedEl=function(){var secondariesCls='secondaries';this.expandedCmp=new Component({cls:'banner-expanded',html:'<div/>'});this.expandedCmp.add(new Element({cls:secondariesCls,tag:'div'}));if(this.respectIsBannerDefaultMinimize){this['is_banner_default_minimize']&&this.expandedCmp.getEl().hide();}else{this.expandedCmp.getEl().hide();}
this.secondariesEl=this.expandedCmp.getEl().find('div');this.setSecondariesCls(this['available_connect_ways'].length-1);this.add(this.expandedCmp);this.expandedCmp.add(new Component({cls:'collapser',html:'<div/>',ctype:'collapser',zIndex:1}));this.processConnectWays();};Banner.prototype.buildCollapsedEl=function(){this.collapsedCmp=new Component({ctype:'expander',cls:'banner-collapsed',html:'<div/>'});this.collapsedCmp.add(new Div({text:this['banner_label'],cls:'banner-collapsed-label'}));this.collapsedCmp.add(new Div({cls:'banner-collapsed-cloud'}));if(this.respectIsBannerDefaultMinimize){!this['is_banner_default_minimize']&&this.collapsedCmp.getEl().hide();}else{this.collapsedCmp.getEl().show();}
this.add(this.collapsedCmp);};Banner.prototype.setSecondariesCls=function(count){if(!this.secondariesEl){return;}
if(count===undefined&&this.doActivate){count=this['available_connect_ways'].length-(this.active?1:2);}else if(count===undefined&&!this.doActivate){count=this['available_connect_ways'].length-1;}
var clses=['secondaries-none','secondaries-single','secondaries-couple'];for(var i=0,cls;(cls=clses[i]);i++){this.expandedCmp.getEl().removeClass(u.getCssSelector(cls,true));}
this.expandedCmp.getEl().addClass(u.getCssSelector(clses[count],true));};Banner.prototype.processConnectWays=function(){var ws=this['available_connect_ways'];for(var i=0,w;(w=ws[i]);i++){this.addConnectWay(w);}};Banner.prototype.addConnectWay=function(wayMnemonic){var isPrimary=wayMnemonic==this['preferred_connect_way'],title=this['cw_'+wayMnemonic+'_title'];this.connectWays.push(new this.connectWayItemClass({ctype:wayMnemonic,title:title,isPrimary:isPrimary,renderTo:this._getWayItemsContainer(isPrimary),bannerLabel:this['banner_label']}));};Banner.prototype._getConnectWayItem=function(mnemonic){var ws=this.connectWays;for(var i=0,w;(w=ws[i]);i++){if(_$.type(mnemonic)=='string'&&w.ctype===mnemonic){return w;}
if(_$.type(mnemonic)=='function'&&mnemonic(w.ctype)){return w;}}
return null;};Banner.prototype._getConsultantItem=function(){return this._getConnectWayItem(CW_CONSULTANT);};Banner.prototype._getFirstNonConsultantItem=function(){return this._getConnectWayItem(function(ctype){return ctype!=CW_CONSULTANT;});};Banner.prototype._onActivate=function(){this.setSecondariesCls();this[this.active?'_onGettingActive':'_onGettingInactive']();};Banner.prototype._onGettingInactive=function(){this._getConsultantItem().getEl().remove();if(this.connectWayItemClass===BannerWayItem&&this['preferred_connect_way']==CW_CONSULTANT){var nci=this._getFirstNonConsultantItem();nci.getEl().remove();nci.reRender({isPrimary:true,renderTo:this.expandedCmp});}};Banner.prototype._onGettingActive=function(){var ci=this._getConsultantItem();ci.reRender({renderTo:this._getWayItemsContainer(ci.isPrimary)});if(this.connectWayItemClass===BannerWayItem&&this['preferred_connect_way']==CW_CONSULTANT){var nci=this._getFirstNonConsultantItem();nci.getEl().remove();nci.reRender({isPrimary:false,renderTo:this.secondariesEl});}};Banner.prototype._getWayItemsContainer=function(isPrimary){return isPrimary?this.expandedCmp:this.secondariesEl;};Banner.prototype.expand=function(expand){if(expand){this.expandedCmp.getEl().show();this.collapsedCmp.getEl().hide();}else{this.expandedCmp.getEl().hide();this.collapsedCmp.getEl().show();}
this.onExpand&&this.onExpand(expand);};Banner.prototype.activate=function(active){if(active===this.active){return;}
var isFirstActivation=(this.active===null);this.active=active;if(this['is_not_showing_unactive_banner']||this.isConsultantSingleWay){this.show(this.active);return;}else if(isFirstActivation){this.show(true);}
if(!this.doActivate){return;}
this._onActivate();};function Slider(){Slider.superclass.constructor.apply(this,arguments);}
u.extend(Slider,Banner);Slider.prototype.connectWayItemClass=SliderWayItem;Slider.prototype.cls='slider-container';Slider.prototype.expandedCls='slider-expanded';Slider.prototype.respectIsBannerDefaultMinimize=false;Slider.prototype.buildExpandedEl=function(){this.expandedCmp=new Component({cls:this.expandedCls,html:'<div/>'});this.expandedCmp.add(new Div({text:this['banner_label'],cls:'banner-collapsed-label'}));this.expandedCmp.add(new Div({cls:'banner-collapsed-cloud'}));this.wayItemsEl=new Div({cls:'connect-way-items'});this.expandedCmp.add(this.wayItemsEl);this.expandedCmp.add(new Component({cls:'collapser',html:'<div/>',ctype:'collapser',zIndex:1}));if(this.respectIsBannerDefaultMinimize){this['is_banner_default_minimize']&&this.expandedCmp.getEl().hide();}else{this.expandedCmp.getEl().hide();}
this.add(this.expandedCmp);this.processConnectWays();};Slider.prototype.addConnectWay=function(wayMnemonic){this.connectWays.push(new this.connectWayItemClass({ctype:wayMnemonic,renderTo:this.wayItemsEl,title:this['cw_'+wayMnemonic+'_title']}));};Slider.prototype._getWayItemsContainer=function(isPrimary){return this.wayItemsEl;};function Buttons(){this.connectWayItemClass=ButtonsWayItem;Buttons.superclass.constructor.apply(this,arguments);}
u.extend(Buttons,Slider);Buttons.prototype.cls='buttons-container';Buttons.prototype.expandedCls='buttons-expanded';Buttons.prototype.buildExpandedEl=function(){this.wayItemsEl=this.expandedCmp=new Component({cls:this.expandedCls,html:'<div/>'});this.add(this.expandedCmp);this.processConnectWays();};Buttons.prototype.buildCollapsedEl=function(){};Buttons.prototype.expand=function(){};function SitePhone(o){this.title='Звонок с сайта';this.weCallBackInMinute='Мы перезвоним в течение минуты';this.trackClick=true;this.renderTo='body';this.zIndex=1;this.tools=[ul.cmp.ToolButtonClose];this.captchaField=o.is_captcha_enabled&&new ul.field.CaptchaField({label:'Введите символы с изображения',name:'captcha_val',is_preview:o['is_preview']});this.items=[new PhoneField({name:'phone',label:'Ваш телефон',allowBlank:false}),this.captchaField];this.buttons=[new StandardButton({text:'Перезвоните мне',ctype:'standard-button-send'})];this.footer=new Div({text:this.weCallBackInMinute,cls:'info-label'});SitePhone.superclass.constructor.apply(this,arguments);this.show(false);}
u.extend(SitePhone,FormPanel);SitePhone.prototype.ctype=CW_SITE_PHONE;SitePhone.prototype.nonCaptchaCls='non-captcha';SitePhone.prototype.clearOnSubmit=false;SitePhone.prototype.renderHidden=true;SitePhone.prototype.refreshCaptcha=function(){this.o.is_captcha_enabled&&this.captchaField.refreshCaptcha();};SitePhone.prototype.show=function(show){show&&this.refreshCaptcha();this[this.o.is_captcha_enabled?'removeCls':'addCls'](this.nonCaptchaCls);SitePhone.superclass.show.apply(this,arguments);};function ConsultantLog(o){this.autoEl={tag:'div',children:[{tag:'div',cls:this.innerCls}]};this.addCls('consultant-log');ConsultantLog.superclass.constructor.apply(this,arguments);this.logEl=this.getEl().find('.'+u.getCssSelector(this.innerCls,true));}
u.extend(ConsultantLog,Component);ConsultantLog.prototype.ctype='consultant-log';ConsultantLog.prototype.innerCls='consultant-log-inner';ConsultantLog.prototype.logRecordTpl='<p class="comagic-message {0} {4}"><span class="comagic-time">{1}</span><span class="comagic-from">{2}</span><br>{3}</p>';ConsultantLog.prototype.hrefRe=/(^|\s)((?:https?:\/\/)?(?:[^\s.\/"]+)\.(?:[^\s\/]{2,6})(?:[^\s\"]*)*\/?)/mgi;ConsultantLog.prototype.hrefTpl='$1<a href="$2">$2</a>';ConsultantLog.prototype.processLinks=function(str){return str.replace(this.hrefRe,this.hrefTpl);};ConsultantLog.prototype.processCrFl=function(str){return str.replace('/\n/g','<br/>').replace('/\r/g','<br/>');};ConsultantLog.prototype.composeRecord=function(o){var cls=!o.from?'system':'',sourceCls=o.source=='Оператор'?'consultant-log-operator':'consultant-log-visitor';var message=this.processLinks(this.processCrFl(o.message||'')),date=o.date;var timeDelta=this.timeDelta===undefined?Comagic.getTimeDelta():this.timeDelta;date=date.split(' ');date[0]=date[0].split('.');date[1]=date[1].split(':');date=new Date(date[0][2],date[0][1],date[0][0],date[1][0],date[1][1],date[1][2]);date.setTime(date.getTime()-timeDelta*1000);return u.sformat(this.logRecordTpl,u.getCssSelector(cls,true),u.tformat(date),o.from,message,u.getCssSelector(sourceCls,true));};ConsultantLog.prototype.getLogEl=function(){return this.logEl;};ConsultantLog.prototype.addRecord=function(o,replace){if(replace===true){this.getLogEl().empty();}
if(_$.isArray(o)){for(var i=0,mo;(mo=o[i]);i++){this.addRecord(mo);}}else{this.getLogEl().append(this.composeRecord(o));this.scrollTop();}};ConsultantLog.prototype.scrollTop=function(){this.getLogEl().scrollTop(10000);};ConsultantLog.prototype.setTypeNotifier=function(isTyping){if(isTyping!==undefined){var notifierMessages=this.getLogEl().find('.comagic-consultant-is-typing');if(isTyping){if(!notifierMessages.length){this.getLogEl().append(new Element({tag:'span',cls:'consultant-is-typing'}));this.scrollTop();}}else{notifierMessages.remove();}}else{this.setTypeNotifier(true);if(this.typeTimeoutId){clearTimeout(this.typeTimeoutId);this.typeTimeoutId=null;}
this.typeTimeoutId=g.setTimeout(u.bind(function(){this.typeTimeoutId=null;this.setTypeNotifier(false);},this),20000);}};ConsultantLog.prototype.isEmpty=function(){return!this.getLogEl().text().replace(/\s+/g,'');};ConsultantLog.prototype.getLogHtml=function(){return this.getLogEl().html();};function RateOperatorField(o){this.autoEl={tag:'div'};this.addCls('rate-operator-field');RateOperatorField.superclass.constructor.apply(this,arguments);}
u.extend(RateOperatorField,Field);RateOperatorField.prototype.ctype='rate-operator-field';RateOperatorField.prototype.rates=[1,2,3,4,5];RateOperatorField.prototype.itemTplCls='inactive';RateOperatorField.prototype.itemTpl=u.sformat('<div class="{itemTplCls}" comagic-type="comagic-rate-operator--{0}"></div>',RateOperatorField.prototype);RateOperatorField.prototype.afterRender=function(){RateOperatorField.superclass.afterRender.apply(this,arguments);this.ratesContainer=this.getInputEl();this.renderRates();this.setValue(this.value);};RateOperatorField.prototype.initEvents=function(){RateOperatorField.superclass.initEvents.apply(this,arguments);};RateOperatorField.prototype.onMouseover=function(cmp,deepCType,ctype){var rating=+ctype,me=this;if(!this.ratingSet){this.ratesContainer.children().each(function(idx,el){if(idx<=rating-1){_$(this).removeClass(u.getCssSelector(me.itemTplCls,true));}else{_$(this).addClass(u.getCssSelector(me.itemTplCls,true));}});}};RateOperatorField.prototype.onMouseout=function(){var me=this;if(!this.ratingSet){this.ratesContainer.children().each(function(idx,el){_$(this).addClass(u.getCssSelector(me.itemTplCls,true));});}};RateOperatorField.prototype.onClick=function(cmp,deepCType,ctype){var superOnClick=RateOperatorField.superclass.onClick;superOnClick&&superOnClick.apply(this,arguments);this._rateOperator(ctype);};RateOperatorField.prototype._rateOperator=function(rating){rating=+rating;if(isNaN(rating)){return;}
this.ratingSet=true;this._onRate(rating);};RateOperatorField.prototype._onRate=function(rating){this.onRate(rating);};RateOperatorField.prototype.onRate=function(rating){};RateOperatorField.prototype.renderRates=function(){var rs=this.rates;for(var i=0,r;(r=rs[i]);i++){this.ratesContainer.append(u.sformat(this.itemTpl,r));}};RateOperatorField.prototype.getValue=function(){return this.rate;};RateOperatorField.prototype.setValue=function(val){var me=this;if(!this.ratesContainer){return;}
this.ratesContainer.children().each(function(idx,el){if(idx<=val-1){_$(this).removeClass(u.getCssSelector(me.itemTplCls,true));}else{_$(this).addClass(u.getCssSelector(me.itemTplCls,true));}});};function ConsultantSmallButtonsBox(o){this.autoEl={tag:'div',cls:this.cls,children:[new SmallButton({action:'print',cls:'small-button-print',tooltip:'Распечатать чат'}),new SmallButton({action:'email',cls:'small-button-email',tooltip:'Отправить чат на e-mail'})]};ConsultantSmallButtonsBox.superclass.constructor.apply(this,arguments);}
u.extend(ConsultantSmallButtonsBox,Component);ConsultantSmallButtonsBox.prototype.ctype='small-buttons-box';ConsultantSmallButtonsBox.prototype.cls='small-buttons-box';function Consultant(o){if(o.isStandalone){u.addCssLink(o);this.addCls('external');}
this.trackClick=true;this.renderTo='body';this.zIndex=1;this.tools=[ToolButtonClose,ToolButtonUnpin,ToolButtonPin,ToolButtonMinimize];this.addCls(CW_CONSULTANT);this.subtitle=(new Div({children:[this.companyLogoEl=new Element({tag:'img',cls:'company-logo'}),this.operatorAvatarEl=new Element({tag:'img',cls:'operator-avatar'}),this.textEl=new Div({cls:'panel-subtitle-text',children:[new Div({cls:'operator-name-title',children:['Консультант']}),this.operatorNameEl=new Div({cls:'operator-name-text'})]})]}));this.items=[(this.consultantLogCmp=new ConsultantLog()),(this.inputField=new TextAreaField({name:'message',allowBlank:false,markInvalid:false}))];this.buttons=[new StandardButton({text:'Отправить',action:'send'})];var footerItems=[];if(o['is_consultant_operator_rating']){this.ratingField=new RateOperatorField(u.apply({value:o['operator_rating'],label:'Оцените оператора'},o));this.ratingField.onRate=u.bind(this._onRateOperatorFieldRate,this);footerItems.push(this.ratingField);}
this.buttonsBox=new ConsultantSmallButtonsBox(o);footerItems.push(this.buttonsBox);footerItems.length&&(this.footer=new Div({children:footerItems}));Consultant.superclass.constructor.apply(this,arguments);o['company_logo_url']&&this.setCompanyLogo(o['company_logo_url']);this.setOperatorPic();this.show(false);this.initChatWatcher();}
u.extend(Consultant,FormPanel);Consultant.prototype.ctype=CW_CONSULTANT;Consultant.prototype.initChatWatcher=function(){var me=this;me.chatWatcherEnabled=true;g.setInterval(function(){var val=me.inputField.getInputEl().val();if(me.oldInputFieldVal!==val){me.oldInputFieldVal=val;me._onTextAreaChange(val);}},1000);};Consultant.prototype.addLogRecord=function(o){this.consultantLogCmp.addRecord(o);};Consultant.prototype.setOperatorRating=function(rating){this.ratingField.setValue(rating);};Consultant.prototype.setOperator=function(name,fileLink){this.setOperatorName(name);this.setOperatorPic(fileLink);};Consultant.prototype.setOperatorName=function(name){this.operatorNameEl.text(name);};Consultant.prototype.setOperatorPic=function(url){if(url==='default'){url=null;}
url=url||u.sformat(URL_DEFAULT_OPERATOR,this['comagic_web_url']);this.operatorAvatarEl.attr('src',url)[url?'show':'hide']();};Consultant.prototype.setCompanyLogo=function(url){url=this.buildUrl(url);this.companyLogoEl.attr('src',url)[url?'show':'hide']();};Consultant.prototype.setTypeNotifier=function(isTyping){this.consultantLogCmp.setTypeNotifier(isTyping);};Consultant.prototype.onClick=function(cmp,deepCType,ctype){u.log('Consultant.prototype.onClick',arguments);if(ctype=='standard-button-send'){g.setTimeout(u.bind(function(){this.inputField.getInputEl().focus();},this),100);}};Consultant.prototype.loadHistory=function(messages){this.consultantLogCmp.addRecord(messages);};Consultant.prototype.isLogEmpty=function(){this.consultantLogCmp.isEmpty();};Consultant.prototype.getLogHtml=function(){return this.consultantLogCmp.getLogHtml();};Consultant.prototype.buildUrl=function(url){url=url||'';if(u.startsWith(url,['http://','https://','ftp://','//'])){return url;}
if(u.startsWith(url,'/')){return this['comagic_web_url']+url;}
return'';};Consultant.prototype.show=function(show){Consultant.superclass.show.apply(this,arguments);show&&this.consultantLogCmp.scrollTop();};Consultant.prototype._onTextAreaChange=function(text){this.chatWatcherEnabled&&this.onTextAreaChange(text);};Consultant.prototype._onRateOperatorFieldRate=function(rating){this.onRateOperatorFieldRate(rating);};Consultant.prototype.onRateOperatorFieldRate=function(rating){};Consultant.prototype.onTextAreaChange=function(text){};function LeadRequest(o,s){this.s=s||{};this.s.message=this.s.message.replace(/\n/g,'<br />');this.trackClick=true;this.renderTo='body';this.zIndex=1;this.tools=[ToolButtonClose];var subtitless=[this.companyLogoEl=new Element({tag:'img',cls:'company-logo'}),this.textEl=new Div({children:[this.s.message||''],cls:'panel-subtitle-text'}),this.operatorAvatarEl=new Element({tag:'img',cls:'operator-avatar'})];this.subtitle=(new Div({children:subtitless}));this.items=this.buildItems();this.buttons=[new StandardButton({text:'Отправить',action:'send'})];LeadRequest.superclass.constructor.apply(this,arguments);this.show(false);o['company_logo_url']&&this.companyLogoEl.attr('src',this.comagicObj.buildUrl(o['company_logo_url']));}
u.extend(LeadRequest,FormPanel);LeadRequest.prototype.ctype='lead_request';LeadRequest.prototype.fieldsMap={'name':{__class:TextField,label:'Ваше имя',placeholder:'как к вам обращаться'},'phone':{__class:PhoneField,label:'Телефон',placeholder:'номер для связи'},'email':{__class:TextField,label:'E-mail',placeholder:'адрес для ответа',validators:['email']},'message':{__class:TextAreaField,label:'Ваш вопрос',placeholder:'текст вопроса'}};LeadRequest.prototype.getItemRequirement=function(name,o){return o['require_'+name]||o['consultant_require_'+name];};LeadRequest.prototype.buildItems=function(){var fm=LeadRequest.prototype.fieldsMap,ret=[],requirement;for(var name in fm){if(!fm.hasOwnProperty(name)){continue;}
requirement=this.getItemRequirement(name,this.s);if(requirement&&requirement!='unused'){ret.push(ComponentManager.create(u.apply({allowBlank:requirement!='required',name:name},fm[name])));}}
return ret;};function VisitorInfo(o){VisitorInfo.superclass.constructor.call(this,o,u.apply({message:'Менеджеры нашей компании<br/> сейчас онлайн и будут рады вас проконсультировать.'},o));}
u.extend(VisitorInfo,LeadRequest);VisitorInfo.prototype.ctype=u.C.CW_VISITOR_INFO_REQUEST;function SiteRequest(o){this.title='Заявка с сайта';SiteRequest.superclass.constructor.call(this,o,{message:'',require_name:'required',require_email:'required',require_phone:'optional',require_message:'required'});}
u.extend(SiteRequest,LeadRequest);SiteRequest.prototype.ctype=CW_SITE_REQUEST;function ComagicObject(o){o=this.processParams(o);this.o=o;u.apply(this,o);u.addCssLink(o);o['renderTo']=o['renderTo']||'body';this.comagicWebUrl=o['comagic_web_url']||'';this.companyLogoUrl=this.buildUrl(o['company_logo_url']);this.cmpConfig=u.apply({_onClick:u.bind(this.onComponentClick,this),_onKeyup:u.bind(this.onComponentKeyup,this),_onKeydown:u.bind(this.onComponentKeydown,this),comagicObj:this,cw_site_phone_title:'Позвонить бесплатно',cw_consultant_title:'Спросить оператора',cw_site_request_title:'Задать вопрос',monitorResize:true},o);if(o['is_using_standard_banner']){var _class=this.getBannerClass(o);this.activeComponent=this.labelCmp=new _class(u.apply({zIndex:0},this.cmpConfig));}
this.labelCmp&&(this.labelCmp.onExpand=u.bind(this.onBannerExpand,this));this.sitePhoneCmp=new(this.getFormPanelClass(u.C.CW_SITE_PHONE))(this.cmpConfig);this.siteRequestCmp=new(this.getFormPanelClass(u.C.CW_SITE_REQUEST))(this.cmpConfig);this.consultantCmp=new(this.getFormPanelClass(u.C.CW_CONSULTANT))(this.cmpConfig);this.consultantCmp.onRateOperatorFieldRate=u.bind(this._onOperatorRate,this);this.consultantCmp.onTextAreaChange=u.bind(this._onConsultantTextAreaChange,this);this.visitorInfoCmp=new(this.getFormPanelClass(u.C.CW_VISITOR_INFO_REQUEST))(this.cmpConfig);ComponentManager.registerCType(this.isMsSkin()?LeadRequestPanel:LeadRequest);ComponentManager.registerCType(RetentionPanel);if(o.banner_skin==='touch'){ComponentManager.registerCType(LeadRequestPreviewPanel);ComponentManager.registerCType(ConsultantPreviewPanel);}
ComagicObject.prototype.instance=this;}
ComagicObject.prototype.isMsSkin=function(o){return u.isMsSkin(o||this);};ComagicObject.prototype.getBannerClass=function(o){var size=o['banner_size'];if(this.isMsSkin()){return uLiB.banner.label[{full_size:'Banner',slider:'Slider',button:'Buttons',buttons:'Buttons'}[size]];}
return{full_size:Banner,slider:Slider,button:Buttons,buttons:Buttons}[size];};ComagicObject.prototype.getFormPanelClass=function(ctype){var cmap=this.isMsSkin()?{'consultant':this['banner_skin']==='main'?uLiB.banner.form.MainConsultantPanel:uLiB.banner.form.SimpleConsultantPanel,'site_phone':uLiB.banner.form.SitePhonePanel,'site_request':uLiB.banner.form.SiteRequestPanel,'visitor_info_request':uLiB.banner.form.VisitorInfoRequestPanel}:{'consultant':Consultant,'site_phone':SitePhone,'site_request':SiteRequest,'visitor_info_request':VisitorInfo};return cmap[ctype];};ComagicObject.prototype.processParams=function(o){var processors=[{fn:u.stripTags,params:['cw_site_phone_title','cw_consultant_title','cw_site_request_title','banner_label']}];for(var i=0,p;(p=processors[i]);i++){for(var j=0,pn;(pn=p.params[j]);j++){if(o[pn]){o[pn]=p.fn(o[pn]);}}}
if(u.C.IS_TOUCH_DEVICE){o.banner_size='slider';o.banner_skin='touch';o.banner_place='bottom_stretch';}
return o;};ComagicObject.prototype.onBannerExpand=function(expanded){this.onExpand(expanded);};ComagicObject.prototype.onComponentKeydown=function(cmp,deepCType,ctype,event){u.log('onComponentKeyDown',arguments);var keyCode=event.keyCode,ctrlKey=event.ctrlKey,metaKey=event.metaKey,shiftKey=event.shiftKey;if(keyCode==13&&(ctrlKey||metaKey)){cmp.isValid()&&this._onCmpSubmit(cmp,cmp.getValues());}else if(keyCode==13&&deepCType==='consultant--email-chat-cmp--field'){if(cmp.emailChatForm.isValid()){this.onSendChatByEmail(cmp.emailChatForm.getValues());}}else if(keyCode==13&&!shiftKey&&(u.isinstance(cmp,uLiB.banner.form.MainConsultantPanel)||u.isinstance(cmp,uLiB.banner.form.SimpleConsultantPanel))){cmp.isValid()&&this._onCmpSubmit(cmp,cmp.getValues());g.setTimeout(function(){cmp.getInputField().keydown();},100);return false;}else{var me=this;if(this.chatTypingNotificationTimeoutId===undefined){this.onChatTyping();this.chatTypingNotificationTimeoutId=g.setTimeout(function(){me.chatTypingNotificationTimeoutId=undefined;},20000);}}};ComagicObject.prototype.onComponentKeyup=function(cmp,deepCType,ctype,event){u.log('onComponentKeyup',arguments);};ComagicObject.prototype.onComponentClick=function(cmp,deepCType,ctype,event){u.log('onComponentClick',arguments);if(ctype=='tool-button-close'){this._onCmpClose(cmp);if(cmp.ctype=='lead_request_preview'||cmp.ctype=='lead_request'){this.onLeadRequestCancel(cmp.s['lead_id']);}
if(cmp.ctype=='consultant_preview'){this.onInviteReject();}
if(cmp.ctype=='retention'){this.onRetentionCancel(cmp.s['retention_id']);}
if(cmp instanceof ModalPanel){cmp.destroy();}
if(!(cmp instanceof ModalPanel)){this.openCmp('label');}
if(cmp instanceof Consultant||deepCType==='consultant--tool-button-close'){this.onChatClose();}}else if(u.arrayIsContain(['standard-button-send','common-button-send'],ctype)&&!this['is_preview']){if(cmp.ctype==='lead_request_preview'){this.onChatPopup(cmp,{is_touch:true,action:'lead_request',lead_id:cmp.s['lead_id']});}else if(cmp.ctype==='consultant_preview'){this.onChatPopup(cmp,{is_touch:true,action:'consultant'});}else{var isValid=cmp.isValid();if(isValid){this._onCmpSubmit(cmp,cmp.getValues());if(cmp.ctype==u.C.CW_VISITOR_INFO_REQUEST){this['is_require_form']=false;this.openCmp('consultant',this.o);}
if(!this.isMsSkin()){cmp.ctype=='site_request'&&this.openCmp('label');if(cmp.ctype=='lead_request'){cmp.destroy();this.openCmp('label');}}}}}else if(ctype=='tool-button-unpin'&&(cmp instanceof Consultant||cmp instanceof MainConsultantPanel)&&!this['is_preview']){this.onChatPopup(cmp);}else if(ctype=='collapser'&&cmp instanceof Banner){this.labelCmp&&this.labelCmp.expand(false);}else if(ctype=='expander'&&cmp instanceof Banner){this.labelCmp&&this.labelCmp.expand(true);}else if(ctype=='collapser'&&u.isinstance(cmp,'uLiB.banner.label.AbstractLabel')){this.labelCmp&&this.labelCmp.expand(false);}else if(ctype=='expander'&&u.isinstance(cmp,'uLiB.banner.label.AbstractLabel')){this.labelCmp&&this.labelCmp.expand(true);}else if(u.inArray(ctype,['site_phone','site_request','consultant'])!=-1){if(ctype==='consultant'&&this.getCmp(ctype).getIsMinimized()){this.getCmp(ctype).setIsMinimized(false);}
if(this.o.banner_skin==='touch'){this.onChatPopup(cmp,{is_touch:true,action:ctype});this.getCmp('label').expand(false);}else{this.openCmp(ctype,this.o);}}else if(ctype=='small-button-email'&&!this['is_preview']){var label='Отправить чат на эл. почту';new ModalPanel({target:cmp,title:label,trackClick:true,items:[{__class:TextField,allowBlank:false,validators:['email'],name:'email',label:label},{__class:StandardButton,text:'Ok',action:'email-chat'}],_onClick:u.bind(this.onComponentClick,this)})}else if(ctype=='standard-button-email-chat'&&!this['is_preview']){if(cmp.isValid()){this.onSendChatByEmail(cmp.getValues());cmp.destroy();}}else if(ctype=='common-button-send-chat-by-email'&&!this['is_preview']){if(cmp.emailChatForm.isValid()){this.onSendChatByEmail(cmp.emailChatForm.getValues());}}else if(u.arrayIsContain(['functional-button-print','small-button-print'],ctype)&&!this['is_preview']){this._printChatLog(cmp);}else if(ctype==='text-button-refresh-captcha'){cmp.refreshCaptcha();}else if(ctype==='call-button-open-site-phone'){this.getCmp('consultant').setIsMinimized(true);this.openCmp(u.C.CW_SITE_PHONE,this.o);}else if(ctype==='tool-button-minimize'){this.getCmp('consultant').setIsMinimized(true);this.openCmp('label');}else if(ctype==='consultant-log'){if(!event.target.classList.contains('chat-retention')){return;}
this.onChatRetentionBtnClick();event.target.classList.contains('open-site-phone')&&this.openCmp(u.C.CW_SITE_PHONE,this.o);event.target.classList.contains('open-site-request')&&this.openCmp(u.C.CW_SITE_REQUEST,this.o);}};ComagicObject.prototype._printChatLog=function(cmp){uLiB.banner.consultant.Consultant.prototype._printChatLog.apply(cmp);};ComagicObject.prototype._hideAllCmps=function(){var cmps=this._getCmps();for(var k in cmps){if(!cmps.hasOwnProperty(k)){continue;}
cmps[k].show&&cmps[k].show(false);}};ComagicObject.prototype._getCmps=function(){if(true){this._cmps={};for(var k in this){if(!this.hasOwnProperty(k)){continue;}
if(!u.endsWith(k,'Cmp')){continue;}
if(!this[k].getEl()){continue;}
this._cmps[this[k].ctype]=this[k];}}
return this._cmps;};ComagicObject.prototype.getCmp=function(ctype,opts){var cmp=this._getCmps()[ctype];if(!cmp){cmp=this.makeCmp(ctype,opts);}
return cmp};ComagicObject.prototype.makeCmp=function(ctype,opts){var cmp=ComponentManager.create(u.apply({ctype:ctype},this.o,this.cmpConfig),opts);this[u.camelize(ctype)+'Cmp']=cmp;return cmp;};ComagicObject.prototype.openModalCmp=function(ctype,opts){u.log('openModalCmp',ctype,opts);var cmp=this.getCmp(ctype,opts);this._onCmpOpen(cmp,opts);};ComagicObject.prototype.openCmp=function(ctype,opts){u.log('openCmp',ctype,opts);if(ctype=='label'&&(!this['is_using_standard_banner']||(!this['is_preview']&&this['is_not_showing_unactive_banner']&&!Comagic.getOperatorStatus()))){this._hideAllCmps();return;}
if(ctype=='consultant'&&this.banner_skin=='touch'){ctype='consultant_preview';}
if((!opts||!opts.is_operator_invite)&&ctype=='consultant'&&this['is_require_form']&&Comagic.getOCState()=='online'){ctype=u.C.CW_VISITOR_INFO_REQUEST;}
if(ctype=='lead_request'&&this.banner_skin=='touch'){ctype='lead_request_preview';}
var cmp=this.getCmp(ctype,opts);if(ctype=='consultant'){cmp.setIsMinimized(false);opts=opts&&opts.is_operator_invite?null:opts;}
if(this.activeComponent===cmp&&this.activeComponent.isVisible()){return;}
if(this.banner_skin==='touch'&&ctype!=='consultant_preview'&&ctype!=='label'){this.onChatPopup(this.activeComponent,{action:cmp.ctype,is_touch:true});}else{this._hideAllCmps();this.activeComponent=cmp;this.activeComponent&&this.activeComponent.show(true);this._onCmpOpen(this.activeComponent,opts)}};ComagicObject.prototype.buildUrl=function(url){url=url||'';if(u.startsWith(url,['http://','https://','ftp://','//'])){return url;}
if(u.startsWith(url,'/')){return this['comagic_web_url']+url;}
return'';};ComagicObject.prototype.invite=function(params){};ComagicObject.prototype.activate=function(active){this.labelCmp&&this.labelCmp.activate(active);};ComagicObject.prototype.showPopupNotification=function(code){if(this.isMsSkin()){new ul.banner.cmp.PopupMessagePanel(u.apply({code:code,ownerComponent:this.activeComponent,afterClose:u.bind(function(popupPanel){popupPanel.ownerComponent.deferredClearOnSubmit&&popupPanel.ownerComponent.clearValues();popupPanel.ownerComponent.setSendBtnDisabled(false);if(popupPanel.ownerComponent.ctype===u.C.CW_LEAD_REQUEST){popupPanel.ownerComponent.destroy();}
if(popupPanel.code==='121'){popupPanel.ownerComponent.refreshCaptcha();}else if(popupPanel.code==='010'||popupPanel.code==='110'){popupPanel.ownerComponent.toggleEmailChatFormVisibility(false);}else{var labelCmp=this.getCmp('label');if(u.isinstance(labelCmp,[Slider,g.uLiB.banner.label.Slider])){labelCmp.expand(false);}
this.openCmp('label');}},this)},this.o));}};ComagicObject.prototype.showPopupMessage=function(type,message,doNotHide){if(_$.isPlainObject(type)){message=type.message;type=type.type;}else if(u.inArray(type,['error','info'])==-1){message=type;type='info';}
if(!this.isMsSkin()){if(_$.isPlainObject(type)){message=type.message;type=type.type;}else if(u.inArray(type,['error','info'])==-1){message=type;type='info';}
this.activeComponent&&this.activeComponent.show(false);new PopupMessagePanel(u.apply({type:type,title:message,afterClose:u.bind(function(){this.activeComponent&&this.activeComponent.show(true);},this)},this.o));}};ComagicObject.prototype.destroy=function(){var cmps=this._getCmps();for(var c in cmps){if(cmps.hasOwnProperty(c)){cmps[c].destroy();}}
ComagicObject.prototype.instance=null;};ComagicObject.prototype.loadHistory=function(messages){this.getCmp('consultant').loadHistory(messages);};ComagicObject.prototype.setOperator=function(name,url,position,is_file_transfer_avaiable){var consultant=this.getCmp('consultant');consultant.setOperator(name,url,position);consultant.setFileTransferEnable(is_file_transfer_avaiable);};ComagicObject.prototype.setFileTransferEnable=function(is_enable){this.getCmp('consultant').setFileTransferEnable(is_enable);};ComagicObject.prototype.show=function(show){u.log('ComagicObject.prototype.show',show,this.activeComponent);this.activeComponent&&this.activeComponent.show(show);};ComagicObject.prototype.getPopupWindowDimensions=function(bannerSkin){bannerSkin=bannerSkin||this.o['banner_skin'];return{legacy:'width=355,height=435',volume:'width=235,height=340',flat:'width=240,height=420',main:'width=268,height=402',simple:'width=260,height=380',touch:''}[bannerSkin];};ComagicObject.prototype._onCmpOpen=function(cmp,o){var cmpMnemonic=cmp.ctype;this.onCmpOpen(cmpMnemonic,o,cmp);switch(cmpMnemonic){case'consultant':this.onChatOpen(o);break;case'site_phone':this.onSitePhoneOpen(o);break;}};ComagicObject.prototype._onCmpSubmit=function(cmp,o){u.log('ComagicObject.prototype._onCmpSubmit',arguments);var cmpMnemonic=cmp.ctype;if(cmp.disableSendBtnOnSubmit){cmp.setSendBtnDisabled(true);}
this.onCmpSubmit(cmpMnemonic,o,cmp);switch(cmpMnemonic){case u.C.CW_VISITOR_INFO_REQUEST:this.onVisitorInfoSubmit(o);break;case u.C.CW_LEAD_REQUEST:this.onLeadRequestSubmit(cmp.s['lead_id'],o);break;case u.C.CW_RETENTION:this.onRetentionSubmit(cmp.s['retention_id'],o);cmp.destroy();break;case u.C.CW_SITE_REQUEST:this.onSiteRequestSubmit(o);break;case u.C.CW_SITE_PHONE:this.onSitePhoneStartCall(o);break;case u.C.CW_CONSULTANT:this.onConsultantSubmit(o);break;}
cmp.clearOnSubmit&&cmp.clearValues();};ComagicObject.prototype._onCmpClose=function(cmp,o){var cmpMnemonic=cmp.ctype;this.onCmpClose(cmpMnemonic,o,cmp);switch(cmpMnemonic){case'lead_request':this.onLeadRequestCancel();break;}};ComagicObject.prototype.onComagicMessage=function(params){if(params['state']=='invite'&&params['source']=='Оператор'){if(this.banner_skin=='touch'){this.openCmp('consultant_preview',params);return;}
this.setOperator(params['from'],params['file_link'],null,params['message']);this.openCmp('consultant',{is_operator_invite:true});}else if(params['state']=='invite'&&params.hasOwnProperty('operator_name')&&params.hasOwnProperty('file_link')){if(this.banner_skin=='touch'){this.openCmp('consultant_preview',params);return;}
this.setOperator(params['operator_name'],params['file_link'],null,params['message']);this.openCmp('consultant');}
var consultant=this.getCmp('consultant');if(consultant.getIsMinimized()&&this.activeComponent.ctype==='label'){this.openCmp('consultant');}
consultant.setTypeNotifier(false);consultant.addLogRecord(params);consultant.playSound&&consultant.playSound(params);};ComagicObject.prototype.onSitePhoneCallResult=function(result){if(!this.isMsSkin()){switch(result){case 0:this.showPopupMessage('info','Ожидайте звонок');this['is_using_standard_banner']&&(this.activeComponent=this.labelCmp);break;case 1:this.openCmp('site_phone');this.showPopupMessage('error','Неверно введен код');break;case 2:case 3:this.showPopupMessage('error','Извините, в данный момент звонок невозможен');break;}}};ComagicObject.prototype.onComagicWriteNotify=function(){this.getCmp('consultant').setTypeNotifier();};ComagicObject.prototype._onConsultantTextAreaChange=function(text){this.onConsultantTextAreaChange(text);};ComagicObject.prototype.onVisitorInfoSubmit=function(params){u.log('EMPTY template onVisitorInfoSubmit',arguments);};ComagicObject.prototype.onLeadRequestSubmit=function(leadId,params){u.log('EMPTY template onLeadRequestSubmit',arguments);};ComagicObject.prototype.onLeadRequestCancel=function(leadId){u.log('EMPTY template onLeadRequestCancel',arguments);};ComagicObject.prototype.onRetentionSubmit=function(retentionId,params){u.log('EMPTY template onRetentionSubmit',arguments);};ComagicObject.prototype.onRetentionCancel=function(retentionId){u.log('EMPTY template onRetentionCancel',arguments);};ComagicObject.prototype.onSiteRequestSubmit=function(params){u.log('EMPTY template onSiteRequestSubmit',arguments);};ComagicObject.prototype.onConsultantSubmit=function(params){u.log('EMPTY template onConsultantSubmit',arguments);};ComagicObject.prototype.onInviteReject=function(){u.log('EMPTY template onInviteReject',arguments);};ComagicObject.prototype.onChatOpen=function(){u.log('EMPTY template onChatOpen',arguments);};ComagicObject.prototype.onChatClose=function(){u.log('EMPTY template onChatClose',arguments);};ComagicObject.prototype.onChatPopup=function(){u.log('EMPTY template onChatPopup',arguments);};ComagicObject.prototype.onExpand=function(expanded){u.log('EMPTY template onExpand',arguments);};ComagicObject.prototype.onSitePhoneStartCall=function(params){u.log('EMPTY template onSitePhoneStartCall',arguments);};ComagicObject.prototype.onCmpOpen=function(mnemonic,params,cmp){u.log('EMPTY template onCmpOpen',arguments);};ComagicObject.prototype.onCmpSubmit=function(mnemonic,params,cmp){u.log('EMPTY template onCmpSubmit',arguments);};ComagicObject.prototype.onCmpClose=function(mnemonic,params,cmp){u.log('EMPTY template onCmpClose',arguments);};ComagicObject.prototype.onSitePhoneOpen=function(params){u.log('EMPTY template onSitePhoneOpen',arguments);};ComagicObject.prototype.onSendChatByEmail=function(params){u.log('EMPTY template onSendChatByEmail',arguments);};ComagicObject.prototype._onOperatorRate=function(rating){this.onOperatorRate(rating);};ComagicObject.prototype.onOperatorRate=function(rating){u.log('EMPTY template onOperatorRate',arguments);};ComagicObject.prototype.onConsultantTextAreaChange=function(text){u.log('EMPTY template onConsultantTextAreaChange',arguments);};ComagicObject.prototype.onChatTyping=function(){u.log('EMPTY template onChatTyping',arguments);};function ConsultantStandalone(o){this.socket=new SockJS(decodeURIComponent(u.getURLParameter('server'))||o['comagic_server_url']);this.consultantCmp=new Consultant(u.apply({isStandalone:true,_onClick:u.bind(this.onConsultantClick,this),_onKeyup:u.bind(this.onConsultantKeyup,this)},o));this.consultantCmp.onTextAreaChange=u.bind(this.onConsultantTextAreaChange,this);this.consultantCmp.consultantLogCmp.timeDelta=parseInt(u.getURLParameter('time_delta'));this.defaultSocketParams={visitor_key:o['visitor_key'],site_key:o['site_key'],hit_id:o['hit_id']};this.initSocket();this.consultantCmp.show(true);}
ConsultantStandalone.prototype.initSocket=function(){this.socket.onopen=u.bind(this.onSocketOpen,this);this.socket.onmessage=u.bind(this.onSocketMessage,this);this.socket.onclose=u.bind(this.onSocketClose,this)};ConsultantStandalone.prototype.onSocketOpen=function(){this.ready=true;var join=u.getURLParameter('join');if(join){this.startVisitorChat(true);}else{this.startVisitorChat();this.sendInitialMessage();}};ConsultantStandalone.prototype.onSocketClose=function(){var message=u.C.IS_TOUCH_DEVICE?'Соединение с сервером прервано.<br/>Для продолжения обновите страницу.':'Соединение с сервером прервано.<br/>Для продолжения обновите окно чата (F5 или Ctrl+R).';this.addLogRecord({message:message});this.ready=false;};ConsultantStandalone.prototype.onSocketMessage=function(data){u.log('ConsultantStandalone.prototype.onSocketMessage',data);data=JSON.parse(data.data);var name=data.name,params=data.params;if(name=='connected'){this.consultantCmp.setOperatorName(params['operator_name']);this.consultantCmp.setOperatorPic(params['avatar']);this.consultantCmp.addLogRecord(params['messages']);this.consultantCmp.chatWatcherEnabled=!!params['chat_watch'];params['operator_rating']!==undefined&&params['operator_rating']!==null&&this.setOperatorRating(params['operator_rating']);}else if(name=='message'){this.consultantCmp.setTypeNotifier(false);this.consultantCmp.addLogRecord(params);}else if(name=='operator_reject'){this.consultantCmp.setOperatorName(null);this.consultantCmp.setOperatorPic(null);}else if(name=='set_operator_rating'){this.consultantCmp.setOperatorRating(params['rating']);}else if(name=='chat_watch'){this.consultantCmp.chatWatcherEnabled=params['enabled'];}else if(name=='force_chat_close'){window.close();}};ConsultantStandalone.prototype.sendSocketMessage=function(name,params){if(!this.socket||!this.socket.send||!this.ready){u.log('ConsultantStandalone.prototype.sendSocketMessage','socket is undefined. can\'t further processing');return;}
params=params||{};var message={name:name,params:_$.extend({},params,this.defaultSocketParams)};this.socket.send(JSON.stringify(message));};ConsultantStandalone.prototype.startVisitorChat=function(join){join=join||false;this.sendSocketMessage('start_visitor_chat',{windowed:true,join:join});};ConsultantStandalone.prototype.joinVisitorChat=function(){this.sendSocketMessage('join_visitor_chat')};ConsultantStandalone.prototype.sendInitialMessage=function(){var message=u.getURLParameter('premessage');if(message){window.setTimeout(u.bind(function(){this.sendMessage(message);},this),1000);}};ConsultantStandalone.prototype.sendMessage=function(message){this.sendSocketMessage('message',{message:message});this.consultantCmp.clearValues();};ConsultantStandalone.prototype.onLayoutChatEmail=function(email){var params={};email&&(params['email']=email);this.sendSocketMessage('send_chat_by_mail',params);};ConsultantStandalone.prototype.onLayoutType=function(){this.sendSocketMessage('write_notify',{});};ConsultantStandalone.prototype.onConsultantClick=function(cmp,deepCType,ctype){u.log('ConsultantStandalone.prototype.onConsultantClick',arguments);if(ctype=='tool-button-close'){if(cmp instanceof ModalPanel){cmp.destroy();}}
if(ctype=='standard-button-send'){window.setTimeout(u.bind(function(){this.consultantCmp.inputField.getInputEl().focus();},this),100);this.consultantCmp.isValid()&&this.sendMessage(this.consultantCmp.getValues().message);}else if(ctype=='tool-button-pin'){this.sendSocketMessage('embed_chat',{});}else if(deepCType.indexOf('comagic-rate-operator')!=-1){this.sendSocketMessage('set_operator_rating',{rating:+ctype});}else if(ctype=='tool-button-unpin'){this.sendSocketMessage('embed_chat',{});}else if(ctype=='small-button-email'&&!this['is_preview']){var label='Отправить чат на эл. почту';new ModalPanel({target:cmp,title:label,trackClick:true,items:[{__class:TextField,allowBlank:false,validators:['email'],name:'email',label:label},{__class:StandardButton,text:'Ok',action:'email-chat'}],_onClick:u.bind(this.onConsultantClick,this)})}else if(ctype=='standard-button-email-chat'&&!this['is_preview']){if(cmp.isValid()){this.sendSocketMessage('send_chat_by_mail',cmp.getValues());cmp.destroy();}}else if(ctype=='small-button-print'&&!this['is_preview']){this._printChatLog.apply(this);}};ConsultantStandalone.prototype._printChatLog=function(){var printPage=g.open(),css=this.consultantCmp.buildUrl('/static/comagic/banner/resources/css/print.css'),html=this.consultantCmp.getLogHtml();printPage.document.title=document.title;printPage.document.write(u.sformat('<!DOCTYPE html"><html><head>'+'<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />'+'<link rel="stylesheet" type="text/css" href="{0}"/>'+'</head><body>'+'{1}<br/>Сервис предоставлен <a href="http://www.comagic.ru" target="_blank">www.comagic.ru</a></body></html>',css,html));printPage.print();};ConsultantStandalone.prototype.onConsultantKeyup=function(cmp,deepCType,ctype,event){var keyCode=event.keyCode,ctrlKey=event.ctrlKey;if(keyCode==13&&ctrlKey){this.consultantCmp.isValid()&&this.sendMessage(this.consultantCmp.getValues().message);}};ConsultantStandalone.prototype.onConsultantTextAreaChange=function(text){this.sendSocketMessage('current_message',{'message':text});};window.ComagicBanner=ComagicObject;window.ConsultantStandalone=ConsultantStandalone;ComponentManager.registerCType(Banner);ComponentManager.registerCType(Slider);ComponentManager.registerCType(Buttons);ComponentManager.registerCType(Consultant);ComponentManager.registerCType(VisitorInfo);function setDebug(){u.apply(window,{ComagicObject:ComagicObject,Component:Component,WayItem:WayItem,BannerWayItem:BannerWayItem,SliderWayItem:SliderWayItem,ButtonsWayItem:ButtonsWayItem,ComponentManager:ComponentManager,Banner:Banner,getURLParameter:u.getURLParameter,SitePhone:SitePhone,SiteRequest:SiteRequest,RateOperatorField:RateOperatorField,ConsultantLog:ConsultantLog,SmallButtonsBox:ConsultantSmallButtonsBox,Consultant:Consultant,LeadRequest:LeadRequest,VisitorInfo:VisitorInfo,PopupMessage:PopupMessagePanel,getC:function(){return ComponentManager.get('comagic-cmp-0').o;},getBC:function(){return ComagicObject.prototype.instance.getCmp('label');},getBO:function(){return ComagicObject.prototype.instance;},getU:function(){return u;}});}
if(u.__debug===true){setDebug();}
_$(window).bind('hashchange',function(){if(!u.getHashParameter('bannerdebug')){return;}
u.__debug=!!u.getHashParameter('bannerdebug');setDebug();});u.log('banner done');})();